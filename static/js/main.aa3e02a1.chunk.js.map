{"version":3,"sources":["Components/UI/etc.js","Core/ViewController/ViewControl.js","Core/util/WG_util.js","Core/WG_core.js","Core/util/PrefetchWrapper.js","Core/StoreControl/StoreControl.js","Core/InteractController/UserInteract.js","assets/img/closeBlack.svg","assets/img/closeWhite.svg","assets/img/up.svg","assets/img/cross.svg","Components/Stage/mainStage.js","App.js","reportWebVitals.js","index.js"],"names":["ren_miniPic","i","leftFigUrl","Saves","FigUrl","rightFigUrl","renderList","tempIn","className","src","alt","push","id","SettingButtons_font","props","state","buttonState","buttonStateNow","fontsize","Settings","font_size","Object","keys","SettingsMap","indexOf","this","setState","key","value","document","getElementById","style","fontSize","writeCookie","onClick","changeButtonState","React","Component","SettingButtons_speed","playSpeed","play_speed","getRuntime","textShowWaitTime","LoadMainModel","Buttons","SaveButtons","LoadPageQty","PageQty","currentPage","currentLoadPage","loadButtons","page","temp","setCurrentPage","thisButtonName","thisButtonText","miniPic","backUrl","userInteract","LoadSavedGame","saveTime","backgroundImage","loadSaveButtons","SaveMainModel","ren_bg_list","currentSavePage","save_onSaved","save_NonSaved","index","saveGame","WG_ViewControl","showMesModel","closeSave","ControlButton","fun","borderBottom","color","simpleName","name","ImporterExporter","dummyA","dummyInput","querySelector","ev","file","target","files","reader","FileReader","onload","evR","saves","result","localStorage","setItem","GameInfo","loadCookie","window","location","reload","readAsText","getItem","blob","Blob","type","blobUrl","URL","createObjectURL","revokeObjectURL","href","download","click","exportSaves","display","onChange","importSaves","text","JSON","parse","error","bg_name","BG","oldBG","cloneNode","parentNode","removeChild","setAttribute","animation","animationFillMode","console","log","appendChild","newBG","parentNodeBG","P_name","pos","ReactDOM","render","currentInfo","pUrl","changedP","selection","mode","elements","chooseScene","length","chooseJumpFun","changedName","textArray","split","showTextArray","transform","filter","savedStatus","command","chooseItems","choose_mode","VC_choose","SyncCurrentStatus","getStatus","loadBGM","VC_showMiniAvatar","playVocal","settingInterface","clearCookie","showTextPreview","bgmName","autoplay","pause","url","audio","loop","playControl","played","oncanplay","currentTime","volume","play","runtimeTemp","vocalName","vocal","VocalControl","IntroView","introInterval","setInterval","singleRow","introAll","clearInterval","setTimeout","clearIntro","videoName","videoTag","autoPlay","onended","nextSentenceProcessor","renNewButton","autoNext","fastNext","onSaveGame","onLoadGame","onSetting","Title","showBacklogList","CurrentBacklog","opacity","animationDelay","elementAudio","singleControlBacklogAudio","VolumeNotice","theme","size","fill","jumpFromBacklog","Return","showName","showText","showingText","elementArray","interval","tempElement","textFull","j","auto","autoWaitTime","fast","ended","onTextPreview","interval2","showSingle","Left","Right","func","element","pic","animate","time","aniString","editList","getElementsByClassName","showType","ele","defaultValue","processSentence","currentScene","slice","queryWidgetState","widgets","name2query","Map","reduce","undefined","Array","from","state_map","wi","query","get","RangeError","disp","getComputedStyle","set","values","next","AllHiddenIgnore","states","ignore","includes","saveBacklogNow","thisSentence","S_content","VC_changeBG","VC_changeP","increaseSentence","getScene","jumpSentence","introText","showIntro","substring","content","singleSet","GameVar","parseInt","varArea","JumpArea","varProcess","stringify","VC_textShow","judgeBody","jumpActivated","ifJump","VC_setBGtransform","VC_setBGfilter","setList","setSent","setVarName","setVarValue","valueLeft","valueRight","setVar","aniName","aniTime","VC_setAnimationByClass","VC_setAnimationById","showVideo","shift","active","lab_name","find","jmp_sentence","PrefetchWrapperSW","maxRequestBatch","minRequestInterval","_prefetchPipeline","_batchID","_cachedAssets","Set","_currentCursor","scene","idx","newSceneUrl","a","startIdx","syncCachePromise","_syncCacheInfo","signalPause","flushPipeline","fetch","resp","ok","Error","status","extractAssetUrl","sceneUrl","startLine","newAssets","urgentPromises","urgent","map","asset","all","forEach","has","delete","_addToPipeline","signalResume","suggestNextScene","Promise","allSettled","assets","nextSceneUrl","fakeQuery","URLSearchParams","toString","clearTimeout","tryBatch","selfID","_fetchBatch","catch","then","promises","budget","assetUrl","_tryExpandScene","qsIdx","lastIndexOf","qsParam","Number","clone","sceneText","nextAssets","urgentBudget","urgentOnly","caches","open","cacheNamePrefix","cache","req","maxLine","POSITIVE_INFINITY","assetAll","assetMap","assetUrgent","extractVocal","dialogue","vocalPrefix","startsWith","addToAssets","filetype","filename","add","lines","entries","lineIdx","lineData","tokens","cmdOrDlg","argOrDlg","choices","trim","choice","args","prefetcher","initServiceWorkerPrefetchWrapper","contScene","isSecureContext","navigator","serviceWorker","addEventListener","register","reg","onupdatefound","unregister","installing","onstatechange","err","warn","Game_name","Game_key","Title_img","Title_bgm","Loading_img","SceneName","SentenceID","bg_Name","fig_Name","fig_Name_left","fig_Name_right","choose","bgm","miniAvatar","bg_filter","bg_transform","SaveBacklog","runtime","setAutoWaitTime","hideTextStatus","temp_bgm_TitleToGameplay","unzip","b64Data","strData","atob","charData","x","charCodeAt","binData","Uint8Array","data","pako","inflate","String","fromCharCode","apply","Uint16Array","decodeURIComponent","unzipStr","SavedGame","SavedBacklog","SP","LP","cSettings","toCookie","gzip","zipStr","statusKey","newStatus","StatusProp","hasOwnProperty","getScReq","XMLHttpRequest","send","onreadystatechange","readyState","responseText","tempSentence","commandLength","onSceneChange","str","binaryString","encodeURIComponent","to","btoa","tempInfo","tempBacklog","Date","toLocaleDateString","toLocaleTimeString","hour12","closeLoad","VC_closeChoose","hideTitle","save","VC_restoreStatus","closeBacklog","pop","ifRes","VC_resetStage","label","core","VC_showSettings","VC_showSave_Load","backgroundColor","boxShadow","close","showBacklog","e","preventDefault","button","evt","KeyboardEvent","code","dispatchEvent","deltaY","isComposing","defaultPrevented","repeat","closeSettings","continueGame","hidePanic","showPanic","Stage","hideStartPage","closeVideo","exit","clickOnBack","closeB","closeW","hideTextBox","cross","width","height","up","ReplayMusic","PlayOne","DoubleRight","FolderDownload","FolderUpload","SettingTwo","Home","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","StrictMode","fontSizeKey","playSpeedKey","loadSettings","getInfoCon","textList","title","getGameInfo","info","userAgent","agents","isMobile","padding","documentElement","clientWidth","clientHeight","contentDOM","position","top","left","orientation","forceRotate"],"mappings":"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","file":"static/js/main.aa3e02a1.chunk.js","sourcesContent":["// -------- 导入导出存档 --------\r\nimport React from \"react\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {\r\n    loadCookie, Saves, Settings, writeCookie, getRuntime, GameInfo, SettingsMap\r\n} from \"../../Core/StoreControl/StoreControl\";\r\nimport {userInteract} from \"../../Core/InteractController/UserInteract\";\r\nimport {WG_ViewControl} from \"../../Core/ViewController/ViewControl\";\r\n\r\nfunction ren_miniPic(i) {\r\n    let leftFigUrl = \"./game/figure/\" + Saves[i][\"fig_Name_left\"];\r\n    let FigUrl = \"./game/figure/\" + Saves[i][\"fig_Name\"];\r\n    let rightFigUrl = \"./game/figure/\" + Saves[i][\"fig_Name_right\"];\r\n    let renderList = [];\r\n    if (Saves[i][\"fig_Name_left\"] !== 'none' && Saves[i][\"fig_Name_left\"] !== '') {\r\n        let tempIn = <span className={\"mini_fig mini_fig_left\"}>\r\n            <img src={leftFigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    if (Saves[i][\"fig_Name\"] !== 'none' && Saves[i][\"fig_Name\"] !== '') {\r\n        let tempIn = <span className={\"mini_fig mini_fig_center\"}>\r\n            <img src={FigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    if (Saves[i][\"fig_Name_right\"] !== 'none' && Saves[i][\"fig_Name_right\"] !== '') {\r\n        let tempIn = <span className={\"mini_fig mini_fig_right\"}>\r\n            <img src={rightFigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    return <div id={\"ren_SE\" + i} className={\"miniPic\"}>\r\n        {renderList}\r\n    </div>;\r\n}\r\n\r\nclass SettingButtons_font extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {buttonState: ['', '', '']}\r\n    }\r\n\r\n    componentDidMount() {\r\n        let buttonStateNow = ['', '', ''];\r\n        let fontsize = Settings.font_size;\r\n        let index = Object.keys(SettingsMap.font_size).indexOf(fontsize);\r\n\r\n        buttonStateNow[index] = 'On';\r\n        this.setState({\r\n            buttonState: buttonStateNow\r\n        })\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    changeButtonState(i) {\r\n        let key = Object.keys(SettingsMap.font_size)[i]\r\n        let value = SettingsMap.font_size[key]\r\n        let buttonStateNow = ['', '', ''];\r\n\r\n        document.getElementById('SceneText').style.fontSize = value;\r\n        document.getElementById('previewDiv').style.fontSize = value;\r\n        buttonStateNow[i] = 'On';\r\n\r\n        writeCookie();\r\n        this.setState({\r\n            buttonState: buttonStateNow\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        return (<div className=\"singleSettingItem\">\r\n            <span className=\"settingItemTitle\">字体大小</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[0]} onClick={() => {\r\n                this.changeButtonState(0)\r\n            }}>小</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[1]} onClick={() => {\r\n                this.changeButtonState(1)\r\n            }}>中</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[2]} onClick={() => {\r\n                this.changeButtonState(2)\r\n            }}>大</span>\r\n        </div>);\r\n    }\r\n\r\n}\r\n\r\nclass SettingButtons_speed extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {buttonState: ['', '', '']}\r\n    }\r\n\r\n    componentDidMount() {\r\n        let buttonStateNow = ['', '', ''];\r\n        let playSpeed = Settings.play_speed;\r\n        let index = Object.keys(SettingsMap.play_speed).indexOf(playSpeed);\r\n\r\n        buttonStateNow[index] = 'On';\r\n        this.setState({\r\n            buttonState: buttonStateNow\r\n        })\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    changeButtonState(i) {\r\n        let key = Object.keys(SettingsMap.play_speed)[i]\r\n        let value = SettingsMap.play_speed[key]\r\n        let buttonStateNow = ['', '', ''];\r\n\r\n        getRuntime().textShowWaitTime = value;\r\n        buttonStateNow[i] = 'On';\r\n        writeCookie();\r\n        this.setState({\r\n            buttonState: buttonStateNow\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        return (<div className=\"singleSettingItem\">\r\n            <span className=\"settingItemTitle\">播放速度</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[0]} onClick={() => {\r\n                this.changeButtonState(0)\r\n            }}>慢</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[1]} onClick={() => {\r\n                this.changeButtonState(1)\r\n            }}>中</span>\r\n            <span className={'settingItemButton' + this.state.buttonState[2]} onClick={() => {\r\n                this.changeButtonState(2)\r\n            }}>快</span>\r\n        </div>);\r\n    }\r\n\r\n}\r\n\r\nclass LoadMainModel extends React.Component {\r\n    Buttons = [];\r\n    SaveButtons = [];\r\n    LoadPageQty = 0;\r\n\r\n    setCurrentPage(page) {\r\n        getRuntime().currentLoadPage = page;\r\n        this.setState({\r\n            currentPage: getRuntime().currentLoadPage\r\n        })\r\n        writeCookie();\r\n    }\r\n\r\n    loadButtons() {\r\n        this.Buttons = [];\r\n        for (let i = 0; i < this.LoadPageQty; i++) {\r\n            let temp = <span className=\"LoadIndexButton LS_indexButton\" onClick={() => {\r\n                this.setCurrentPage(i)\r\n            }} key={i}>{i + 1}</span>\r\n            if (i === getRuntime().currentLoadPage) temp =\r\n                <span className=\"LoadIndexButtonOn LS_indexButtonOn\" onClick={() => {\r\n                    this.setCurrentPage(i)\r\n                }} key={i}>{i + 1}</span>\r\n            this.Buttons.push(temp);\r\n        }\r\n    }\r\n\r\n    loadSaveButtons() {\r\n        this.SaveButtons = [];\r\n        for (let i = getRuntime().currentLoadPage * 6 + 1; i <= getRuntime().currentLoadPage * 6 + 6; i++) {\r\n            if (Saves[i]) {\r\n                let thisButtonName = Saves[i][\"showName\"];\r\n                let thisButtonText = Saves[i][\"showText\"];\r\n                let miniPic = ren_miniPic(i);\r\n                let backUrl = \"game/background/\" + Saves[i][\"bg_Name\"];\r\n                let temp = <div className=\"LoadSingleElement LS_singleElement\" key={i} onClick={() => {\r\n                    userInteract.LoadSavedGame(i)\r\n                }}>\r\n                    <div className={\"LS_Title\"}>\r\n                        <span className={\"LS_Title_index\"}>{i}</span>\r\n                        <span className={\"LS_Title_time\"}>{Saves[i].saveTime}</span>\r\n                    </div>\r\n                    <div className={\"LS_infoArea\"}>\r\n                        <div className={\"ren\"} key={i} style={{backgroundImage: `url(${backUrl})`}}>\r\n                            {miniPic}\r\n                        </div>\r\n                        <div className={\"LS_textArea\"}>\r\n                            <div className=\"LSE_top\">\r\n                                {/*<span className={\"LSE_index\"}>{i}</span>*/}\r\n                                <span className={\"L_name\"}>{thisButtonName}</span>\r\n                            </div>\r\n                            <div className=\"LSE_bottom\">\r\n                                {thisButtonText}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                this.SaveButtons.push(temp);\r\n            } else {\r\n                let temp = <div className=\"LoadSingleElement LS_singleElement\" key={i}></div>\r\n                this.SaveButtons.push(temp);\r\n                // console.log(i)\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.LoadPageQty = props.PageQty;\r\n        this.state = {\r\n            currentPage: getRuntime().currentLoadPage\r\n        }\r\n        this.loadButtons();\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    render() {\r\n        this.loadButtons();\r\n        this.loadSaveButtons();\r\n        return (<div id=\"LoadMain\" className={\"LS_renderMain\"}>\r\n                <div className={'LS_Title_and_Button'}>\r\n                    <div id=\"LoadTitle\">\r\n                        读档\r\n                    </div>\r\n                    <div id=\"LoadIndex\" className={\"LS_Index\"}>\r\n                        {this.Buttons}\r\n                    </div>\r\n                </div>\r\n\r\n                <div id=\"LoadButtonList\" className={\"LS_ButtonList\"}>\r\n                    {this.SaveButtons}\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nclass SaveMainModel extends React.Component {\r\n    Buttons = [];\r\n    SaveButtons = [];\r\n    LoadPageQty = 0;\r\n    ren_bg_list = [];\r\n\r\n    setCurrentPage(page) {\r\n        getRuntime().currentSavePage = page;\r\n        this.setState({\r\n            currentPage: getRuntime().currentSavePage\r\n        })\r\n        writeCookie();\r\n    }\r\n\r\n    loadButtons() {\r\n        this.Buttons = [];\r\n        for (let i = 0; i < this.LoadPageQty; i++) {\r\n            let temp = <span className=\"SaveIndexButton LS_indexButton\" onClick={() => {\r\n                this.setCurrentPage(i)\r\n            }} key={i}>{i + 1}</span>\r\n            if (i === getRuntime().currentSavePage) temp =\r\n                <span className=\"SaveIndexButtonOn LS_indexButtonOn\" onClick={() => {\r\n                    this.setCurrentPage(i)\r\n                }} key={i}>{i + 1}</span>\r\n            this.Buttons.push(temp);\r\n        }\r\n    }\r\n\r\n    loadSaveButtons() {\r\n        this.SaveButtons = [];\r\n        this.ren_bg_list = [];\r\n        for (let i = getRuntime().currentSavePage * 6 + 1; i <= getRuntime().currentSavePage * 6 + 6; i++) {\r\n            if (Saves[i]) {\r\n                let thisButtonName = Saves[i][\"showName\"];\r\n                let thisButtonText = Saves[i][\"showText\"];\r\n                let miniPic = ren_miniPic(i);\r\n                let backUrl = \"game/background/\" + Saves[i][\"bg_Name\"];\r\n                let temp = <div className=\"SaveSingleElement LS_singleElement\" key={i} onClick={() => {\r\n                    this.save_onSaved(i)\r\n                }}>\r\n                    <div className={\"LS_Title\"}>\r\n                        <span className={\"LS_Title_index S_Title_index\"}>{i}</span>\r\n                        <span className={\"LS_Title_time S_Title_time\"}>{Saves[i].saveTime}</span>\r\n                    </div>\r\n                    <div className={\"LS_infoArea\"}>\r\n                        <div className={\"ren\"} key={i} style={{backgroundImage: `url(${backUrl})`}}>\r\n                            {miniPic}\r\n                        </div>\r\n                        <div className={\"LS_textArea\"}>\r\n                            <div className=\"LSE_top\">\r\n                                <span className={\"LSE_index\"}>{i}</span>\r\n                                <span className={\"LSE_name\"}>{thisButtonName}</span>\r\n                            </div>\r\n                            <div className=\"LSE_bottom\">\r\n                                {thisButtonText}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                this.SaveButtons.push(temp);\r\n            } else {\r\n                let temp = <div className=\"SaveSingleElement LS_singleElement\" key={i} onClick={() => {\r\n                    this.save_NonSaved(i)\r\n                }}></div>\r\n                this.SaveButtons.push(temp);\r\n                // console.log(i)\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    save_NonSaved(index) {\r\n        userInteract.saveGame(index);\r\n        writeCookie();\r\n        this.setState({\r\n            currentPage: getRuntime().currentSavePage\r\n        });\r\n    }\r\n\r\n    save_onSaved(index) {\r\n        WG_ViewControl.showMesModel('你要覆盖这个存档吗', '覆盖', '不', function () {\r\n            userInteract.saveGame(index);\r\n            writeCookie();\r\n            userInteract.closeSave();\r\n        })\r\n        this.setState({\r\n            currentPage: getRuntime().currentSavePage\r\n        });\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.LoadPageQty = props.PageQty;\r\n        this.state = {\r\n            currentPage: getRuntime().currentSavePage\r\n        }\r\n        this.loadButtons();\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    render() {\r\n        this.loadButtons();\r\n        this.loadSaveButtons();\r\n        return (<div id=\"SaveMain\" className={\"LS_renderMain\"}>\r\n                <div className={'LS_Title_and_Button'}>\r\n                    <div id=\"SaveTitle\">\r\n                        存档\r\n                    </div>\r\n                    <div id=\"SaveIndex\" className={\"LS_Index\"}>\r\n                        {this.Buttons}\r\n                    </div>\r\n                </div>\r\n                <div id=\"SaveButtonList\" className={\"LS_ButtonList\"}>\r\n                    {this.SaveButtons}\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nfunction ControlButton(props) {\r\n    if (props.id) {\r\n        return <div className={\"newButton\"} id={props.id} onClick={() => {\r\n            props.fun();\r\n        }}>\r\n            <span className={\"nB_left\"} style={{borderBottom: `3px solid ${props.color}`}}>{props.simpleName}</span>\r\n            <span className={\"nB_right\"}>{props.name}</span>\r\n        </div>\r\n    }\r\n\r\n    return <div className={\"newButton\"} onClick={() => {\r\n        props.fun();\r\n    }}>\r\n        <span className={\"nB_left\"} style={{borderBottom: `3px solid ${props.color}`}}>{props.simpleName}</span>\r\n        <span className={\"nB_right\"}>{props.name}</span>\r\n    </div>\r\n}\r\n\r\n// -------- 导入导出存档 --------\r\nclass ImporterExporter extends React.Component {\r\n    constructor() {\r\n        super();\r\n        this.dummyA = null;\r\n        this.dummyInput = null;\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        this.dummyA = document.querySelector('a#dummy-saves-exporter');\r\n        this.dummyInput = document.querySelector('input#dummy-saves-importer');\r\n    }\r\n\r\n\r\n    importSaves(ev) {\r\n        const file = ev.target.files[0];\r\n        const reader = new FileReader();\r\n        reader.onload = (evR) => {\r\n            const saves = evR.target.result;\r\n            localStorage.setItem(GameInfo['Game_key'], saves);\r\n            loadCookie();\r\n            window.location.reload();  // dirty: 强制刷新 UI\r\n        };\r\n        reader.readAsText(file, 'UTF-8');\r\n    }\r\n\r\n\r\n    exportSaves() {\r\n        const saves = localStorage.getItem(GameInfo['Game_key']);\r\n        if (saves === null) {\r\n            // no saves\r\n            return false;\r\n        }\r\n        const blob = new Blob([saves], {type: 'application/json'});\r\n        const blobUrl = URL.createObjectURL(blob);\r\n        URL.revokeObjectURL(this.dummyA.href);\r\n        this.dummyA.href = blobUrl;\r\n        this.dummyA.download = 'saves.json';\r\n        this.dummyA.click();\r\n        return true;\r\n    }\r\n\r\n\r\n    render() {\r\n        return (<div className=\"importer-exporter\">\r\n                <span className=\"label-saves-exporter\" onClick={() => {\r\n                    this.exportSaves();\r\n                }}>导出存档</span>\r\n            <a target=\"_blank\" id=\"dummy-saves-exporter\" style={{display: \"none\"}}/>\r\n            <span className=\"label-saves-importer\" onClick={() => {\r\n                this.dummyInput.click();\r\n            }}>导入存档</span>\r\n            <input type=\"file\" id=\"dummy-saves-importer\" style={{display: \"none\"}} onChange={this.importSaves}/>\r\n        </div>);\r\n    }\r\n\r\n\r\n    checkSyntax(text) {\r\n        try {\r\n            const json = JSON.parse(text);\r\n        } catch (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\nexport {\r\n    ren_miniPic,\r\n    SettingButtons_font,\r\n    SettingButtons_speed,\r\n    LoadMainModel,\r\n    SaveMainModel,\r\n    ControlButton,\r\n    ImporterExporter\r\n}","import ReactDOM from \"react-dom\";\r\nimport {clearCookie, getRuntime, getStatus, SyncCurrentStatus} from \"../StoreControl/StoreControl\";\r\n\r\nimport {userInteract} from \"../InteractController/UserInteract\";\r\nimport {\r\n    ControlButton, ImporterExporter, LoadMainModel, SaveMainModel, SettingButtons_font, SettingButtons_speed\r\n} from \"../../Components/UI/etc\";\r\nimport {nextSentenceProcessor} from \"../WG_core\";\r\nimport React from \"react\";\r\nimport {Return, VolumeNotice} from \"@icon-park/react\";\r\nimport '@icon-park/react/styles/index.css';\r\n\r\nclass WG_ViewControl {\r\n    static VC_changeBG(bg_name) {\r\n        //把背景复制一份成为旧背景，方便做渐变动画\r\n        let BG = document.getElementById('mainBackground');\r\n        let oldBG = BG.cloneNode(true);\r\n        //如果有旧背景节点，删除之\r\n        if (document.getElementById('oldBG')) {\r\n            document.getElementById('oldBG').parentNode.removeChild(document.getElementById('oldBG'))\r\n        }\r\n        oldBG.setAttribute('id', 'oldBG');\r\n        oldBG.style.animation = 'hideBG 5s';\r\n        oldBG.style.animationFillMode = 'forwards';\r\n        console.log(oldBG);\r\n        BG.parentNode.appendChild(oldBG);\r\n        BG.style.backgroundImage = \"url('game/background/\" + bg_name + \"')\";\r\n        let newBG = BG.cloneNode(true);\r\n        let parentNodeBG = BG.parentNode;\r\n        parentNodeBG.removeChild(BG);\r\n        parentNodeBG.appendChild(newBG);\r\n    }\r\n\r\n    static VC_changeP(P_name, pos) {\r\n        if (pos === 'center') {\r\n            if (P_name === 'none') {\r\n                ReactDOM.render(<div/>, document.getElementById('figureImage'));\r\n                getRuntime().currentInfo[\"fig_Name\"] = 'none';\r\n            } else {\r\n                let pUrl = \"game/figure/\" + P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP, document.getElementById('figureImage'));\r\n                getRuntime().currentInfo[\"fig_Name\"] = P_name;\r\n            }\r\n        } else if (pos === 'left') {\r\n            if (P_name === 'none') {\r\n                ReactDOM.render(<div/>, document.getElementById('figureImage_left'));\r\n                getRuntime().currentInfo[\"fig_Name_left\"] = 'none';\r\n            } else {\r\n                let pUrl = \"game/figure/\" + P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP, document.getElementById('figureImage_left'));\r\n                getRuntime().currentInfo[\"fig_Name_left\"] = P_name;\r\n            }\r\n        } else if (pos === 'right') {\r\n            if (P_name === 'none') {\r\n                ReactDOM.render(<div/>, document.getElementById('figureImage_right'));\r\n                getRuntime().currentInfo[\"fig_Name_right\"] = 'none';\r\n            } else {\r\n                let pUrl = \"game/figure/\" + P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP, document.getElementById('figureImage_right'));\r\n                getRuntime().currentInfo[\"fig_Name_right\"] = P_name;\r\n            }\r\n        }\r\n    }\r\n\r\n    static VC_choose(selection, mode) {\r\n        if (mode === 'scene') {\r\n            document.getElementById('chooseBox').style.display = 'flex';\r\n            let elements = []\r\n            for (let i = 0; i < selection.length; i++) {\r\n                let temp = <div className='singleChoose' key={i} onClick={() => {\r\n                    userInteract.chooseScene(selection[i][1]);\r\n                }}>{selection[i][0]}</div>\r\n                elements.push(temp)\r\n            }\r\n            ReactDOM.render(<div>{elements}</div>, document.getElementById('chooseBox'))\r\n        }\r\n        if (mode === 'label') {\r\n            document.getElementById('chooseBox').style.display = 'flex';\r\n            let elements = []\r\n            for (let i = 0; i < selection.length; i++) {\r\n                let temp = <div className='singleChoose' key={i} onClick={() => {\r\n                    userInteract.chooseJumpFun(selection[i][1]);\r\n                }}>{selection[i][0]}</div>\r\n                elements.push(temp)\r\n            }\r\n            ReactDOM.render(<div>{elements}</div>, document.getElementById('chooseBox'))\r\n        }\r\n    }\r\n\r\n    static VC_closeChoose() {\r\n        document.getElementById('chooseBox').style.display = 'none';\r\n    }\r\n\r\n    static VC_textShow(name, text) {\r\n        let changedName = <span>{name}</span>\r\n        let textArray = text.split(\"\");\r\n        ReactDOM.render(changedName, document.getElementById('pName'));\r\n        WG_ViewControl.showTextArray(textArray);\r\n    }\r\n\r\n    static VC_setBGtransform(transform) {\r\n        document.getElementById('mainBackground').style.transform = transform;\r\n    }\r\n\r\n    static VC_setBGfilter(filter) {\r\n        document.getElementById('mainBackground').style.filter = filter;\r\n    }\r\n\r\n    static VC_restoreStatus(savedStatus) {\r\n        console.log(\"restoring\")\r\n        console.log(savedStatus)\r\n        let command = savedStatus[\"command\"];\r\n        //恢复背景的移动和效果\r\n        if (savedStatus['bg_transform'] !== '') {\r\n            document.getElementById('mainBackground').style.transform = savedStatus['bg_transform'];\r\n        }\r\n        if (savedStatus['bg_filter'] !== '') {\r\n            document.getElementById('mainBackground').style.filter = savedStatus['bg_filter'];\r\n        }\r\n        if (savedStatus[\"bg_Name\"] !== '') document.getElementById('mainBackground').style.backgroundImage = \"url('game/background/\" + savedStatus[\"bg_Name\"] + \"')\";\r\n        if (savedStatus[\"fig_Name\"] === '' || savedStatus[\"fig_Name\"] === 'none') {\r\n            ReactDOM.render(<div/>, document.getElementById('figureImage'));\r\n        } else {\r\n            let pUrl = \"game/figure/\" + savedStatus[\"fig_Name\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP, document.getElementById('figureImage'));\r\n        }\r\n        if (savedStatus[\"fig_Name_left\"] === '' || savedStatus[\"fig_Name_left\"] === 'none') {\r\n            ReactDOM.render(<div/>, document.getElementById('figureImage_left'));\r\n        } else {\r\n            let pUrl = \"game/figure/\" + savedStatus[\"fig_Name_left\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP, document.getElementById('figureImage_left'));\r\n        }\r\n        if (savedStatus[\"fig_Name_right\"] === '' || savedStatus[\"fig_Name_right\"] === 'none') {\r\n            ReactDOM.render(<div/>, document.getElementById('figureImage_right'));\r\n        } else {\r\n            let pUrl = \"game/figure/\" + savedStatus[\"fig_Name_right\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP, document.getElementById('figureImage_right'));\r\n        }\r\n        if (command === 'choose' || command === 'choose_label') {\r\n            let chooseItems = savedStatus[\"choose\"];\r\n            chooseItems = chooseItems.split(\"}\")[0];\r\n            chooseItems = chooseItems.split(\"{\")[1];\r\n            let selection = chooseItems.split(',')\r\n            for (let i = 0; i < selection.length; i++) {\r\n                selection[i] = selection[i].split(\":\");\r\n            }\r\n            let choose_mode = '';\r\n            // eslint-disable-next-line default-case\r\n            switch (command) {\r\n                case 'choose':\r\n                    choose_mode = 'scene';\r\n                    break;\r\n                case 'choose_label':\r\n                    choose_mode = 'label';\r\n                    break;\r\n            }\r\n            WG_ViewControl.VC_choose(selection, choose_mode);\r\n        }\r\n        let changedName = <span>{savedStatus[\"showName\"]}</span>\r\n        let textArray = savedStatus[\"showText\"].split(\"\");\r\n        ReactDOM.render(changedName, document.getElementById('pName'));\r\n        SyncCurrentStatus('vocal', savedStatus['vocal']);\r\n        if (getStatus('bgm') !== savedStatus['bgm']) {\r\n            getRuntime().currentInfo['bgm'] = savedStatus['bgm'];\r\n            WG_ViewControl.loadBGM();\r\n        }\r\n        if (savedStatus['miniAvatar'] !== '' || savedStatus['miniAvatar'] !== 'none') {\r\n            WG_ViewControl.VC_showMiniAvatar(savedStatus['miniAvatar']);\r\n        }\r\n        WG_ViewControl.playVocal();\r\n        WG_ViewControl.showTextArray(textArray);\r\n    }\r\n\r\n    static VC_showSettings() {\r\n        let settingInterface = <div>\r\n            <div className={\"settingsItemsList\"}>\r\n                {/* eslint-disable-next-line react/jsx-pascal-case */}\r\n                <SettingButtons_font/>\r\n                {/* eslint-disable-next-line react/jsx-pascal-case */}\r\n                <SettingButtons_speed/>\r\n                <div className={\"deleteCookie\"} onClick={() => {\r\n                    WG_ViewControl.showMesModel('你确定要清除缓存吗', '要', '不要', clearCookie)\r\n                }}>清除所有设置选项以及存档\r\n                </div>\r\n                <ImporterExporter/>\r\n                <div>本作品由 WebGAL 强力驱动，<a href={\"https://github.com/MakinoharaShoko/WebGAL\"}>了解 WebGAL</a>。</div>\r\n                <br/>\r\n                <div className='settingItemTitle'>效果预览</div>\r\n            </div>\r\n        </div>\r\n        document.getElementById(\"settings\").style.display = \"flex\";\r\n        document.getElementById(\"bottomBox\").style.display = \"none\";\r\n        ReactDOM.render(settingInterface, document.getElementById(\"settingItems\"));\r\n        ReactDOM.render(<div id=\"previewDiv\"/>, document.getElementById('textPreview'));\r\n        WG_ViewControl.showTextPreview('现在预览的是文本框字体大小和播放速度的情况，您可以根据您的观感调整上面的选项。');\r\n    }\r\n\r\n    static VC_showSave_Load(mode) {\r\n        if (mode === 'save') {\r\n            ReactDOM.render(<SaveMainModel PageQty={15}/>, document.getElementById('SaveItems'))\r\n        } else {\r\n            ReactDOM.render(<LoadMainModel PageQty={15}/>, document.getElementById('LoadItems'))\r\n        }\r\n    }\r\n\r\n    static VC_resetStage() {\r\n        // document.getElementById('mainBackground').style.backgroundImage = 'none';\r\n        ReactDOM.render(<div/>, document.getElementById('figureImage'));\r\n        ReactDOM.render(<div/>, document.getElementById('figureImage_left'));\r\n        ReactDOM.render(<div/>, document.getElementById('figureImage_right'));\r\n    }\r\n\r\n    static loadBGM() {\r\n        console.log(\"loadingBGM\")\r\n        let bgmName = getRuntime().currentInfo[\"bgm\"];\r\n        console.log(\"now playing \" + bgmName);\r\n        // console.log(getRuntime().currentInfo);\r\n        if (bgmName === '' || bgmName === 'none') {\r\n            console.log(\"set bgm none\");\r\n            if (document.getElementById(\"currentBGM\")) {\r\n                document.getElementById(\"currentBGM\").autoplay = false;\r\n                document.getElementById(\"currentBGM\").pause();\r\n            }\r\n            ReactDOM.render(<div/>, document.getElementById(\"bgm\"));\r\n            return;\r\n        }\r\n        let url = \"./game/bgm/\" + bgmName;\r\n        let audio = <audio src={url} id={\"currentBGM\"} loop=\"loop\"/>\r\n        // console.log(\"replace old bgm with an empty div\")\r\n        // ReactDOM.render(<div/>,document.getElementById(\"bgm\"));\r\n        ReactDOM.render(audio, document.getElementById(\"bgm\"), audioRendered);\r\n\r\n        function audioRendered() {\r\n            let playControl = document.getElementById(\"currentBGM\");\r\n            let played = false;\r\n            console.log(playControl)\r\n            playControl.oncanplay = function () {\r\n                if (played === false) {\r\n                    playControl.currentTime = 0;\r\n                    playControl.volume = 0.25;\r\n                    played = true;\r\n                    playControl.play();\r\n                }\r\n            }\r\n            if (played === false && document.getElementById(\"currentBGM\")) {\r\n                playControl.currentTime = 0;\r\n                playControl.volume = 0.25;\r\n                played = true;\r\n                playControl.play();\r\n            }\r\n        }\r\n    }\r\n\r\n    static playVocal() {\r\n        console.log(\"Playing vocal:\")\r\n        let runtimeTemp = getStatus(\"all\")\r\n        if (document.getElementById('currentVocal')) {\r\n            document.getElementById('currentVocal').pause();\r\n        }\r\n        let vocalName = runtimeTemp.vocal;\r\n        if (vocalName === '') {\r\n            ReactDOM.render(<div/>, document.getElementById('vocal'));\r\n            return;\r\n        }\r\n        let url = './game/vocal/' + vocalName;\r\n        let vocal = <audio src={url} id={\"currentVocal\"}/>\r\n        ReactDOM.render(vocal, document.getElementById('vocal'));\r\n        let VocalControl = document.getElementById(\"currentVocal\");\r\n        VocalControl.currentTime = 0;\r\n        VocalControl.oncanplay = function () {\r\n            VocalControl.play();\r\n        }\r\n    }\r\n\r\n    static showIntro(text) {\r\n        let i = 0;\r\n        let IntroView = <div>\r\n            <div id={\"textShowArea\"} className={\"textShowArea_styl\"}>\r\n            </div>\r\n        </div>;\r\n        ReactDOM.render(IntroView, document.getElementById(\"intro\"));\r\n        ReactDOM.render(<div>{\" \"}</div>, document.getElementById(\"textShowArea\"));\r\n        document.getElementById(\"intro\").style.display = 'block';\r\n        let textArray = text.split(',');\r\n        let introInterval = setInterval(textShow, 1500);\r\n        let introAll = [];\r\n\r\n        function textShow() {\r\n            let singleRow = <div className={\"introSingleRow\"} key={i}>{textArray[i]}</div>;\r\n            introAll.push(singleRow);\r\n            i = i + 1;\r\n            ReactDOM.render(<div>{introAll}</div>, document.getElementById(\"textShowArea\"));\r\n            if (i >= textArray.length) {\r\n                clearInterval(introInterval);\r\n                setTimeout(userInteract.clearIntro, 3500);\r\n            }\r\n        }\r\n    }\r\n\r\n    static showVideo(videoName) {\r\n        let videoTag = <video autoPlay={true} id={\"video_show\"} src={`./game/video/${videoName}`}/>\r\n        ReactDOM.render(videoTag, document.getElementById(\"videoContainer\"), playVideo);\r\n        document.getElementById(\"videoContainer\").style.display = 'flex'\r\n\r\n        function playVideo() {\r\n            let videoSelector = document.getElementById(\"video_show\");\r\n            videoSelector.onended = () => {\r\n                ReactDOM.render(<div></div>, document.getElementById(\"videoContainer\"));\r\n                document.getElementById(\"videoContainer\").style.display = 'none'\r\n                nextSentenceProcessor();\r\n            }\r\n        }\r\n    }\r\n\r\n    static closeVideo() {\r\n        ReactDOM.render(<div></div>, document.getElementById(\"videoContainer\"));\r\n        document.getElementById(\"videoContainer\").style.display = 'none'\r\n        nextSentenceProcessor();\r\n    }\r\n\r\n    static loadButton() {\r\n        let renNewButton = <div className={\"toCenter\"}>\r\n            <ControlButton color='#FEDFE1' fun={this.playVocal} name={\"重复\"} simpleName={\"V\"}/>\r\n            <ControlButton color='#FB966E' fun={userInteract.autoNext} name={\"自动\"} simpleName={\"A\"} id={\"autoButton\"}/>\r\n            <ControlButton color='#FBE251' fun={userInteract.fastNext} name={\"快进\"} simpleName={\"F\"} id={\"fastButton\"}/>\r\n            <ControlButton color='#A5DEE4' fun={userInteract.onSaveGame} name={\"存档\"} simpleName={\"S\"}/>\r\n            <ControlButton color='#58B2DC' fun={userInteract.onLoadGame} name={\"读档\"} simpleName={\"L\"}/>\r\n            <ControlButton color='#B28FCE' fun={userInteract.onSetting} name={\"设置\"} simpleName={\"C\"}/>\r\n            <ControlButton color='#BDC0BA' fun={userInteract.Title} name={\"标题\"} simpleName={\"T\"}/>\r\n            {/*<ControlButton color = '#FEDFE1' fun={playVocal} name={\"重复\"} simpleName={\"V\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={autoNext} name={\"自动\"} simpleName={\"A\"} id={\"autoButton\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={fastNext} name={\"快进\"} simpleName={\"F\"}   id={\"fastButton\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onSaveGame} name={\"存档\"} simpleName={\"S\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onLoadGame} name={\"读档\"} simpleName={\"L\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onSetting} name={\"设置\"} simpleName={\"C\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={Title} name={\"标题\"} simpleName={\"T\"}/>*/}\r\n        </div>\r\n        ReactDOM.render(renNewButton, document.getElementById(\"controlBar\"));\r\n    }\r\n\r\n    static showBacklog() {\r\n        document.getElementById('backlog').style.display = 'block';\r\n        document.getElementById('bottomBox').style.display = 'none';\r\n        let showBacklogList = [];\r\n        console.log(getRuntime().CurrentBacklog)\r\n        for (let i = 0; i < getRuntime().CurrentBacklog.length; i++) {\r\n            let temp = <div className={'backlog_singleElement'} key={i} style={{\r\n                opacity: 0,\r\n                animationFillMode: 'forwards',\r\n                animationDelay: '' + 0.07 * (getRuntime().CurrentBacklog.length - i) + 's'\r\n            }}>\r\n                <div className={\"backlog_interact\"}>\r\n                    <div className={\"backlog_interact_button\"} onClick={() => {\r\n                        let vocalName = getRuntime().CurrentBacklog[i].vocal;\r\n                        if (vocalName !== '') {\r\n                            let url = './game/vocal/' + vocalName;\r\n                            let elementAudio = <audio src={url} id={\"backlogVocalAudio-\" + i}/>\r\n                            console.log(\"Playing! now url is\" + url);\r\n                            ReactDOM.render(elementAudio, document.getElementById(\"backlogVocal-\" + i));\r\n                            let singleControlBacklogAudio = document.getElementById(\"backlogVocalAudio-\" + i);\r\n                            let played = false;\r\n                            played = false;\r\n                            singleControlBacklogAudio.oncanplay = function () {\r\n                                if (!played) {\r\n                                    singleControlBacklogAudio.currentTime = 0;\r\n                                    played = true;\r\n                                    singleControlBacklogAudio.play();\r\n                                }\r\n                                singleControlBacklogAudio.play();\r\n                            }\r\n                            if (!played) {\r\n                                singleControlBacklogAudio.currentTime = 0;\r\n                                played = true;\r\n                                singleControlBacklogAudio.play();\r\n                            }\r\n                        }\r\n                    }}>\r\n                        <VolumeNotice theme=\"outline\" size=\"24\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className={\"backlog_interact_button\"} onClick={() => {\r\n                        userInteract.jumpFromBacklog(i);\r\n                    }}>\r\n                        <Return theme=\"outline\" size=\"24\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                </div>\r\n                <div className={\"backlog_name\"}>{getRuntime().CurrentBacklog[i].showName}</div>\r\n\r\n                <div className={\"backlog_content\"}>\r\n\r\n                    <div className={\"backlog_text\"}>{getRuntime().CurrentBacklog[i].showText}</div>\r\n                </div>\r\n                <div id={\"backlogVocal-\" + i}>\r\n\r\n                </div>\r\n            </div>\r\n            showBacklogList.push(temp)\r\n        }\r\n        ReactDOM.render(<div>{showBacklogList}</div>, document.getElementById('backlogContent'));\r\n    }\r\n\r\n// 渐显文字\r\n    static showTextArray(textArray) {\r\n        getRuntime().showingText = false;\r\n        ReactDOM.render(<span> </span>, document.getElementById('SceneText'));\r\n        let elementArray = [];\r\n        let i = 0;\r\n        clearInterval(interval);\r\n        var interval = setInterval(showSingle, getRuntime().textShowWaitTime);\r\n        getRuntime().showingText = true;\r\n\r\n        function showSingle() {\r\n            if (!getRuntime().showingText) {\r\n                let textFull = '';\r\n                for (let j = 0; j < textArray.length; j++) {\r\n                    textFull = textFull + textArray[j];\r\n                }\r\n                ReactDOM.render(<div>{textFull}</div>, document.getElementById('SceneText'));\r\n                if (getRuntime().auto === 1) {\r\n                    if (i < textArray.length + 1) {\r\n                        i = textArray.length + 1;\r\n                    } else {\r\n                        i = i + 1;\r\n                    }\r\n                } else {\r\n                    i = textArray.length + 1 + (getRuntime().autoWaitTime / 35);\r\n                }\r\n\r\n            } else {\r\n                let tempElement = <span key={i} className='singleWord'>{textArray[i]}</span>\r\n                elementArray.push(tempElement);\r\n                ReactDOM.render(<div>{elementArray}</div>, document.getElementById('SceneText'));\r\n                i = i + 1;\r\n            }\r\n            if (i > textArray.length && getRuntime().auto !== 1) {\r\n                getRuntime().showingText = false;\r\n            }\r\n            if (i > textArray.length + (getRuntime().autoWaitTime / 35)) {\r\n                if (getRuntime().auto === 1) {\r\n                    if (document.getElementById('currentVocal') && getRuntime().fast === 0) {\r\n                        if (document.getElementById('currentVocal').ended) {\r\n                            clearInterval(interval);\r\n                            getRuntime().showingText = false;\r\n                            nextSentenceProcessor();\r\n                        }\r\n                    } else {\r\n                        clearInterval(interval);\r\n                        getRuntime().showingText = false;\r\n                        nextSentenceProcessor();\r\n                    }\r\n                } else {\r\n                    getRuntime().showingText = false;\r\n                    clearInterval(interval);\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    static showTextPreview(text) {\r\n        getRuntime().onTextPreview = getRuntime().onTextPreview + 1;\r\n        let textArray = text.split(\"\");\r\n        // if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '150%';\r\n        // }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '200%';\r\n        // }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '250%';\r\n        // }\r\n        ReactDOM.render(<span> </span>, document.getElementById('previewDiv'));\r\n        let elementArray = [];\r\n        let i = 0;\r\n        clearInterval(interval2);\r\n        var interval2 = setInterval(showSingle, getRuntime().textShowWaitTime);\r\n\r\n        function showSingle() {\r\n            if (getRuntime().onTextPreview > 1) {\r\n                getRuntime().onTextPreview = getRuntime().onTextPreview - 1;\r\n                clearInterval(interval2);\r\n                return;\r\n            }\r\n            let tempElement = <span key={i} className='singleWord'>{textArray[i]}</span>\r\n            elementArray.push(tempElement);\r\n            ReactDOM.render(<div>{elementArray}</div>, document.getElementById('previewDiv'));\r\n            i = i + 1;\r\n            if (i > textArray.length + (1000 / 35)) {\r\n                clearInterval(interval2);\r\n                interval2 = setInterval(showSingle, getRuntime().textShowWaitTime);\r\n                i = 0;\r\n                elementArray = [];\r\n                // if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '150%';\r\n                // }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '200%';\r\n                // }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '250%';\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    static showMesModel(Title, Left, Right, func) {\r\n        document.getElementById('MesModel').style.display = 'block';\r\n        let element = <div className={'MesMainWindow'}>\r\n            <div className={\"MesTitle\"}>{Title}</div>\r\n            <div className={'MesChooseContainer'}>\r\n                <div className={'MesChoose'} onClick={() => {\r\n                    func();\r\n                    document.getElementById('MesModel').style.display = 'none';\r\n                }}>{Left}</div>\r\n                <div className={'MesChoose'} onClick={() => {\r\n                    document.getElementById('MesModel').style.display = 'none';\r\n                }}>{Right}</div>\r\n            </div>\r\n        </div>\r\n        ReactDOM.render(element, document.getElementById('MesModel'))\r\n    }\r\n\r\n    static VC_showMiniAvatar(name) {\r\n        if (name === '' || name === 'none') {\r\n            ReactDOM.render(<div/>, document.getElementById(\"miniAvatar\"))\r\n            return;\r\n        }\r\n        let url = \"game/figure/\" + name;\r\n        let pic = <img src={url} className={\"miniAvatar_pic\"} alt={\"miniAvatar\"}/>\r\n        ReactDOM.render(pic, document.getElementById(\"miniAvatar\"));\r\n    }\r\n\r\n    static VC_setAnimationByClass(name, animate, time) {\r\n        console.log('setting animate by class on: ' + name + 'set to ' + animate);\r\n        let aniString = animate + ' ' + time;\r\n        let editList = document.getElementsByClassName(name);\r\n        for (let i = 0; i < editList.length; i++) {\r\n            editList[i].style.animation = 'none';\r\n        }\r\n        setTimeout(function () {\r\n            for (let i = 0; i < editList.length; i++) {\r\n                editList[i].style.animation = aniString + ' ease';\r\n            }\r\n        }, 1);\r\n    }\r\n\r\n    static VC_setAnimationById(id, animate, time) {\r\n        document.getElementById(id).style.animation = 'none';\r\n        setTimeout(() => {\r\n            document.getElementById(id).style.animation = animate + ' ' + time + ' ease';\r\n        }, 1)\r\n    }\r\n\r\n// -------- 紧急回避 --------\r\n\r\n    static showPanic(showType) {\r\n        document.querySelector('div#panic-overlay').style.display = 'block';\r\n        if (showType === 'Yoozle') {\r\n            let ele = <div className=\"yoozle-container\">\r\n                <div className=\"yoozle-title\">\r\n                    <span>\r\n                        <span className=\"yoozle-gl-blue\">Y</span><span className=\"yoozle-gl-red\">o</span><span\r\n                        className=\"yoozle-gl-yellow\">o</span><span className=\"yoozle-gl-blue\">z</span><span\r\n                        className=\"yoozle-gl-green\">l</span><span className=\"yoozle-gl-red yoozle-e-rotate\">e</span>\r\n                    </span>\r\n                </div>\r\n                <div className=\"yoozle-search\">\r\n                    <input className=\"yoozle-search-bar\" type=\"text\" defaultValue=\"\"/>\r\n                    <div className=\"yoozle-search-buttons\">\r\n                        <input className=\"yoozle-btn\" type=\"submit\" value=\"Yoozle Search\"/>\r\n                        <input className=\"yoozle-btn\" type=\"submit\" value=\"I'm Feeling Lucky\"/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            ReactDOM.render(ele, document.querySelector('div#panic-overlay'));\r\n            document.querySelector('input.yoozle-search-bar').value = '';\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport {WG_ViewControl}\r\n","import {getRuntime} from \"../StoreControl/StoreControl\";\r\nimport {SyncCurrentStatus, getStatus} from \"../StoreControl/StoreControl\";\r\n\r\n// 处理脚本\r\n\r\n\r\nfunction processSentence(i) {\r\n    if (i < getRuntime().currentScene.length) {\r\n        let vocal = '';\r\n        if (getRuntime().currentScene[i][1] !== '') {\r\n            let text = getRuntime().currentScene[i][1];\r\n            if (getRuntime().currentScene[i][1].split('vocal-').length > 1) {\r\n                vocal = getRuntime().currentScene[i][1].split('vocal-')[1].split(',')[0];\r\n                text = getRuntime().currentScene[i][1].split('vocal-')[1].slice(getRuntime().currentScene[i][1].split('vocal-')[1].split(',')[0].length + 1);\r\n            }\r\n            SyncCurrentStatus(\"showName\", getRuntime().currentScene[i][0]);\r\n            return {name: getStatus('showName'), text: text, vocal: vocal};\r\n        } else {\r\n            let text = getRuntime().currentScene[i][0];\r\n            if (getRuntime().currentScene[i][0].split('vocal-').length > 1) {\r\n                vocal = getRuntime().currentScene[i][0].split('vocal-')[1].split(',')[0];\r\n                text = getRuntime().currentScene[i][0].split('vocal-')[1].slice(getRuntime().currentScene[i][0].split('vocal-')[1].split(',')[0].length + 1);\r\n                text = text.split(\";\")[0];\r\n            }\r\n            return {name: getStatus('showName'), text: text, vocal: vocal};\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 查询当前组件状态\r\n * @param {string | Array.<string> | undefined} widgets\r\n * @returns {boolean | Map.<string, boolean>}\r\n */\r\nfunction queryWidgetState(widgets) {\r\n    const name2query = new Map([['TitleScreen', 'div#Title'], ['TextBox', 'div#bottomBox'], ['SaveScreen', 'div#Save'], ['LoadScreen', 'div#Load'], ['SettingScreen', 'div#settings'], ['BacklogScreen', 'div#backlog'], ['PanicScreen', 'div#panic-overlay'],]);\r\n\r\n    let reduce = false;\r\n    if (typeof (widgets) === 'string') {\r\n        widgets = [widgets,];\r\n        reduce = true;\r\n    } else if (widgets === undefined) {\r\n        widgets = Array.from(name2query.keys())\r\n    }\r\n\r\n    let state_map = new Map();\r\n    for (const wi of widgets) {\r\n        const query = name2query.get(wi);\r\n        if (query === undefined) throw new RangeError(`No widget named ${wi}.`);\r\n        const ele = document.querySelector(query);\r\n        let disp = ele.style.display;\r\n        if (disp === '') disp = window.getComputedStyle(ele).display;\r\n        state_map.set(wi, disp !== 'none');\r\n    }\r\n\r\n    if (reduce) state_map = state_map.values().next().value\r\n    return state_map;\r\n}\r\n\r\nfunction loadSettings() {\r\n    if (getRuntime().Settings[\"font_size\"] === 'small') {\r\n        document.getElementById('SceneText').style.fontSize = '150%';\r\n    } else if (getRuntime().Settings[\"font_size\"] === 'medium') {\r\n        document.getElementById('SceneText').style.fontSize = '200%';\r\n    } else if (getRuntime().Settings[\"font_size\"] === 'large') {\r\n        document.getElementById('SceneText').style.fontSize = '250%';\r\n    }\r\n\r\n    if (getRuntime().Settings[\"play_speed\"] === 'low') {\r\n        getRuntime().textShowWaitTime = 150;\r\n    } else if (getRuntime().Settings[\"play_speed\"] === 'medium') {\r\n        getRuntime().textShowWaitTime = 50;\r\n    } else if (getRuntime().Settings[\"play_speed\"] === 'fast') {\r\n        getRuntime().textShowWaitTime = 10;\r\n    }\r\n}\r\n\r\n/**\r\n * 略过 ignore，检测 states 中所有组件是否均隐藏\r\n * @param {Map.<string, boolean>} states\r\n * @param {string | Array.<string> | undefined} ignore\r\n * @returns {boolean}\r\n */\r\nfunction AllHiddenIgnore(states, ignore) {\r\n    if (typeof (ignore) === 'string') ignore = [ignore,]; else if (ignore === undefined) ignore = []\r\n    for (const [key, value] of states) {\r\n        if (value === true && !ignore.includes(key)) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n//手机优化\r\nfunction isMobile() {\r\n    let info = navigator.userAgent;\r\n    let agents = [\"Android\", \"iPhone\", \"SymbianOS\", \"Windows Phone\", \"iPod\", \"iPad\"];\r\n    for (let i = 0; i < agents.length; i++) {\r\n        if (info.indexOf(agents[i]) >= 0) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction MobileChangeStyle() {\r\n    console.log(\"now is mobile view\");\r\n    document.getElementById('bottomBox').style.height = '45%';\r\n    document.getElementById('ReactRoot').style.fontSize = '65%';\r\n    document.getElementById('mainTextWindow').style.padding = '5px 20% 5px 20%';\r\n    document.getElementById('SceneText').style.padding = '5px 0 0 0';\r\n    forceRotate();\r\n}\r\n\r\nfunction forceRotate() {\r\n    const width = document.documentElement.clientWidth;\r\n    const height = document.documentElement.clientHeight;\r\n    var screen_width = width; //屏幕宽度\r\n    const contentDOM = document.getElementById('ReactRoot');\r\n    if (width < height) {\r\n        screen_width = height; //如果 是竖屏，灵感的宽度就等于屏高\r\n        contentDOM.style.width = height + 'px';\r\n        contentDOM.style.height = width + 'px';\r\n        contentDOM.style.position = 'relative'\r\n        contentDOM.style.top = (height - width) / 2 + 'px';\r\n        contentDOM.style.left = 0 - (height - width) / 2 + 'px';\r\n        contentDOM.style.transform = 'rotate(90deg)';\r\n    }\r\n//根据手机旋转的角度来判断\r\n    const evt = \"onorientationchange\" in window ? \"orientationchange\" : \"resize\"; //旋转事件\r\n    window.addEventListener(evt, function () { //事件监听\r\n        if (window.orientation === 90 || window.orientation === -90) { //旋转到 90 或 -90 度，即竖屏到横屏\r\n            screen_width = height; //横屏，灵感的宽度就等于屏高\r\n            contentDOM.style.width = height + 'px';\r\n            contentDOM.style.height = width + 'px';\r\n            contentDOM.style.position = 'relative'\r\n            contentDOM.style.top = '0px';\r\n            contentDOM.style.left = '0px';\r\n            contentDOM.style.transform = 'none'; //不旋转；\r\n        } else { //旋转到 180 或 0 度，即横屏到竖屏\r\n            screen_width = height; //竖屏，灵感的宽度就等于屏高\r\n            contentDOM.style.width = height + 'px';\r\n            contentDOM.style.height = width + 'px';\r\n            contentDOM.style.position = 'relative'\r\n            contentDOM.style.top = (height - width) / 2 + 'px';\r\n            contentDOM.style.left = 0 - (height - width) / 2 + 'px';\r\n            contentDOM.style.transform = 'rotate(90deg)'; //旋转90度\r\n        }\r\n    }, false);\r\n}\r\n\r\nexport {processSentence, queryWidgetState, loadSettings, AllHiddenIgnore, isMobile, MobileChangeStyle}","import {getRuntime, getScene, getStatus, SyncCurrentStatus} from \"./StoreControl/StoreControl\"\r\nimport {WG_ViewControl} from \"./ViewController/ViewControl\";\r\nimport {processSentence} from \"./util/WG_util\";\r\n\r\n// 读取下一条脚本\r\nfunction nextSentenceProcessor() {\r\n\r\n    if (getRuntime().showingText) {\r\n        getRuntime().showingText = false;\r\n        return;\r\n    }//检测目前是否正在进行文字渐显，如果渐显，则终止渐显，直接读完文本\r\n    let saveBacklogNow = false;//该变量决定此条语句是否需要加入到backlog\r\n    if (getStatus('SentenceID') >= getRuntime().currentScene.length) {\r\n        return;\r\n    }//如果超过场景文本行数，停止处理语句。\r\n    let thisSentence = getRuntime().currentScene[getStatus('SentenceID')];//此条语句的内容\r\n    let command = thisSentence[0];//此条语句的控制文本（也可能是省略人物对话的语句）\r\n    let S_content = thisSentence[1];\r\n    console.log(\"------now running NSP------\" + thisSentence);\r\n    if (command === 'changeBG') {\r\n        WG_ViewControl.VC_changeBG(S_content);//界面控制：换背景\r\n        SyncCurrentStatus(\"bg_Name\", S_content);//同步当前状态\r\n        autoPlay('on');//在非next语句下调用autoplay\r\n    }//改背景\r\n    else if (command === 'changeP') {\r\n        WG_ViewControl.VC_changeP(S_content, 'center');\r\n        SyncCurrentStatus('fig_Name', S_content);\r\n        autoPlay('on');\r\n    }//改立绘\r\n    else if (command === 'changeP_left') {\r\n        WG_ViewControl.VC_changeP(S_content, 'left');\r\n        SyncCurrentStatus('fig_Name_left', S_content);\r\n        autoPlay('on');\r\n    } else if (command === 'changeP_right') {\r\n        WG_ViewControl.VC_changeP(S_content, 'right');\r\n        SyncCurrentStatus('fig_Name_right', S_content);\r\n        autoPlay('on');\r\n    } else if (command === 'changeP_next') {\r\n        WG_ViewControl.VC_changeP(S_content, 'center');\r\n        SyncCurrentStatus('fig_Name', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'changeP_left_next') {\r\n        WG_ViewControl.VC_changeP(S_content, 'left');\r\n        SyncCurrentStatus('fig_Name_left', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'changeP_right_next') {\r\n        WG_ViewControl.VC_changeP(S_content, 'right')\r\n        SyncCurrentStatus('fig_Name_right', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'changeBG_next') {\r\n        WG_ViewControl.VC_changeBG(S_content);\r\n        increaseSentence();\r\n        SyncCurrentStatus(\"bg_Name\", S_content);\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'changeScene') {\r\n        let sUrl = \"game/scene/\" + thisSentence[1];\r\n        getScene(sUrl);\r\n        SyncCurrentStatus('SceneName', S_content);\r\n        return;\r\n    } else if (command === 'choose') {\r\n        // noinspection DuplicatedCode\r\n        SyncCurrentStatus('command', command);\r\n        SyncCurrentStatus('choose', S_content);\r\n        let chooseItems = S_content;\r\n        chooseItems = chooseItems.split(\"}\")[0];\r\n        chooseItems = chooseItems.split(\"{\")[1];\r\n        let selection = chooseItems.split(',')\r\n        for (let i = 0; i < selection.length; i++) {\r\n            selection[i] = selection[i].split(\":\");\r\n        }\r\n        WG_ViewControl.VC_choose(selection, 'scene');\r\n        return;\r\n    } else if (command === 'bgm') {\r\n        SyncCurrentStatus('bgm', S_content);\r\n        // getRuntime().currentInfo[\"bgm\"] =  S_content;\r\n        WG_ViewControl.loadBGM();\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'choose_label') {\r\n        // noinspection DuplicatedCode\r\n        SyncCurrentStatus('command', command);\r\n        SyncCurrentStatus('choose', S_content);\r\n        let chooseItems = S_content;\r\n        chooseItems = chooseItems.split(\"}\")[0];\r\n        chooseItems = chooseItems.split(\"{\")[1];\r\n        let selection = chooseItems.split(',')\r\n        for (let i = 0; i < selection.length; i++) {\r\n            selection[i] = selection[i].split(\":\");\r\n        }\r\n        WG_ViewControl.VC_choose(selection, 'label')\r\n        return;\r\n    } else if (command === 'jump_label') {\r\n        let lab_name = thisSentence[1];\r\n        //find the line of the label:\r\n        jumpSentence(lab_name);\r\n        return;\r\n    } else if (command === 'label') {\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'intro') {\r\n        let introText = thisSentence[1];\r\n        WG_ViewControl.showIntro(introText);\r\n        return;\r\n    } else if (command === 'miniAvatar') {\r\n        WG_ViewControl.VC_showMiniAvatar(S_content);\r\n        SyncCurrentStatus('miniAvatar', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command.substring(0, 3) === \"var\" || command.substring(0, 8) === \"jump_var\") {\r\n        varProcess(command, S_content);\r\n        return;\r\n    } else if (command === 'showVar') {\r\n        console.log(\"showing var\");\r\n        SyncCurrentStatus('command', command);\r\n        SyncCurrentStatus('showName', command);\r\n        SyncCurrentStatus('showText', JSON.stringify(getRuntime().currentInfo.GameVar));\r\n        WG_ViewControl.VC_textShow(getStatus('showName'), getStatus('showText'));\r\n        saveBacklogNow = true;\r\n    } else if (command.substring(0, 2) === 'if') {\r\n        ifJump(command, S_content);\r\n        return;\r\n    } else if (command === 'setBgTransform') {\r\n        setTimeout(() => {\r\n            WG_ViewControl.VC_setBGtransform(S_content);\r\n        }, 100);\r\n        SyncCurrentStatus('bg_transform', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'setBgFilter') {\r\n        setTimeout(() => {\r\n            WG_ViewControl.VC_setBGfilter(S_content);\r\n        }, 100);\r\n        SyncCurrentStatus('bg_filter', S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'setVar') {\r\n        setVar(S_content)\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'setFigAni') {\r\n        let pos = S_content.split(',')[0];\r\n        let aniName = S_content.split(',')[1];\r\n        let aniTime = S_content.split(',')[2];\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainer' + pos, aniName, aniTime);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'setBgAni') {\r\n        let aniName = S_content.split(',')[0];\r\n        let aniTime = S_content.split(',')[1];\r\n        WG_ViewControl.VC_setAnimationById('mainBackground', aniName, aniTime);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    } else if (command === 'playVideo') {\r\n        WG_ViewControl.showVideo(S_content);\r\n    } else {\r\n        SyncCurrentStatus('command', processSentence(getStatus(\"SentenceID\"))['name']);\r\n        SyncCurrentStatus('showName', processSentence(getStatus(\"SentenceID\"))['name']);\r\n        SyncCurrentStatus('showText', processSentence(getStatus(\"SentenceID\"))['text']);\r\n        SyncCurrentStatus('vocal', processSentence(getStatus(\"SentenceID\"))['vocal']);\r\n        WG_ViewControl.VC_textShow(getStatus('showName'), getStatus('showText'));\r\n        if (getStatus(\"all\")[\"vocal\"] !== '') {\r\n            WG_ViewControl.playVocal();\r\n        }\r\n        saveBacklogNow = true;\r\n    }\r\n    increaseSentence();\r\n    if (saveBacklogNow) {\r\n        if (getRuntime().CurrentBacklog.length <= 500) {\r\n            let temp = JSON.stringify(getStatus(\"all\"));\r\n            getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(temp);\r\n        } else {\r\n            getRuntime().CurrentBacklog.shift();\r\n            let temp = JSON.stringify(getStatus(\"all\"));\r\n            getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(temp);\r\n        }\r\n    }\r\n\r\n    function autoPlay(active) {\r\n        if (getRuntime().auto === 1 && active === 'on') {\r\n            setTimeout(jumpNext, getRuntime().autoWaitTime);\r\n\r\n            function jumpNext() {\r\n                if (getRuntime().auto === 1) nextSentenceProcessor();\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\n//sentenceID+1\r\nfunction increaseSentence() {\r\n    SyncCurrentStatus('SentenceID', getStatus('SentenceID') + 1);\r\n}\r\n\r\nfunction varProcess(command, content) {\r\n    if (command === 'varSet') {\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        console.log(content)\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            console.log(singleSet)\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = parseInt(singleSet[1]);\r\n        }\r\n    } else if (command === 'varUp') {\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = getRuntime().currentInfo.GameVar[singleSet[0]] + parseInt(singleSet[1]);\r\n        }\r\n    } else if (command === 'varDrop') {\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = getRuntime().currentInfo.GameVar[singleSet[0]] - parseInt(singleSet[1]);\r\n        }\r\n    } else if (command === 'jump_varReach') {\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        let varArea = content[0];\r\n        varArea = varArea.split(':');\r\n        let JumpArea = content[1];\r\n        console.log(\"var data is\" + parseInt(varArea[1]) + getRuntime().currentInfo.GameVar[varArea[0]])\r\n        if (getRuntime().currentInfo.GameVar[varArea[0]] >= parseInt(varArea[1])) {\r\n            //find the line of the label:\r\n            jumpSentence(JumpArea);\r\n            return;\r\n        }\r\n    } else if (command === 'jump_varBelow') {\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        let varArea = content[0];\r\n        varArea = varArea.split(':');\r\n        let JumpArea = content[1];\r\n        if (getRuntime().currentInfo.GameVar[varArea[0]] < parseInt(varArea[1])) {\r\n            //find the line of the label:\r\n            jumpSentence(JumpArea);\r\n            return;\r\n        }\r\n    }\r\n    console.log(getRuntime().currentInfo.GameVar);\r\n    increaseSentence();\r\n    nextSentenceProcessor();\r\n}\r\n\r\nfunction ifJump(command, content) {\r\n    let judgeBody = command.split(')')[0].split('(')[1];\r\n    console.log(\"judgeBody is: \");\r\n    console.log(judgeBody);\r\n    console.log(judgeBody.split('<=')[1]);\r\n    let jumpActivated = false;\r\n    if (judgeBody.split('<=')[1]) {\r\n        console.log(\"case <=\")\r\n        if (getRuntime().currentInfo.GameVar[judgeBody.split('<=')[0]] <= parseInt(judgeBody.split('<=')[1])) {\r\n            console.log(\"jump to\" + content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    } else if (judgeBody.split('>=')[1]) {\r\n        console.log(\"case >=\")\r\n        if (getRuntime().currentInfo.GameVar[judgeBody.split('>=')[0]] >= parseInt(judgeBody.split('>=')[1])) {\r\n            console.log(\"jump to\" + content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    } else if (judgeBody.split('<')[1]) {\r\n        console.log(\"case <\")\r\n        if (getRuntime().currentInfo.GameVar[judgeBody.split('<')[0]] < parseInt(judgeBody.split('<')[1])) {\r\n            console.log(\"jump to\" + content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    } else if (judgeBody.split('>')[1]) {\r\n        console.log(\"case >\")\r\n        if (getRuntime().currentInfo.GameVar[judgeBody.split('>')[0]] > parseInt(judgeBody.split('>')[1])) {\r\n            console.log(\"jump to\" + content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    } else if (judgeBody.split('=')[1]) {\r\n        console.log(\"case = \")\r\n        if (getRuntime().currentInfo.GameVar[judgeBody.split('=')[0]] === parseInt(judgeBody.split('=')[1])) {\r\n            console.log(\"jump to\" + content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }\r\n    if (!jumpActivated) {\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n    }\r\n}\r\n\r\nfunction jumpSentence(lab_name) {\r\n    //find the line of the label:\r\n    // noinspection DuplicatedCode\r\n    let find = false;\r\n    let jmp_sentence = 0;\r\n    for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n        if (getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name) {\r\n            find = true;\r\n            jmp_sentence = i;\r\n        }\r\n    }\r\n    if (find) {\r\n        SyncCurrentStatus(\"SentenceID\", jmp_sentence);\r\n        nextSentenceProcessor();\r\n\r\n    } else {\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n\r\n    }\r\n}\r\n\r\nfunction setVar(content) {\r\n    let setList = content.split(',');\r\n    for (let i = 0; i < setList.length; i++) {\r\n        let setSent = setList[i];\r\n        setSent = setSent.split('=');\r\n        let setVarName = setSent[0];\r\n        let setVarValue = setSent[1];\r\n        if (setVarValue.split('+')[1]) {\r\n            console.log(\"case +\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('+')[0]];\r\n            let valueRight = parseInt(setVarValue.split('+')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft + valueRight;\r\n        } else if (setVarValue.split('-')[1]) {\r\n            console.log(\"case -\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('-')[0]];\r\n            let valueRight = parseInt(setVarValue.split('-')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft - valueRight;\r\n        } else if (setVarValue.split('*')[1]) {\r\n            console.log(\"case *\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('*')[0]];\r\n            let valueRight = parseInt(setVarValue.split('*')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft * valueRight;\r\n        } else if (setVarValue.split('/')[1]) {\r\n            console.log(\"case /\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('/')[0]];\r\n            let valueRight = parseInt(setVarValue.split('/')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft / valueRight;\r\n        } else {\r\n            console.log(\"case value\")\r\n            getRuntime().currentInfo.GameVar[setVarName] = parseInt(setVarValue);\r\n        }\r\n    }\r\n    console.log(getRuntime().currentInfo.GameVar);\r\n}\r\n\r\nexport {nextSentenceProcessor, increaseSentence}\r\n","import {getStatus} from '../StoreControl/StoreControl';\r\n\r\n\r\nconst cacheVersion = 1;\r\nconst cacheNamePrefix = 'webgal-cache-v';\r\nconst cacheName = cacheNamePrefix + cacheVersion;\r\n\r\nconst startSceneUrl = 'game/scene/start.txt';\r\n\r\n\r\n/**\r\n * 在 ServiceWorker activate 后使用，场景级预加载\r\n *\r\n * 有 ServiceWorker 负责 cache，Wrapper 只管 fetch\r\n *\r\n * @see getScene()\r\n * @see LoadSavedGame()\r\n * @see jumpFromBacklog()\r\n */\r\nclass PrefetchWrapperSW {\r\n    constructor() {\r\n        /**\r\n         * 每批次加载的最大请求数，防止 HTTP 429\r\n         * @type {Number}\r\n         */\r\n        this.maxRequestBatch = 6;\r\n\r\n        /**\r\n         * 两批次加载间的最小时间间隔（毫秒），防止 HTTP 429\r\n         * @type {Number}\r\n         */\r\n        this.minRequestInterval = 3000;\r\n\r\n        /** @type {Array.<String>} */\r\n        this._prefetchPipeline = [];\r\n\r\n        this._batchID = undefined;\r\n\r\n        /** @type {Set.<String>} */\r\n        this._cachedAssets = new Set();\r\n\r\n        this._currentCursor = {scene: '', idx: 0};\r\n    }\r\n\r\n\r\n    /**\r\n     * 变换场景时回调，基于当前场景更新预加载管线\r\n     * @param {String} newSceneUrl 新场景文件的 URL\r\n     * @param {Number} startIdx 开始行索引（从 0 开始）\r\n     */\r\n    async onSceneChange(newSceneUrl, startIdx = 0) {\r\n        const syncCachePromise = this._syncCacheInfo();\r\n        if (newSceneUrl === this._currentCursor.scene && startIdx === this._currentCursor.idx) return;\r\n\r\n        this._currentCursor.scene = newSceneUrl;\r\n        this._currentCursor.idx = startIdx;\r\n\r\n        // clear pipeline\r\n        this.signalPause();\r\n        this.flushPipeline();\r\n\r\n        const resp = await fetch(newSceneUrl);\r\n        if (!resp.ok) throw new Error(`[prefetcher] request for ${newSceneUrl} failed with status ${resp.status}`);\r\n\r\n        // todo: consider moving to worker\r\n        const newAssets = extractAssetUrl(await resp.text(), {sceneUrl: newSceneUrl, startLine: 1 + startIdx});\r\n\r\n        // start urgent fetch\r\n        const urgentPromises = newAssets.urgent.map((asset) => fetch(asset));\r\n\r\n        // discard cached assets from prefetch list\r\n        await syncCachePromise;\r\n        newAssets.all.forEach((asset) => {\r\n            if (this._cachedAssets.has(asset) || newAssets.urgent.includes(asset)) newAssets.all.delete(asset);\r\n        });\r\n\r\n        this.flushPipeline();  // flush again\r\n        this._addToPipeline(newAssets);\r\n        this.signalResume();\r\n\r\n        newAssets.map.get('scene').forEach((scene) => this.suggestNextScene(scene));\r\n\r\n        return Promise.allSettled(urgentPromises);\r\n    }\r\n\r\n\r\n    /**\r\n     * 将 `assets.all` 中的资源加入预加载管线\r\n     * @param {{all: Set.<String>, map: Map.<String, Array.<String>>}} assets\r\n     * @private\r\n     */\r\n    _addToPipeline(assets) {\r\n        // Set() preserves insertion order\r\n        this._prefetchPipeline.push(...assets.all);  // simple non-heuristic approach\r\n    }\r\n\r\n\r\n    /**\r\n     * 扩展可能的下一场景，只有急用资源加入预加载管线\r\n     * @param {String} nextSceneUrl 下一场景文件的 URL\r\n     * @param {Number} startIdx 开始行索引（从 0 开始）\r\n     */\r\n    suggestNextScene(nextSceneUrl, startIdx = 0) {\r\n        const fakeQuery = new URLSearchParams([['expand', true], ['start-idx', startIdx]]).toString();\r\n        // re-fetching a scene is cheap, especially given the caches\r\n        this._prefetchPipeline.push(`${nextSceneUrl}?${fakeQuery}`);\r\n        this.signalResume();\r\n    }\r\n\r\n\r\n    /** 清空预加载管线 */\r\n    flushPipeline() {\r\n        this._prefetchPipeline.length = 0;\r\n    }\r\n\r\n\r\n    /**\r\n     * 暂停预加载，并不清空管线\r\n     * @see flushPipeline()\r\n     */\r\n    signalPause() {\r\n        if (this._batchID !== undefined) clearTimeout(this._batchID);\r\n        this._batchID = undefined;\r\n    }\r\n\r\n\r\n    /** 恢复预加载，多次调用*不会*产生多个请求 */\r\n    signalResume() {\r\n        if (this._batchID !== undefined) return;\r\n\r\n        const tryBatch = (selfID) => {\r\n            if (selfID !== this._batchID) return;\r\n            if (this._prefetchPipeline.length > 0) {\r\n                this._fetchBatch(selfID).catch(() => {\r\n                }).then(() => {\r\n                    if (selfID === this._batchID) {\r\n                        this._syncCacheInfo();\r\n                        const id = setTimeout(() => tryBatch(id), this.minRequestInterval);\r\n                        this._batchID = id;\r\n                    }\r\n                });\r\n            } else {\r\n                this._syncCacheInfo();\r\n                const id = setTimeout(() => tryBatch(id), this.minRequestInterval);\r\n                this._batchID = id;\r\n            }\r\n        };\r\n\r\n        this._syncCacheInfo();\r\n        const id = setTimeout(() => tryBatch(id), 100);\r\n        this._batchID = id;\r\n    }\r\n\r\n\r\n    /** @private */\r\n    _fetchBatch(selfID) {\r\n        const promises = [];\r\n        for (let budget = this.maxRequestBatch; budget > 0;) {\r\n            const assetUrl = this._prefetchPipeline.shift();\r\n            if (assetUrl === undefined) break;\r\n\r\n            if (this._cachedAssets.has(assetUrl)) continue;\r\n\r\n            // check the (fake) query string of scene\r\n            if (assetUrl.split('/', 2)[1] === 'scene') promises.push(this._tryExpandScene(assetUrl, selfID)); else promises.push(fetch(assetUrl));\r\n\r\n            budget--;\r\n        }\r\n        return Promise.allSettled(promises);\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {String} sceneUrl\r\n     * @param selfID\r\n     * @private\r\n     */\r\n    _tryExpandScene(sceneUrl, selfID) {\r\n        const qsIdx = sceneUrl.lastIndexOf('?');\r\n        // todo: handle existing query strings and hashes\r\n        if (qsIdx < 0)\r\n            // no query string\r\n            return fetch(sceneUrl);\r\n\r\n        const qsParam = new URLSearchParams(sceneUrl.substring(qsIdx));\r\n        sceneUrl = sceneUrl.substring(0, qsIdx);  // cut query string for now\r\n        if (qsParam.get('expand') !== `${true}`) return fetch(sceneUrl);\r\n\r\n        const startIdx = Number(qsParam.get('start-idx'));\r\n        return fetch(sceneUrl).then((resp) => {\r\n            if (resp.ok) {\r\n                resp.clone().text().then((sceneText) => {\r\n                    const nextAssets = extractAssetUrl(sceneText, {\r\n                        sceneUrl: sceneUrl, startLine: 1 + startIdx, urgentBudget: 6,  // todo: move this arg to param\r\n                        urgentOnly: true,\r\n                    });\r\n                    for (const asset of nextAssets.urgent) {\r\n                        if (!this._cachedAssets.has(asset) && !this._prefetchPipeline.includes(asset)) this._prefetchPipeline.push(asset)\r\n                    }\r\n                });\r\n            }\r\n            return resp;\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 同步真正 CacheStorage 被缓存的资源\r\n     * @private\r\n     */\r\n    async _syncCacheInfo() {\r\n        if (window.caches === undefined) return;\r\n        try {\r\n            const cache = await caches.open(cacheName);\r\n            const keys = await cache.keys();\r\n            this._cachedAssets = new Set(keys.map((req) => req.url.substring(window.location.href.length)));\r\n        } catch {\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 解析场景中用到的资源\r\n * @param {String} sceneText 场景文本\r\n * @param {{sceneUrl: String, startLine: Number, maxLine: Number, urgentBudget: Number, urgentOnly: Boolean}} options <br/>\r\n *      `sceneUrl` 场景文件 URL，用以去除自引用；<br/>\r\n *      `startLine` 开始解析的自然行（从 1 开始，含）；<br/>\r\n *      `maxLine` 最大解析行数；<br/>\r\n *      `urgentBudget` 最大急用资源数；<br/>\r\n *      `urgentOnly` 只解析到急用资源预算耗尽；<br/>\r\n * @returns {{all: Set.<String>, map: Map.<String, Array.<String>>, urgent: Array.<String>}} 去重、去自引用的资源，格式 `game/type/name`<br/>\r\n *      `all` 全部；<br/>\r\n *      `map` 分类后，键: `background`, `bgm`, `figure`, `scene`, `vocal`；<br/>\r\n *      `urgent` 急用；<br/>\r\n */\r\nfunction extractAssetUrl(sceneText, {\r\n    sceneUrl = '', startLine = 1, maxLine = Number.POSITIVE_INFINITY, urgentBudget = 6, urgentOnly = false\r\n} = {}) {\r\n    /** @type {Set.<String>} */\r\n    const assetAll = new Set();\r\n\r\n    /** @type {Map.<String, Array.<String>>} */\r\n    const assetMap = new Map();\r\n    ['background', 'bgm', 'figure', 'scene', 'vocal'].forEach((key) => {\r\n        assetMap.set(key, []);\r\n    });\r\n\r\n    /** @type {Array.<String>} */\r\n    const assetUrgent = [];\r\n\r\n    /** @param {String} dialogue */\r\n    const extractVocal = (dialogue) => {\r\n        const vocalPrefix = 'vocal-';\r\n        const vocal = dialogue.split(',', 1)[0];\r\n        if (vocal.length < dialogue.length && vocal.length > vocalPrefix.length && vocal.startsWith(vocalPrefix)) return vocal.substring(vocalPrefix.length);\r\n        return '';\r\n    };\r\n\r\n    /**\r\n     * @param {String} filetype\r\n     * @param {String} filename\r\n     */\r\n    const addToAssets = (filetype, filename) => {\r\n        const url = `game/${filetype}/${filename}`;\r\n        if (assetAll.has(url) || (filetype === 'scene' && url === sceneUrl)) return false;\r\n        assetAll.add(url);\r\n        assetMap.get(filetype).push(url);\r\n        if (urgentBudget > 0) {\r\n            assetUrgent.push(url);\r\n            urgentBudget--;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const lines = sceneText.split('\\n');\r\n    for (const [lineIdx, lineData] of lines.entries()) {\r\n        if (lineIdx + 1 - startLine >= maxLine || (urgentOnly && urgentBudget <= 0)) break;\r\n\r\n        if (lineIdx + 1 < startLine) continue;\r\n\r\n        const tokens = lineData.split(';', 1)[0];\r\n        if (!tokens) continue;\r\n\r\n        const cmdOrDlg = tokens.split(':', 1)[0];\r\n        if (cmdOrDlg.length < tokens.length) {\r\n            // `cmdOrDlg` is command (or name of character)\r\n\r\n            const argOrDlg = tokens.substring(cmdOrDlg.length + 1);\r\n            if (!argOrDlg) continue;\r\n\r\n            switch (cmdOrDlg) {\r\n                // if hit, then `cmdOrDlg` is command and `argOrDlg` is argument\r\n\r\n                case 'changeBG':\r\n                case 'changeBG_next':\r\n                    if (argOrDlg !== 'none') addToAssets('background', argOrDlg);\r\n                    break;\r\n\r\n                case 'changeP':\r\n                case 'changeP_left':\r\n                case 'changeP_right':\r\n                case 'changeP_next':\r\n                case 'changeP_left_next':\r\n                case 'changeP_right_next':\r\n                case 'miniAvatar':\r\n                    if (argOrDlg !== 'none') addToAssets('figure', argOrDlg);\r\n                    break;\r\n\r\n                case 'changeScene':\r\n                    addToAssets('scene', argOrDlg);\r\n                    // DO NOT return, the command may be skipped\r\n                    break;\r\n\r\n                case 'choose': {\r\n                    const choices = argOrDlg.trim().slice(1, -1).split(',');\r\n                    for (const choice of choices) {\r\n                        const args = choice.split(':');\r\n                        if (args.length === 2 && args[1]) addToAssets('scene', args[1]);\r\n                    }\r\n                }\r\n                    break;\r\n\r\n                case 'bgm':\r\n                    addToAssets('bgm', argOrDlg);\r\n                    break;\r\n\r\n                // ignore these commands\r\n                case 'intro':\r\n                case 'label':\r\n                case 'jump_label':\r\n                case 'choose_label':\r\n                case 'varSet':\r\n                case 'varUp':\r\n                case 'varDrop':\r\n                case 'jump_varReach':\r\n                case 'jump_varBelow':\r\n                    break;\r\n\r\n                // `cmdOrDlg` is name of character, `argOrDlg` is dialogue\r\n                default: {\r\n                    const vocal = extractVocal(argOrDlg);\r\n                    if (vocal) addToAssets('vocal', vocal);\r\n                }\r\n                    break;\r\n            }\r\n        } else {\r\n            // `cmdOrDlg` is continued dialogue\r\n            const vocal = extractVocal(cmdOrDlg);\r\n            if (vocal) addToAssets('vocal', vocal);\r\n        }\r\n    }\r\n\r\n    return {all: assetAll, map: assetMap, urgent: assetUrgent};\r\n}\r\n\r\n\r\nlet prefetcher = new PrefetchWrapperSW();\r\n\r\nif (window.isSecureContext) {\r\n    if (navigator.serviceWorker !== undefined) {\r\n        window.addEventListener('load', () => {\r\n            navigator.serviceWorker.register('webgal-sw.js')\r\n                .then((reg) => {\r\n                    // on a new service worker being installing\r\n                    reg.onupdatefound = () => {\r\n                        // hack: re-register every time\r\n                        // the service worker is for prefetching rather than offline storage\r\n                        window.addEventListener('beforeunload', () => {\r\n                            reg.unregister();\r\n                        });\r\n\r\n                        reg.installing.onstatechange = (ev) => {\r\n                            if (ev.target.state === 'activated') {\r\n                                console.log('[service worker] claimed');\r\n                                initServiceWorkerPrefetchWrapper();\r\n                            }\r\n                        };\r\n                    };\r\n                })\r\n                .catch((err) => {\r\n                    // reject usually indicates a typo in the filename of service worker\r\n                    // redundant service worker is NOT rejected\r\n                    console.error('[service worker] registration failed: ' + err);\r\n                });\r\n        });\r\n    } else {\r\n        // only private mode in Firefox falls in this category\r\n        console.log('ServiceWorker not supported.');\r\n        // no ServiceWorker, no CacheStorage\r\n        // could be threated as BrowserCache\r\n    }\r\n} else {\r\n    console.warn('Context not secure. Requiring HTTPS to enable CacheStorage and ServiceWorker.');\r\n\r\n    window.addEventListener('load', () => {\r\n        // current implementation is somewhat compatible with browser cache\r\n        // initBrowserCachePrefetchWrapper();\r\n        initServiceWorkerPrefetchWrapper();\r\n        prefetcher.maxRequestBatch = 6;\r\n        prefetcher.minRequestInterval = 5000;\r\n    });\r\n}\r\n\r\n\r\nfunction initServiceWorkerPrefetchWrapper() {\r\n    prefetcher.suggestNextScene(startSceneUrl);\r\n    const contScene = getStatus('SceneName');\r\n    if (contScene && (contScene !== 'start.txt' || getStatus('SentenceID'))) prefetcher.suggestNextScene(`game/scene/${contScene}`, getStatus('SentenceID'));\r\n}\r\n\r\n\r\nexport {prefetcher, startSceneUrl, extractAssetUrl};\r\n","//初始化常量表\r\n// eslint-disable-next-line no-lone-blocks\r\nimport {nextSentenceProcessor} from \"../WG_core\";\r\nimport {prefetcher} from '../util/PrefetchWrapper';\r\nimport pako from 'pako';\r\n\r\n\r\nlet setAutoWaitTime = 1500;\r\nlet autoWaitTime = 1500;\r\nlet textShowWaitTime = 35;\r\n\r\n\r\n//初始化游戏信息表\r\n// eslint-disable-next-line no-lone-blocks\r\n\r\nlet GameInfo = {\r\n    Game_name: 'WebGAL Demo', Game_key: 'WG_default', Title_img: 'Title.png', Title_bgm: '夏影.mp3', Loading_img: 'none'\r\n}\r\n\r\nlet SettingsMap = {\r\n    font_size: {\r\n        'small': '150%', 'medium': '200%', 'large': '250%',\r\n    }, play_speed: {\r\n        'low': 55, 'medium': 35, 'fast': 20\r\n    }\r\n}\r\n\r\n\r\n//初始化运行时变量表\r\n// eslint-disable-next-line no-lone-blocks\r\n\r\nlet currentScene = '';\r\nlet auto = 0;\r\nlet fast = 0;\r\nlet onTextPreview = 0;\r\nlet showingText = false;\r\nlet hideTextStatus = false;\r\nlet temp_bgm_TitleToGameplay = '';\r\n\r\n\r\n// 初始化状态表\r\nlet currentInfo = {\r\n    SceneName: '',//场景文件名\r\n    SentenceID: 0,//语句ID\r\n    bg_Name: '',//背景文件名\r\n    fig_Name: '',//立绘_中 文件名\r\n    fig_Name_left: '',//立绘_左 文件名\r\n    fig_Name_right: '',//立绘_右 文件名\r\n    showText: '',//文字\r\n    showName: '',//人物名\r\n    command: '',//语句指令\r\n    choose: '',//选项列表\r\n    vocal: '',//语音 文件名\r\n    bgm: '',//背景音乐 文件名\r\n    miniAvatar: '',//小头像\r\n    saveTime: '',\r\n    GameVar: {},\r\n    bg_filter: '',\r\n    bg_transform: '',\r\n}\r\n\r\n// 初始化存档系统\r\nlet Saves = [];\r\nlet SaveBacklog = [];\r\n\r\n// 初始化backlog存储表\r\nlet CurrentBacklog = [];\r\n\r\n//初始化存读档页面记录\r\nlet currentSavePage = 0;\r\nlet currentLoadPage = 0;\r\n\r\n// 初始化设置表\r\nlet Settings = {\r\n    font_size: 'medium', play_speed: 'medium'\r\n};\r\n\r\nlet runtime = {\r\n    setAutoWaitTime,\r\n    autoWaitTime,\r\n    textShowWaitTime,\r\n    GameInfo,\r\n    currentScene,\r\n    auto,\r\n    fast,\r\n    onTextPreview,\r\n    showingText,\r\n    hideTextStatus,\r\n    currentInfo,\r\n    Saves,\r\n    SaveBacklog,\r\n    CurrentBacklog,\r\n    currentSavePage,\r\n    currentLoadPage,\r\n    Settings,\r\n    temp_bgm_TitleToGameplay\r\n}\r\n\r\nfunction getRuntime() {\r\n    return runtime;\r\n}\r\n\r\nfunction loadCookie() {\r\n    if (localStorage.getItem(GameInfo['Game_key'])) {\r\n        // let pre_process = document.cookie;\r\n        // let fst = pre_process.split(';')[0];\r\n        // let scd = document.cookie.slice(fst.length+1);\r\n        let unzip = unzipStr(localStorage.getItem(GameInfo['Game_key']));\r\n        let data = JSON.parse(unzip);\r\n        Saves = data.SavedGame;\r\n        SaveBacklog = data.SavedBacklog;\r\n        currentSavePage = data.SP;\r\n        currentLoadPage = data.LP;\r\n        Settings = data.cSettings;\r\n    }\r\n}\r\n\r\nfunction writeCookie() {\r\n    let toCookie = {\r\n        SavedGame: Saves, SavedBacklog: SaveBacklog, SP: currentSavePage, LP: currentLoadPage, cSettings: Settings\r\n    }\r\n    // console.log(JSON.stringify(toCookie));\r\n    let gzip = zipStr(JSON.stringify(toCookie), {to: 'string'});\r\n    localStorage.setItem(GameInfo['Game_key'], gzip);\r\n    // document.cookie = JSON.stringify(toCookie);\r\n}\r\n\r\nfunction clearCookie() {\r\n    let toCookie = {\r\n        SavedGame: [], SavedBacklog: [], SP: 0, LP: 0, cSettings: {\r\n            font_size: 'medium', play_speed: 'medium'\r\n        }\r\n    }\r\n    let gzip = zipStr(JSON.stringify(toCookie), {to: 'string'});\r\n    localStorage.setItem(GameInfo['Game_key'], gzip);\r\n}\r\n\r\nfunction loadSettings() {\r\n    let fontSizeKey = Settings.font_size;\r\n    let fontSize = SettingsMap.font_size[fontSizeKey];\r\n\r\n    let playSpeedKey = Settings.play_speed;\r\n    let playSpeed = SettingsMap.play_speed[playSpeedKey];\r\n\r\n    document.getElementById('SceneText').style.fontSize = fontSize;\r\n    textShowWaitTime = playSpeed;\r\n}\r\n\r\nfunction SyncCurrentStatus(statusKey, newStatus) {\r\n    if (statusKey === 'all') {\r\n        for (let StatusProp in newStatus) {\r\n            if (currentInfo.hasOwnProperty(StatusProp)) {\r\n                currentInfo[StatusProp] = newStatus[StatusProp];\r\n            }\r\n        }\r\n    } else currentInfo[statusKey] = newStatus;\r\n}\r\n\r\nfunction getStatus(statusKey) {\r\n    if (statusKey === 'all') return currentInfo; else return currentInfo[statusKey];\r\n}\r\n\r\n// 获取场景脚本\r\nfunction getScene(url) {\r\n    currentScene = '';\r\n\r\n    let getScReq = null;\r\n    getScReq = new XMLHttpRequest();\r\n    console.log('now read scene')\r\n    if (getScReq != null) {\r\n        getScReq.open(\"get\", url, true);\r\n        getScReq.send();\r\n        getScReq.onreadystatechange = doResult; //设置回调函数\r\n    }\r\n\r\n    function doResult() {\r\n        if (getScReq.readyState === 4) { //4表示执行完成\r\n            if (getScReq.status === 200) { //200表示执行成功\r\n                currentScene = getScReq.responseText;\r\n                currentScene = currentScene.split('\\n');\r\n                for (let i = 0; i < currentScene.length; i++) {\r\n                    let tempSentence = currentScene[i].split(\";\")[0];\r\n                    let commandLength = tempSentence.split(\":\")[0].length;\r\n                    let command = currentScene[i].split(\":\")[0];\r\n                    command = command.split(';')[0];\r\n                    let content = tempSentence.slice(commandLength + 1);\r\n                    currentScene[i] = currentScene[i].split(\":\");\r\n                    currentScene[i][0] = command;\r\n                    currentScene[i][1] = content;\r\n                }\r\n                console.log('Read scene complete.');\r\n                console.log(currentScene);\r\n                getRuntime().currentScene = currentScene\r\n                SyncCurrentStatus('SentenceID', 0);\r\n                nextSentenceProcessor();\r\n                prefetcher.onSceneChange(url);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction getGameInfo() {\r\n    let getInfoCon = new XMLHttpRequest();\r\n    getInfoCon.onreadystatechange = function () {\r\n        if (getInfoCon.status === 200) {\r\n            let textList = getInfoCon.responseText;\r\n            textList = textList.split('\\n');\r\n            for (let i = 0; i < textList.length; i++) {\r\n                let tempStr = textList[i].split(\";\")[0];\r\n                let temp = tempStr.split(':');\r\n                if (temp[0] == null || temp[0] === '') continue;\r\n                if (GameInfo.hasOwnProperty(temp[0])) {\r\n                    GameInfo[temp[0]] = temp[1];\r\n                } else {\r\n                    console.warn('[GameInfo]', `\\'${temp[0]}\\' key in GameInfo is not exist.`);\r\n                }\r\n            }\r\n            document.getElementById('Title').style.backgroundImage = 'url(\"./game/background/' + GameInfo[\"Title_img\"] + '\")';\r\n            if (GameInfo[\"Loading_img\"] !== 'none') document.getElementById('WG_startPage').style.backgroundImage = 'url(\"./game/background/' + GameInfo[\"Loading_img\"] + '\")';\r\n            SyncCurrentStatus('bgm', GameInfo['Title_bgm']);\r\n            // WG_ViewControl.loadBGM();\r\n            document.title = GameInfo['Game_name'];\r\n        }\r\n\r\n    }\r\n    getInfoCon.open('GET', 'game/config.txt');\r\n    getInfoCon.send();\r\n}\r\n\r\nfunction unzipStr(b64Data) {\r\n    let strData = atob(b64Data);\r\n    const charData = strData.split('').map(function (x) {\r\n        return x.charCodeAt(0);\r\n    });\r\n    const binData = new Uint8Array(charData);\r\n    const data = pako.inflate(binData);\r\n    strData = String.fromCharCode.apply(null, new Uint16Array(data));\r\n    return decodeURIComponent(strData);\r\n}\r\n\r\n// 压缩\r\nfunction zipStr(str) {\r\n    const binaryString = pako.gzip(encodeURIComponent(str), {to: 'string'})\r\n    return btoa(binaryString);\r\n}\r\n\r\nexport {\r\n    setAutoWaitTime,\r\n    autoWaitTime,\r\n    textShowWaitTime,\r\n    GameInfo,\r\n    currentScene,\r\n    auto,\r\n    fast,\r\n    onTextPreview,\r\n    showingText,\r\n    hideTextStatus,\r\n    currentInfo,\r\n    Saves,\r\n    SaveBacklog,\r\n    CurrentBacklog,\r\n    currentSavePage,\r\n    currentLoadPage,\r\n    Settings,\r\n    SettingsMap,\r\n    loadCookie,\r\n    writeCookie,\r\n    clearCookie,\r\n    loadSettings,\r\n    getStatus,\r\n    getScene,\r\n    getGameInfo,\r\n    SyncCurrentStatus,\r\n    getRuntime\r\n}","import {\r\n    Saves,\r\n    SaveBacklog,\r\n    CurrentBacklog,\r\n    writeCookie,\r\n    SyncCurrentStatus,\r\n    getScene,\r\n    loadCookie,\r\n    getRuntime,\r\n    getStatus,\r\n    currentScene\r\n} from \"../StoreControl/StoreControl\";\r\nimport {AllHiddenIgnore, queryWidgetState} from \"../util/WG_util\";\r\nimport * as core from \"../WG_core\"\r\nimport {WG_ViewControl} from \"../ViewController/ViewControl\";\r\nimport {prefetcher} from '../util/PrefetchWrapper';\r\n// import AudioController from \"../util/AudioController\";\r\n\r\n\r\n// eslint-disable-next-line no-self-assign\r\n\r\nclass userInteract {\r\n// 保存当前游戏状态\r\n    static saveGame(index) {\r\n        console.log(\"saving\")\r\n        let tempInfo = JSON.stringify(getStatus(\"all\"));\r\n        Saves[index] = JSON.parse(tempInfo);\r\n        let tempBacklog = JSON.stringify(getRuntime().CurrentBacklog);\r\n        console.log(tempBacklog)\r\n        SaveBacklog[index] = JSON.parse(tempBacklog);\r\n        Saves[index].saveTime = new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString('chinese', {hour12: false});\r\n        writeCookie();\r\n    }\r\n\r\n// 读取游戏存档\r\n    static LoadSavedGame(index) {\r\n        this.closeLoad();\r\n        WG_ViewControl.VC_closeChoose();\r\n        this.hideTitle('non-restart');\r\n        let save = Saves[index];\r\n        let url = 'game/scene/'\r\n        url = url + save['SceneName'];\r\n        getRuntime().currentScene = '';\r\n        let getScReq = null;\r\n        getScReq = new XMLHttpRequest();\r\n        if (getScReq != null) {\r\n            getScReq.open(\"get\", url, true);\r\n            getScReq.send();\r\n            getScReq.onreadystatechange = doResult; //设置回调函数\r\n        }\r\n\r\n        function doResult() {\r\n            if (getScReq.readyState === 4) { //4表示执行完成\r\n                if (getScReq.status === 200) { //200表示执行成功\r\n                    getRuntime().currentScene = getScReq.responseText;\r\n                    getRuntime().currentScene = getRuntime().currentScene.split('\\n');\r\n                    for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n                        let tempSentence = getRuntime().currentScene[i].split(\";\")[0];\r\n                        let commandLength = tempSentence.split(\":\")[0].length;\r\n                        let command = getRuntime().currentScene[i].split(\":\")[0];\r\n                        let content = tempSentence.slice(commandLength + 1);\r\n                        getRuntime().currentScene[i] = getRuntime().currentScene[i].split(\":\");\r\n                        getRuntime().currentScene[i][0] = command;\r\n                        getRuntime().currentScene[i][1] = content;\r\n                    }\r\n                    SyncCurrentStatus('SentenceID', save[\"SentenceID\"]);\r\n                    WG_ViewControl.VC_restoreStatus(save);\r\n                    console.log(SaveBacklog)\r\n                    getRuntime().CurrentBacklog = SaveBacklog[index];\r\n                    console.log(CurrentBacklog);\r\n                    SyncCurrentStatus('all', save);\r\n                    prefetcher.onSceneChange(url, getStatus('SentenceID'));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n//从回溯读取\r\n    static jumpFromBacklog(index) {\r\n        this.closeBacklog();\r\n        WG_ViewControl.VC_closeChoose();\r\n        let save = getRuntime().CurrentBacklog[index];\r\n        for (let i = getRuntime().CurrentBacklog.length - 1; i > index - 1; i--) {\r\n            getRuntime().CurrentBacklog.pop();\r\n        }\r\n        //get Scene:\r\n        let url = 'game/scene/'\r\n        url = url + save['SceneName'];\r\n        getRuntime().currentScene = '';\r\n        let getScReq = null;\r\n        getScReq = new XMLHttpRequest();\r\n        if (getScReq != null) {\r\n            getScReq.open(\"get\", url, true);\r\n            getScReq.send();\r\n            getScReq.onreadystatechange = doResult; //设置回调函数\r\n        }\r\n\r\n        function doResult() {\r\n            if (getScReq.readyState === 4) { //4表示执行完成\r\n                if (getScReq.status === 200) { //200表示执行成功\r\n                    getRuntime().currentScene = getScReq.responseText;\r\n                    getRuntime().currentScene = getRuntime().currentScene.split('\\n');\r\n                    for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n                        let tempSentence = getRuntime().currentScene[i].split(\";\")[0];\r\n                        let commandLength = tempSentence.split(\":\")[0].length;\r\n                        let command = getRuntime().currentScene[i].split(\":\")[0];\r\n                        let content = tempSentence.slice(commandLength + 1);\r\n                        content = content.split(';')[0];\r\n                        command = command.split(';')[0];\r\n                        getRuntime().currentScene[i] = getRuntime().currentScene[i].split(\":\");\r\n                        getRuntime().currentScene[i][0] = command;\r\n                        getRuntime().currentScene[i][1] = content;\r\n                    }\r\n                    SyncCurrentStatus('SentenceID', save[\"SentenceID\"]);\r\n                    console.log(\"restore command sent\")\r\n                    console.log(\"restoring:\" + save)\r\n                    WG_ViewControl.VC_restoreStatus(save);\r\n                    SyncCurrentStatus('all', save);\r\n                    getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(JSON.stringify(getStatus(\"all\")));\r\n                    prefetcher.onSceneChange(url, getStatus('SentenceID'));\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n//从头开始游戏\r\n    static hideTitle(ifRes) {\r\n        getRuntime().CurrentBacklog = [];\r\n        // CurrentBacklog = [];\r\n        document.getElementById('Title').style.display = 'none';\r\n        if (ifRes !== 'non-restart') {\r\n            //隐藏选项界面\r\n            document.getElementById(\"chooseBox\").style.display = \"none\";\r\n            getStatus(\"all\")[\"bgm\"] = '';\r\n            WG_ViewControl.loadBGM();\r\n            getStatus(\"all\")[\"fig_Name\"] = '';\r\n            getStatus(\"all\")[\"fig_left\"] = '';\r\n            getStatus(\"all\")[\"fig_right\"] = '';\r\n            WG_ViewControl.VC_resetStage();\r\n            getScene(\"game/scene/start.txt\");\r\n            getStatus(\"all\")[\"SceneName\"] = 'start.txt';\r\n            getRuntime().currentInfo.bg_Name = 'none';\r\n            //临时解决重新开始游戏后背景不清除的问题\r\n            document.getElementById('mainBackground').style.backgroundImage = 'none';\r\n            //在开始游戏时清除TITLE BGM(临时解决方案）\r\n            // AudioController.loadAudioFile(AudioController.MAIN_BGM, null, true);\r\n        }\r\n        // WG_ViewControl.loadButton();\r\n    }\r\n\r\n// 分支选择（请求getScene）\r\n    static chooseScene(url) {\r\n        // console.log(url);\r\n        getStatus(\"all\")[\"SceneName\"] = url;\r\n        let sUrl = \"game/scene/\" + url;\r\n        getScene(sUrl);\r\n        document.getElementById(\"chooseBox\").style.display = \"none\"\r\n    }\r\n\r\n//通过label跳分支\r\n    static chooseJumpFun(label) {\r\n        let lab_name = label;\r\n        //find the line of the label:\r\n        let find = false;\r\n        let jmp_sentence = 0;\r\n        for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n            if (getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name) {\r\n                find = true;\r\n                jmp_sentence = i;\r\n            }\r\n        }\r\n        if (find) {\r\n            SyncCurrentStatus('SentenceID', jmp_sentence);\r\n            core.nextSentenceProcessor();\r\n            document.getElementById(\"chooseBox\").style.display = \"none\"\r\n        } else {\r\n            core.increaseSentence();\r\n            core.nextSentenceProcessor();\r\n            document.getElementById(\"chooseBox\").style.display = \"none\"\r\n        }\r\n    }\r\n\r\n//点击背景\r\n    static clickOnBack() {\r\n        if (getRuntime().hideTextStatus) {\r\n            document.getElementById('bottomBox').style.display = 'flex';\r\n            getRuntime().hideTextStatus = false;\r\n        } else {\r\n            core.nextSentenceProcessor();\r\n        }\r\n    }\r\n\r\n// 打开设置\r\n    static onSetting() {\r\n        loadCookie();\r\n        WG_ViewControl.VC_showSettings();\r\n        if (getRuntime().Settings[\"font_size\"] === 'small') {\r\n            document.getElementById('previewDiv').style.fontSize = '150%';\r\n        } else if (getRuntime().Settings[\"font_size\"] === 'medium') {\r\n            document.getElementById('previewDiv').style.fontSize = '200%';\r\n        } else if (getRuntime().Settings[\"font_size\"] === 'large') {\r\n            document.getElementById('previewDiv').style.fontSize = '250%';\r\n        }\r\n    }\r\n\r\n//打开读档菜单\r\n    static onLoadGame() {\r\n        loadCookie();\r\n        document.getElementById('Load').style.display = 'block';\r\n        WG_ViewControl.VC_showSave_Load('load');\r\n    }\r\n\r\n//打开存档菜单\r\n    static onSaveGame() {\r\n        loadCookie();\r\n        document.getElementById('Save').style.display = 'block';\r\n        WG_ViewControl.VC_showSave_Load('save');\r\n    }\r\n\r\n// 关闭设置\r\n    static closeSettings() {\r\n        document.getElementById(\"settings\").style.display = \"none\"\r\n        document.getElementById(\"bottomBox\").style.display = \"flex\"\r\n    }\r\n\r\n//自动播放\r\n    static autoNext() {\r\n        if (getRuntime().auto === 0) {\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().textShowWaitTime = 35\r\n            getRuntime().fast = 0;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notFast\");\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 1;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0.195)';\r\n            document.getElementById('autoButton').style.boxShadow = '0 0 25px rgba(255,255,255,0.5)';\r\n            // if(document.getElementById('currentVocal')&&fast === 0){\r\n            //     let interval2 = setInterval(playNext,30)\r\n            //     function playNext(){\r\n            //         if(document.getElementById('currentVocal').ended){\r\n            //             nextSentenceProcessor();\r\n            //             clearInterval(interval2)\r\n            //         }\r\n            //     }\r\n            // }else\r\n            core.nextSentenceProcessor();\r\n        } else if (getRuntime().auto === 1) {\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notAuto\");\r\n        }\r\n    }\r\n\r\n// 快进\r\n    static fastNext() {\r\n        if (getRuntime().fast === 0) {\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notAuto\");\r\n            getRuntime().autoWaitTime = 500;\r\n            getRuntime().textShowWaitTime = 5;\r\n            getRuntime().fast = 1;\r\n            getRuntime().auto = 1;\r\n            // console.log(\"fast\");\r\n            document.getElementById('fastButton').style.backgroundColor = 'rgba(255,255,255,0.195)';\r\n            document.getElementById('fastButton').style.boxShadow = '0 0 25px rgba(255,255,255,0.5)';\r\n            core.nextSentenceProcessor();\r\n\r\n        } else if (getRuntime().fast === 1) {\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().textShowWaitTime = 35\r\n            getRuntime().fast = 0;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('fastButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('fastButton').style.boxShadow = 'none';\r\n            // console.log(\"notFast\");\r\n        }\r\n    }\r\n\r\n// 关闭存档界面\r\n    static closeLoad() {\r\n        document.getElementById('Load').style.display = 'none';\r\n    }\r\n\r\n// 退出（试验中）\r\n    static exit() {\r\n        WG_ViewControl.showMesModel('你确定要退出吗', '退出', '留在本页', function () {\r\n            window.close()\r\n        })\r\n    }\r\n\r\n// 回到标题界面\r\n    static Title() {\r\n        WG_ViewControl.showMesModel('要返回到标题界面吗', '是', '不要', function () {\r\n            document.getElementById('Title').style.display = 'block';\r\n            getRuntime().temp_bgm_TitleToGameplay = getRuntime().currentInfo.bgm;\r\n            SyncCurrentStatus('bgm', getRuntime().GameInfo['Title_bgm']);\r\n            WG_ViewControl.loadBGM();\r\n        })\r\n    }\r\n\r\n// Title页继续游戏\r\n    static continueGame() {\r\n        if (getRuntime().currentScene === '') {\r\n            getScene(\"game/scene/start.txt\");\r\n            getStatus(\"all\")[\"SceneName\"] = 'start.txt';\r\n        }\r\n        document.getElementById('Title').style.display = 'none';\r\n        // WG_ViewControl.loadButton();\r\n        getRuntime().currentInfo.bgm = getRuntime().temp_bgm_TitleToGameplay;\r\n        WG_ViewControl.loadBGM();\r\n    }\r\n\r\n// 关闭存档界面\r\n    static closeSave() {\r\n        document.getElementById('Save').style.display = 'none';\r\n    }\r\n\r\n// 关闭回溯界面\r\n    static closeBacklog() {\r\n        document.getElementById('backlog').style.display = 'none';\r\n        document.getElementById('bottomBox').style.display = 'flex';\r\n    }\r\n\r\n// 关闭intro界面\r\n    static clearIntro() {\r\n        document.getElementById(\"intro\").style.display = 'none';\r\n        core.increaseSentence();\r\n        core.nextSentenceProcessor();\r\n    }\r\n\r\n// 隐藏文本框\r\n    static hideTextBox() {\r\n        // let even = window.event || arguments.callee.caller.arguments[0];\r\n        // even.preventDefault();\r\n        // even.stopPropagation();//阻止事件冒泡\r\n        if (!getRuntime().hideTextStatus) {\r\n            document.getElementById('bottomBox').style.display = 'none';\r\n            getRuntime().hideTextStatus = true;\r\n        }\r\n    }\r\n\r\n// 关闭柚子搜索\r\n    static hidePanic() {\r\n        document.querySelector('div#panic-overlay').style.display = 'none';\r\n    }\r\n\r\n\r\n    static showBacklog() {\r\n        // let even = window.event || arguments.callee.caller.arguments[0];\r\n        // even.preventDefault();\r\n        // even.stopPropagation();//阻止事件冒泡\r\n        WG_ViewControl.showBacklog();\r\n    }\r\n\r\n    static hideStartPage() {\r\n        document.getElementById(\"WG_startPage\").style.display = 'none';\r\n        WG_ViewControl.loadBGM();\r\n        //设置默认动画\r\n        WG_ViewControl.VC_setAnimationById('mainBackground', 'bg_softIn', '2s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainerleft', 'centerIn', '1s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainercenter', 'centerIn', '1s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainerright', 'centerIn', '1s');\r\n    }\r\n}\r\n\r\n\r\n// 禁止F12\r\n// document.onkeydown=function(e){\r\n//         if(e.keyCode === 123){\r\n//             e.returnValue=false\r\n//             return false\r\n//         }\r\n//     }\r\n\r\n// 禁止右键菜单以及选择文字\r\ndocument.addEventListener('contextmenu', function (e) {\r\n    e.preventDefault();\r\n});\r\ndocument.addEventListener('selectstart', function (e) {\r\n    e.preventDefault();\r\n});\r\n\r\n// -------- 右键 --------\r\n\r\ndocument.addEventListener('mouseup', function (ev) {\r\n    if (ev.button === 2) {\r\n        // 目前等功能同于 delete 键\r\n        const evt = new KeyboardEvent('keyup', {key: 'Delete', code: 'Delete'});\r\n        document.dispatchEvent(evt);\r\n        ev.preventDefault();\r\n    }\r\n});\r\n\r\n// -------- 滚轮 --------\r\n\r\ndocument.addEventListener('wheel', function (ev) {\r\n    const state = queryWidgetState();\r\n    if (!(AllHiddenIgnore(state, 'TextBox') && state.get('TextBox'))) return;\r\n    // 「正在游戏」状态\r\n    if (ev.deltaY > 0) {\r\n        core.nextSentenceProcessor();\r\n        ev.preventDefault();\r\n    } else if (ev.deltaY < 0) {\r\n        WG_ViewControl.showBacklog();\r\n        ev.preventDefault();\r\n    }\r\n});\r\n\r\n// -------- 快捷键 --------\r\ndocument.addEventListener('keydown', function (ev) {\r\n    if (ev.isComposing || ev.defaultPrevented || ev.repeat) return;\r\n\r\n    switch (ev.code) {\r\n        // begin ctrl skip\r\n        case 'ControlLeft':\r\n        case 'ControlRight': {\r\n            const state = queryWidgetState();\r\n            // 「正在游戏」状态\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n});\r\ndocument.addEventListener('keyup', function (ev) {\r\n    if (ev.isComposing || ev.defaultPrevented) return;\r\n\r\n    switch (ev.code) {\r\n        // end ctrl skip\r\n        case 'ControlLeft':\r\n        case 'ControlRight': {\r\n            const state = queryWidgetState();\r\n            // 「正在游戏」状态\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // advance text / confirm\r\n        case 'Space':\r\n        case 'Enter':\r\n        case 'NumpadEnter': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                // 文本框显示\r\n                if (state.get('TextBox')) core.nextSentenceProcessor(); else {\r\n                    document.querySelector('div#bottomBox').style.display = 'flex';\r\n                    getRuntime().hideTextStatus = false;\r\n                }\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // auto mode\r\n        case 'KeyA': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.autoNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // skip mode\r\n        case 'KeyF': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // replay voice\r\n        case 'KeyV': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                WG_ViewControl.playVocal();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // save dialog\r\n        case 'KeyS': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'SaveScreen'])) {\r\n                if (state.get('SaveScreen')) userInteract.closeSave(); else userInteract.onSaveGame();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // load dialog\r\n        case 'KeyL': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'LoadScreen'])) {\r\n                if (state.get('LoadScreen')) userInteract.closeLoad(); else userInteract.onLoadGame();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // settings dialog\r\n        case 'KeyC': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'SettingScreen'])) {\r\n                if (state.get('SettingScreen')) userInteract.closeSettings(); else userInteract.onSetting();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // open backlog\r\n        case 'ArrowUp': {\r\n            const state = queryWidgetState();\r\n            // 已经打开 backlog 后不再拦截上键\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                WG_ViewControl.showBacklog();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // open title\r\n        case 'KeyT': {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'Title'])) {\r\n                if (state.get('Title')) userInteract.continueGame(); else userInteract.Title();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // hide window\r\n        case 'Delete': {\r\n            if (AllHiddenIgnore(queryWidgetState(['TitleScreen', 'PanicScreen']))) {\r\n                const state = queryWidgetState(['TextBox', 'SaveScreen', 'LoadScreen', 'SettingScreen', 'BacklogScreen']);\r\n                // 「正在游戏」状态\r\n                if (AllHiddenIgnore(state, 'TextBox')) {\r\n                    if (state.get('TextBox')) {\r\n                        document.querySelector('div#bottomBox').style.display = 'none';\r\n                        getRuntime().hideTextStatus = true;\r\n                    } else {\r\n                        document.querySelector('div#bottomBox').style.display = 'flex';\r\n                        getRuntime().hideTextStatus = false;\r\n                    }\r\n                }\r\n                // 有其他窗口\r\n                else {\r\n                    if (state.get('SaveScreen')) userInteract.closeSave();\r\n                    if (state.get('LoadScreen')) userInteract.closeLoad();\r\n                    if (state.get('SettingScreen')) userInteract.closeSettings();\r\n                    if (state.get('BacklogScreen')) userInteract.closeBacklog()\r\n                    // 紧急回避专用 ESC 键控制\r\n                }\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // panic button\r\n        case 'Escape': {\r\n            if (queryWidgetState('PanicScreen')) userInteract.hidePanic(); else WG_ViewControl.showPanic('Yoozle');\r\n            ev.preventDefault();\r\n        }\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n});\r\n\r\nexport {userInteract};","export default __webpack_public_path__ + \"static/media/closeBlack.48c8b5c9.svg\";","export default __webpack_public_path__ + \"static/media/closeWhite.a1886903.svg\";","export default __webpack_public_path__ + \"static/media/up.17da50db.svg\";","export default __webpack_public_path__ + \"static/media/cross.9d528190.svg\";","import {userInteract} from \"../../Core/InteractController/UserInteract\";\r\nimport {nextSentenceProcessor} from \"../../Core/WG_core\";\r\nimport {WG_ViewControl} from \"../../Core/ViewController/ViewControl\";\r\nimport closeB from \"../../assets/img/closeBlack.svg\"\r\nimport closeW from \"../../assets/img/closeWhite.svg\"\r\nimport up from \"../../assets/img/up.svg\";\r\nimport cross from \"../../assets/img/cross.svg\";\r\nimport '@icon-park/react/styles/index.css';\r\nimport {\r\n    DoubleRight, FolderDownload, FolderUpload, Home, PlayOne, ReplayMusic, SettingTwo\r\n} from \"@icon-park/react\";\r\n\r\nfunction Stage() {\r\n    return (<div className=\"Stage\">\r\n        <div id={\"WG_startPage\"} onClick={() => {\r\n            userInteract.hideStartPage()\r\n        }}>\r\n            {/*点击屏幕以继续*/}\r\n        </div>\r\n        <div id=\"intro\" className=\"intro_styl\"/>\r\n        <div id={\"videoContainer\"} className={\"videoContainer_styl\"} onClick={WG_ViewControl.closeVideo}/>\r\n        <div id=\"MesModel\"/>\r\n        <div id=\"Title\">\r\n            <div id=\"TitleModel\">\r\n                <div id=\"setButtonBottom\">\r\n                    <div className=\"TitleSingleButton\" onClick={userInteract.hideTitle}>\r\n                        <div className={'TitleButtonENG'}>START</div>\r\n                        <div className={'TitleButtonCHN'}>从头开始</div>\r\n                    </div>\r\n                    <div className=\"TitleSingleButton\" onClick={userInteract.continueGame}>\r\n                        <div className={'TitleButtonENG'}>CONTINUE</div>\r\n                        <div className={'TitleButtonCHN'}>继续游戏</div>\r\n                    </div>\r\n                    <div className=\"TitleSingleButton\" onClick={userInteract.onLoadGame}>\r\n                        <div className={'TitleButtonENG'}>LOAD</div>\r\n                        <div className={'TitleButtonCHN'}>读取游戏</div>\r\n                    </div>\r\n                    <div className=\"TitleSingleButton\" onClick={userInteract.onSetting}>\r\n                        <div className={'TitleButtonENG'}>CONFIG</div>\r\n                        <div className={'TitleButtonCHN'}>偏好设置</div>\r\n                    </div>\r\n                    <div className=\"TitleSingleButton\" onClick={userInteract.exit}>\r\n                        <div className={'TitleButtonENG'}>EXIT</div>\r\n                        <div className={'TitleButtonCHN'}>结束游戏</div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n        <div id=\"BackgroundContainer\" onClick={userInteract.clickOnBack}>\r\n            <div id={'oldBG'}/>\r\n            <div id={'mainBackground'}/>\r\n        </div>\r\n        <div id=\"figureImage\" className={\"figureContainercenter\"} onClick={userInteract.clickOnBack}/>\r\n        <div id=\"figureImage_left\" className={\"figureContainerleft\"} onClick={userInteract.clickOnBack}/>\r\n        <div id=\"figureImage_right\" className={\"figureContainerright\"} onClick={userInteract.clickOnBack}/>\r\n        <div id=\"settings\">\r\n            <div id=\"settingsMainBox\">\r\n                <div id=\"close\" onClick={userInteract.closeSettings}>\r\n                    <img src={closeB} className=\"closeSVG\" alt=\"close\"/>\r\n                </div>\r\n                <div id=\"settingsTitle\">\r\n                    设置\r\n                </div>\r\n                <div id=\"settingItems\"/>\r\n                <div id=\"textPreview\"/>\r\n            </div>\r\n        </div>\r\n        <div id=\"backlog\">\r\n            <div id=\"closeBl\" onClick={userInteract.closeBacklog}>\r\n                <img src={closeW} className=\"closeSVG\" alt=\"close\"/>\r\n            </div>\r\n            <div id=\"backlogContent\"/>\r\n        </div>\r\n        <div id=\"Load\" className=\"LS_Main\">\r\n            <div id=\"loadMainBox\" className=\"LS_mainBox\">\r\n                <div id=\"closeLoad\" onClick={userInteract.closeLoad}>\r\n                    <img src={closeW} className=\"closeSVG\" id=\"LoadClose\" alt=\"close\"/>\r\n                </div>\r\n                <div id=\"LoadItems\" className=\"LS_Items\">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id=\"Save\" className=\"LS_Main\">\r\n            <div id=\"saveMainBox\" className=\"LS_mainBox\">\r\n                <div id=\"closeSave\" onClick={userInteract.closeSave}>\r\n                    <img src={closeW} className=\"closeSVG\" alt=\"close\"/>\r\n                </div>\r\n                <div id=\"SaveItems\" className=\"LS_Items\">\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id=\"chooseBox\"/>\r\n        <div id=\"bottomBox\">\r\n            <div id=\"top_control\">\r\n                    <span className=\"top_button\" onClick={userInteract.hideTextBox}>\r\n                        <img alt={\"cross\"} src={cross} style={{width: \"22px\", height: \"22px\"}}/>\r\n                    </span>\r\n                <span className=\"top_button\" onClick={userInteract.showBacklog}>\r\n                        <img alt={\"up\"} src={up} style={{width: \"25px\", height: \"25px\"}}/>\r\n                    </span>\r\n            </div>\r\n            <div id=\"mainTextWindow\" onClick={nextSentenceProcessor}>\r\n                <div id=\"pName\"/>\r\n                <div id=\"SceneText\"/>\r\n            </div>\r\n            <div id=\"controlBar\">\r\n                <div className=\"controlButton\" onClick={WG_ViewControl.playVocal}>\r\n                    <ReplayMusic theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.autoNext} id=\"autoButton\">\r\n                    <PlayOne theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.fastNext} id=\"fastButton\">\r\n                    <DoubleRight theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.onSaveGame} id=\"saveButton\">\r\n                    <FolderDownload theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.onLoadGame} id=\"loadButton\">\r\n                    <FolderUpload theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.onSetting}>\r\n                    <SettingTwo theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n                <div className=\"controlButton\" onClick={userInteract.Title} id=\"titleButton\">\r\n                    <Home theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                </div>\r\n            </div>\r\n            <div id={\"miniAvatar\"} onClick={nextSentenceProcessor}/>\r\n        </div>\r\n        <div id=\"bgm\"/>\r\n        <div id=\"vocal\"/>\r\n        <div id=\"panic-overlay\"/>\r\n    </div>);\r\n}\r\n\r\nexport default Stage;","import Stage from \"./Components/Stage/mainStage\";\r\n// import {\r\n//     setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n//     GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n//     currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,\r\n//     loadCookie,writeCookie,clearCookie,loadSettings,getStatus,getScene,getGameInfo,SyncCurrentStatus\r\n// } from \"./Core/StoreControl/StoreControl\"\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n        <Stage/>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport {\r\n    // setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n    // GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    // currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,\r\n    loadCookie,\r\n    // writeCookie,clearCookie,\r\n    loadSettings,\r\n    // getStatus,getScene,\r\n    getGameInfo,\r\n    // SyncCurrentStatus\r\n} from \"./Core/StoreControl/StoreControl\"\r\n// import {WG_ViewControl} from \"./Core/ViewController/ViewControl\";\r\n// import {isMobile, MobileChangeStyle} from \"./Core/util/WG_util\";\r\nimport './assets/style/animation.css';\r\nimport './assets/style/main.css';\r\nimport './assets/style/Load_Save.css';\r\nimport './assets/style/panic.css';\r\nimport './assets/style/settings.css';\r\nimport './assets/style/window.css'\r\nimport './assets/style/UI_component.css';\r\nimport {isMobile, MobileChangeStyle} from \"./Core/util/WG_util\";\r\n\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App/>\r\n    </React.StrictMode>,\r\n    document.getElementById('ReactRoot')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n\r\nloadCookie();\r\nloadSettings();\r\ngetGameInfo();\r\n\r\nif (isMobile())\r\n    MobileChangeStyle();"],"sourceRoot":""}
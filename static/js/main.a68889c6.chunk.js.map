{"version":3,"sources":["Core/util/WG_util.js","Core/util/PrefetchWrapper.js","Core/InteractController/UserInteract.js","Components/UI/etc.js","Core/util/AudioController.js","Core/ViewController/ViewControl.js","Core/WG_core.js","Core/StoreControl/StoreControl.js","assests/img/closeBlack.svg","assests/img/closeWhite.svg","assests/img/up.svg","assests/img/cross.svg","Components/Stage/mainStage.js","App.js","reportWebVitals.js","index.js"],"names":["processSentence","i","getRuntime","currentScene","length","vocal","text","split","slice","SyncCurrentStatus","name","getStatus","queryWidgetState","widgets","name2query","Map","reduce","undefined","Array","from","keys","state_map","wi","query","get","RangeError","ele","document","querySelector","disp","style","display","window","getComputedStyle","set","values","next","value","AllHiddenIgnore","states","ignore","key","includes","PrefetchWrapperSW","this","maxRequestBatch","minRequestInterval","_prefetchPipeline","_batchID","_cachedAssets","Set","_currentCursor","scene","idx","newSceneUrl","a","startIdx","syncCachePromise","_syncCacheInfo","signalPause","flushPipeline","fetch","resp","ok","Error","status","extractAssetUrl","sceneUrl","startLine","newAssets","urgentPromises","urgent","map","asset","all","forEach","has","delete","_addToPipeline","signalResume","suggestNextScene","Promise","allSettled","assets","push","nextSceneUrl","fakeQuery","URLSearchParams","toString","clearTimeout","tryBatch","selfID","_fetchBatch","catch","then","id","setTimeout","promises","budget","assetUrl","shift","_tryExpandScene","qsIdx","lastIndexOf","qsParam","substring","Number","clone","sceneText","nextAssets","urgentBudget","urgentOnly","caches","open","cacheNamePrefix","cache","req","url","location","href","maxLine","POSITIVE_INFINITY","assetAll","assetMap","assetUrgent","extractVocal","dialogue","vocalPrefix","startsWith","addToAssets","filetype","filename","add","lines","entries","lineIdx","lineData","tokens","cmdOrDlg","argOrDlg","choices","trim","choice","args","prefetcher","initServiceWorkerPrefetchWrapper","contScene","isSecureContext","navigator","serviceWorker","addEventListener","register","reg","onupdatefound","unregister","installing","onstatechange","ev","target","state","console","log","err","error","warn","userInteract","index","tempInfo","JSON","stringify","Saves","parse","tempBacklog","CurrentBacklog","SaveBacklog","saveTime","Date","toLocaleDateString","toLocaleTimeString","hour12","writeCookie","closeLoad","WG_ViewControl","VC_closeChoose","hideTitle","save","getScReq","XMLHttpRequest","send","onreadystatechange","readyState","responseText","tempSentence","commandLength","command","content","VC_restoreStatus","onSceneChange","closeBacklog","pop","ifRes","getElementById","loadBGM","VC_resetStage","getScene","label","lab_name","find","jmp_sentence","core","hideTextStatus","loadCookie","VC_showSettings","Settings","fontSize","VC_showSave_Load","auto","autoWaitTime","setAutoWaitTime","textShowWaitTime","fast","backgroundColor","boxShadow","showMesModel","close","GameInfo","showBacklog","info","userAgent","agents","indexOf","isMobile","height","padding","VC_setAnimationById","VC_setAnimationByClass","e","preventDefault","button","evt","KeyboardEvent","code","dispatchEvent","deltaY","isComposing","defaultPrevented","repeat","fastNext","autoNext","playVocal","closeSave","onSaveGame","onLoadGame","closeSettings","onSetting","continueGame","Title","hidePanic","showPanic","ren_miniPic","leftFigUrl","FigUrl","rightFigUrl","renderList","tempIn","className","src","alt","SettingButtons_font","props","buttonState","buttonStateNow","fontsize","font_size","Object","SettingsMap","setState","onClick","changeButtonState","React","Component","SettingButtons_speed","playSpeed","play_speed","LoadMainModel","Buttons","SaveButtons","LoadPageQty","PageQty","currentPage","currentLoadPage","loadButtons","page","temp","setCurrentPage","thisButtonName","thisButtonText","miniPic","backUrl","LoadSavedGame","backgroundImage","loadSaveButtons","SaveMainModel","ren_bg_list","currentSavePage","save_onSaved","save_NonSaved","saveGame","ControlButton","fun","borderBottom","color","simpleName","ImporterExporter","dummyA","dummyInput","file","files","reader","FileReader","onload","evR","saves","result","localStorage","setItem","reload","readAsText","getItem","blob","Blob","type","blobUrl","URL","createObjectURL","revokeObjectURL","download","click","exportSaves","onChange","importSaves","createAudioContext","AudioContext","audioContext","sources","MAIN_BGM","source","loop","arrayBuffer","audioBuffer","SCENE_BGM","VOCAL","checkSourcesExist","targetSourceKey","hasOwnProperty","start","createBufferSource","buffer","onended","connect","destination","stop","initSound","decodeAudioData","loadAudioFile","autoplay","data","byteLength","isSourceEnded","bg_name","BG","oldBG","cloneNode","parentNode","removeChild","setAttribute","webkitAnimation","animationFillMode","appendChild","newBG","parentNodeBG","P_name","pos","ReactDOM","render","currentInfo","pUrl","changedP","selection","mode","elements","chooseScene","chooseJumpFun","changedName","textArray","showTextArray","savedStatus","chooseItems","choose_mode","VC_choose","VC_showMiniAvatar","settingInterface","clearCookie","showTextPreview","bgmName","bgmPath","AudioController","vocalName","vocalPath","IntroView","introInterval","setInterval","singleRow","introAll","clearInterval","clearIntro","renNewButton","showBacklogList","VolumeNotice","theme","size","fill","jumpFromBacklog","Return","showName","showText","showingText","elementArray","interval","tempElement","textFull","j","nextSentenceProcessor","onTextPreview","interval2","showSingle","Left","Right","func","element","pic","animate","time","aniString","editList","getElementsByClassName","showType","defaultValue","saveBacklogNow","thisSentence","S_content","VC_changeBG","autoPlay","VC_changeP","increaseSentence","introText","showIntro","substr","singleSet","GameVar","parseInt","varArea","JumpArea","varProcess","VC_textShow","judgeBody","jumpActivated","jumpSentence","ifJump","setList","setSent","setVarName","setVarValue","valueLeft","valueRight","setVar","aniName","aniTime","active","Game_name","Game_key","Title_img","Title_bgm","SceneName","SentenceID","bg_Name","fig_Name","fig_Name_left","fig_Name_right","choose","bgm","miniAvatar","runtime","SavedGame","SavedBacklog","SP","LP","cSettings","toCookie","statusKey","newStatus","StatusProp","Stage","hideStartPage","exit","clickOnBack","closeB","closeW","hideTextBox","cross","width","up","ReplayMusic","PlayOne","DoubleRight","FolderDownload","FolderUpload","SettingTwo","Home","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","StrictMode","fontSizeKey","playSpeedKey","loadSettings","getInfoCon","textList","title","getGameInfo"],"mappings":"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","file":"static/js/main.a68889c6.chunk.js","sourcesContent":["import {getRuntime} from \"../StoreControl/StoreControl\";\r\nimport {SyncCurrentStatus,getStatus} from \"../StoreControl/StoreControl\";\r\n\r\n// 处理脚本\r\n\r\n\r\nfunction processSentence(i){\r\n    if(i<getRuntime().currentScene.length)\r\n    {\r\n        let vocal = '';\r\n        if(getRuntime().currentScene[i][1] !== '')\r\n        {\r\n            let text = getRuntime().currentScene[i][1];\r\n            if(getRuntime().currentScene[i][1].split('vocal-').length > 1)\r\n            {\r\n                vocal = getRuntime().currentScene[i][1].split('vocal-')[1].split(',')[0];\r\n                text = getRuntime().currentScene[i][1].split('vocal-')[1].slice(getRuntime().currentScene[i][1].split('vocal-')[1].split(',')[0].length+1);\r\n            }\r\n            SyncCurrentStatus(\"showName\",getRuntime().currentScene[i][0]);\r\n            return {name:getStatus('showName'),text:text,vocal:vocal};\r\n        }\r\n        else\r\n        {\r\n            let text = getRuntime().currentScene[i][0];\r\n            if(getRuntime().currentScene[i][0].split('vocal-').length > 1){\r\n                vocal = getRuntime().currentScene[i][0].split('vocal-')[1].split(',')[0];\r\n                text = getRuntime().currentScene[i][0].split('vocal-')[1].slice(getRuntime().currentScene[i][0].split('vocal-')[1].split(',')[0].length+1);\r\n                text = text.split(\";\")[0];\r\n            }\r\n            return {name:getStatus('showName'),text:text,vocal:vocal};\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 查询当前组件状态\r\n * @param {string | Array.<string> | undefined} widgets\r\n * @returns {boolean | Map.<string, boolean>}\r\n */\r\nfunction queryWidgetState(widgets) {\r\n    const name2query = new Map([\r\n        ['TitleScreen', 'div#Title'],\r\n        ['TextBox', 'div#bottomBox'],\r\n        ['SaveScreen', 'div#Save'],\r\n        ['LoadScreen', 'div#Load'],\r\n        ['SettingScreen', 'div#settings'],\r\n        ['BacklogScreen', 'div#backlog'],\r\n        ['PanicScreen', 'div#panic-overlay'],\r\n    ]);\r\n\r\n    let reduce = false;\r\n    if (typeof (widgets) === 'string') {\r\n        widgets = [widgets,];\r\n        reduce = true;\r\n    }\r\n    else if (widgets === undefined) {\r\n        widgets = Array.from(name2query.keys())\r\n    }\r\n\r\n    let state_map = new Map();\r\n    for (const wi of widgets) {\r\n        const query = name2query.get(wi);\r\n        if (query === undefined)\r\n            throw new RangeError(`No widget named ${wi}.`);\r\n        const ele = document.querySelector(query);\r\n        let disp = ele.style.display;\r\n        if (disp === '')\r\n            disp = window.getComputedStyle(ele).display;\r\n        state_map.set(wi, disp !== 'none');\r\n    }\r\n\r\n    if (reduce)\r\n        state_map = state_map.values().next().value\r\n    return state_map;\r\n}\r\n\r\nfunction loadSettings(){\r\n    if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n        document.getElementById('SceneText').style.fontSize = '150%';\r\n    }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n        document.getElementById('SceneText').style.fontSize = '200%';\r\n    }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n        document.getElementById('SceneText').style.fontSize = '250%';\r\n    }\r\n\r\n    if(getRuntime().Settings[\"play_speed\"] === 'low'){\r\n        getRuntime().textShowWaitTime = 150;\r\n    } else if(getRuntime().Settings[\"play_speed\"] === 'medium'){\r\n        getRuntime().textShowWaitTime = 50;\r\n    }else if(getRuntime().Settings[\"play_speed\"] === 'fast'){\r\n        getRuntime().textShowWaitTime = 10;\r\n    }\r\n}\r\n\r\n/**\r\n * 略过 ignore，检测 states 中所有组件是否均隐藏\r\n * @param {Map.<string, boolean>} states\r\n * @param {string | Array.<string> | undefined} ignore\r\n * @returns {boolean}\r\n */\r\nfunction AllHiddenIgnore(states, ignore) {\r\n    if (typeof (ignore) === 'string')\r\n        ignore = [ignore,];\r\n    else if (ignore === undefined)\r\n        ignore = []\r\n    for (const [key, value] of states) {\r\n        if (value === true && !ignore.includes(key))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n//手机优化\r\nfunction isMobile(){\r\n    let info = navigator.userAgent;\r\n    let agents = [\"Android\", \"iPhone\", \"SymbianOS\", \"Windows Phone\", \"iPod\", \"iPad\"];\r\n    for(let i = 0; i < agents.length; i++){\r\n        if(info.indexOf(agents[i]) >= 0) return true;\r\n    }\r\n    return false;\r\n}\r\nfunction MobileChangeStyle(){\r\n    console.log(\"now is mobile view\");\r\n    document.getElementById('bottomBox').style.height = '45%';\r\n    document.getElementById('ReactRoot').style.fontSize = '65%';\r\n    document.getElementById('mainTextWindow').style.padding = '5px 20% 5px 20%';\r\n    document.getElementById('SceneText').style.padding = '5px 0 0 0';\r\n}\r\n\r\nexport {processSentence,queryWidgetState,loadSettings,AllHiddenIgnore,isMobile,MobileChangeStyle}","import { getStatus } from '../StoreControl/StoreControl';\r\n\r\n\r\nconst cacheVersion = 1;\r\nconst cacheNamePrefix = 'webgal-cache-v';\r\nconst cacheName = cacheNamePrefix + cacheVersion;\r\n\r\nconst startSceneUrl = 'game/scene/start.txt';\r\n\r\n\r\n\r\n/**\r\n * 在 ServiceWorker activate 后使用，场景级预加载\r\n *\r\n * 有 ServiceWorker 负责 cache，Wrapper 只管 fetch\r\n *\r\n * @see getScene()\r\n * @see LoadSavedGame()\r\n * @see jumpFromBacklog()\r\n */\r\nclass PrefetchWrapperSW {\r\n    constructor() {\r\n        /**\r\n         * 每批次加载的最大请求数，防止 HTTP 429\r\n         * @type {Number}\r\n         */\r\n        this.maxRequestBatch = 6;\r\n\r\n        /**\r\n         * 两批次加载间的最小时间间隔（毫秒），防止 HTTP 429\r\n         * @type {Number}\r\n         */\r\n        this.minRequestInterval = 3000;\r\n\r\n        /** @type {Array.<String>} */\r\n        this._prefetchPipeline = [];\r\n\r\n        this._batchID = undefined;\r\n\r\n        /** @type {Set.<String>} */\r\n        this._cachedAssets = new Set();\r\n\r\n        this._currentCursor = { scene: '', idx: 0 };\r\n    }\r\n\r\n\r\n    /**\r\n     * 变换场景时回调，基于当前场景更新预加载管线\r\n     * @param {String} newSceneUrl 新场景文件的 URL\r\n     * @param {Number} startIdx 开始行索引（从 0 开始）\r\n     */\r\n    async onSceneChange(newSceneUrl, startIdx = 0) {\r\n        const syncCachePromise = this._syncCacheInfo();\r\n        if (newSceneUrl === this._currentCursor.scene && startIdx === this._currentCursor.idx)\r\n            return;\r\n\r\n        this._currentCursor.scene = newSceneUrl;\r\n        this._currentCursor.idx = startIdx;\r\n\r\n        // clear pipeline\r\n        this.signalPause();\r\n        this.flushPipeline();\r\n\r\n        const resp = await fetch(newSceneUrl);\r\n        if (!resp.ok)\r\n            throw new Error(`[prefetcher] request for ${newSceneUrl} failed with status ${resp.status}`);\r\n\r\n        // todo: consider moving to worker\r\n        const newAssets = extractAssetUrl(await resp.text(), { sceneUrl: newSceneUrl, startLine: 1 + startIdx });\r\n\r\n        // start urgent fetch\r\n        const urgentPromises = newAssets.urgent.map((asset) => fetch(asset));\r\n\r\n        // discard cached assets from prefetch list\r\n        await syncCachePromise;\r\n        newAssets.all.forEach((asset) => {\r\n            if (this._cachedAssets.has(asset) || newAssets.urgent.includes(asset))\r\n                newAssets.all.delete(asset);\r\n        });\r\n\r\n        this.flushPipeline();  // flush again\r\n        this._addToPipeline(newAssets);\r\n        this.signalResume();\r\n\r\n        newAssets.map.get('scene').forEach((scene) => this.suggestNextScene(scene));\r\n\r\n        return Promise.allSettled(urgentPromises);\r\n    }\r\n\r\n\r\n    /**\r\n     * 将 `assets.all` 中的资源加入预加载管线\r\n     * @param {{all: Set.<String>, map: Map.<String, Array.<String>>}} assets\r\n     * @private\r\n     */\r\n    _addToPipeline(assets) {\r\n        // Set() preserves insertion order\r\n        this._prefetchPipeline.push(...assets.all);  // simple non-heuristic approach\r\n    }\r\n\r\n\r\n    /**\r\n     * 扩展可能的下一场景，只有急用资源加入预加载管线\r\n     * @param {String} nextSceneUrl 下一场景文件的 URL\r\n     * @param {Number} startIdx 开始行索引（从 0 开始）\r\n     */\r\n    suggestNextScene(nextSceneUrl, startIdx = 0) {\r\n        const fakeQuery = new URLSearchParams([['expand', true], ['start-idx', startIdx]]).toString();\r\n        // re-fetching a scene is cheap, especially given the caches\r\n        this._prefetchPipeline.push(`${nextSceneUrl}?${fakeQuery}`);\r\n        this.signalResume();\r\n    }\r\n\r\n\r\n    /** 清空预加载管线 */\r\n    flushPipeline() {\r\n        this._prefetchPipeline.length = 0;\r\n    }\r\n\r\n\r\n    /**\r\n     * 暂停预加载，并不清空管线\r\n     * @see flushPipeline()\r\n     */\r\n    signalPause() {\r\n        if (this._batchID !== undefined)\r\n            clearTimeout(this._batchID);\r\n        this._batchID = undefined;\r\n    }\r\n\r\n\r\n    /** 恢复预加载，多次调用*不会*产生多个请求 */\r\n    signalResume() {\r\n        if (this._batchID !== undefined)\r\n            return;\r\n\r\n        const tryBatch = (selfID) => {\r\n            if (selfID !== this._batchID)\r\n                return;\r\n            if (this._prefetchPipeline.length > 0) {\r\n                this._fetchBatch(selfID).catch(() => { }).then(() => {\r\n                    if (selfID === this._batchID) {\r\n                        this._syncCacheInfo();\r\n                        const id = setTimeout(() => tryBatch(id), this.minRequestInterval);\r\n                        this._batchID = id;\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                this._syncCacheInfo();\r\n                const id = setTimeout(() => tryBatch(id), this.minRequestInterval);\r\n                this._batchID = id;\r\n            }\r\n        };\r\n\r\n        this._syncCacheInfo();\r\n        const id = setTimeout(() => tryBatch(id), 100);\r\n        this._batchID = id;\r\n    }\r\n\r\n\r\n    /** @private */\r\n    _fetchBatch(selfID) {\r\n        const promises = [];\r\n        for (let budget = this.maxRequestBatch; budget > 0;) {\r\n            const assetUrl = this._prefetchPipeline.shift();\r\n            if (assetUrl === undefined)\r\n                break;\r\n\r\n            if (this._cachedAssets.has(assetUrl))\r\n                continue;\r\n\r\n            // check the (fake) query string of scene\r\n            if (assetUrl.split('/', 2)[1] === 'scene')\r\n                promises.push(this._tryExpandScene(assetUrl, selfID));\r\n            else\r\n                promises.push(fetch(assetUrl));\r\n\r\n            budget--;\r\n        }\r\n        return Promise.allSettled(promises);\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {String} sceneUrl\r\n     * @param selfID\r\n     * @private\r\n     */\r\n    _tryExpandScene(sceneUrl, selfID) {\r\n        const qsIdx = sceneUrl.lastIndexOf('?');\r\n        // todo: handle existing query strings and hashes\r\n        if (qsIdx < 0)\r\n            // no query string\r\n            return fetch(sceneUrl);\r\n\r\n        const qsParam = new URLSearchParams(sceneUrl.substring(qsIdx));\r\n        sceneUrl = sceneUrl.substring(0, qsIdx);  // cut query string for now\r\n        if (qsParam.get('expand') !== `${true}`)\r\n            return fetch(sceneUrl);\r\n\r\n        const startIdx = Number(qsParam.get('start-idx'));\r\n        return fetch(sceneUrl).then((resp) => {\r\n            if (resp.ok) {\r\n                resp.clone().text().then((sceneText) => {\r\n                    const nextAssets = extractAssetUrl(sceneText, {\r\n                        sceneUrl: sceneUrl,\r\n                        startLine: 1 + startIdx,\r\n                        urgentBudget: 6,  // todo: move this arg to param\r\n                        urgentOnly: true,\r\n                    });\r\n                    for (const asset of nextAssets.urgent) {\r\n                        if (!this._cachedAssets.has(asset) && !this._prefetchPipeline.includes(asset))\r\n                            this._prefetchPipeline.push(asset)\r\n                    }\r\n                });\r\n            }\r\n            return resp;\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 同步真正 CacheStorage 被缓存的资源\r\n     * @private\r\n     */\r\n    async _syncCacheInfo() {\r\n        if (window.caches === undefined)\r\n            return;\r\n        try {\r\n            const cache = await caches.open(cacheName);\r\n            const keys = await cache.keys();\r\n            this._cachedAssets = new Set(keys.map((req) => req.url.substring(window.location.href.length)));\r\n        }\r\n        catch { }\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 解析场景中用到的资源\r\n * @param {String} sceneText 场景文本\r\n * @param {{sceneUrl: String, startLine: Number, maxLine: Number, urgentBudget: Number, urgentOnly: Boolean}} options <br/>\r\n *      `sceneUrl` 场景文件 URL，用以去除自引用；<br/>\r\n *      `startLine` 开始解析的自然行（从 1 开始，含）；<br/>\r\n *      `maxLine` 最大解析行数；<br/>\r\n *      `urgentBudget` 最大急用资源数；<br/>\r\n *      `urgentOnly` 只解析到急用资源预算耗尽；<br/>\r\n * @returns {{all: Set.<String>, map: Map.<String, Array.<String>>, urgent: Array.<String>}} 去重、去自引用的资源，格式 `game/type/name`<br/>\r\n *      `all` 全部；<br/>\r\n *      `map` 分类后，键: `background`, `bgm`, `figure`, `scene`, `vocal`；<br/>\r\n *      `urgent` 急用；<br/>\r\n */\r\nfunction extractAssetUrl(\r\n    sceneText,\r\n    {\r\n        sceneUrl = '',\r\n        startLine = 1,\r\n        maxLine = Number.POSITIVE_INFINITY,\r\n        urgentBudget = 6,\r\n        urgentOnly = false\r\n    } = {}\r\n) {\r\n    /** @type {Set.<String>} */\r\n    const assetAll = new Set();\r\n\r\n    /** @type {Map.<String, Array.<String>>} */\r\n    const assetMap = new Map();\r\n    ['background', 'bgm', 'figure', 'scene', 'vocal'].forEach((key) => {\r\n        assetMap.set(key, []);\r\n    });\r\n\r\n    /** @type {Array.<String>} */\r\n    const assetUrgent = [];\r\n\r\n    /** @param {String} dialogue */\r\n    const extractVocal = (dialogue) => {\r\n        const vocalPrefix = 'vocal-';\r\n        const vocal = dialogue.split(',', 1)[0];\r\n        if (vocal.length < dialogue.length && vocal.length > vocalPrefix.length && vocal.startsWith(vocalPrefix))\r\n            return vocal.substring(vocalPrefix.length);\r\n        return '';\r\n    };\r\n\r\n    /**\r\n     * @param {String} filetype\r\n     * @param {String} filename\r\n     */\r\n    const addToAssets = (filetype, filename) => {\r\n        const url = `game/${filetype}/${filename}`;\r\n        if (assetAll.has(url) || (filetype === 'scene' && url === sceneUrl))\r\n            return false;\r\n        assetAll.add(url);\r\n        assetMap.get(filetype).push(url);\r\n        if (urgentBudget > 0) {\r\n            assetUrgent.push(url);\r\n            urgentBudget--;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const lines = sceneText.split('\\n');\r\n    for (const [lineIdx, lineData] of lines.entries()) {\r\n        if (lineIdx + 1 - startLine >= maxLine || (urgentOnly && urgentBudget <= 0))\r\n            break;\r\n\r\n        if (lineIdx + 1 < startLine)\r\n            continue;\r\n\r\n        const tokens = lineData.split(';', 1)[0];\r\n        if (!tokens)\r\n            continue;\r\n\r\n        const cmdOrDlg = tokens.split(':', 1)[0];\r\n        if (cmdOrDlg.length < tokens.length) {\r\n            // `cmdOrDlg` is command (or name of character)\r\n\r\n            const argOrDlg = tokens.substring(cmdOrDlg.length + 1);\r\n            if (!argOrDlg)\r\n                continue;\r\n\r\n            switch (cmdOrDlg) {\r\n                // if hit, then `cmdOrDlg` is command and `argOrDlg` is argument\r\n\r\n                case 'changeBG':\r\n                case 'changeBG_next':\r\n                    if (argOrDlg !== 'none')\r\n                        addToAssets('background', argOrDlg);\r\n                    break;\r\n\r\n                case 'changeP':\r\n                case 'changeP_left':\r\n                case 'changeP_right':\r\n                case 'changeP_next':\r\n                case 'changeP_left_next':\r\n                case 'changeP_right_next':\r\n                case 'miniAvatar':\r\n                    if (argOrDlg !== 'none')\r\n                        addToAssets('figure', argOrDlg);\r\n                    break;\r\n\r\n                case 'changeScene':\r\n                    addToAssets('scene', argOrDlg);\r\n                    // DO NOT return, the command may be skipped\r\n                    break;\r\n\r\n                case 'choose': {\r\n                    const choices = argOrDlg.trim().slice(1, -1).split(',');\r\n                    for (const choice of choices) {\r\n                        const args = choice.split(':');\r\n                        if (args.length === 2 && args[1])\r\n                            addToAssets('scene', args[1]);\r\n                    }\r\n                }\r\n                    break;\r\n\r\n                case 'bgm':\r\n                    addToAssets('bgm', argOrDlg);\r\n                    break;\r\n\r\n                // ignore these commands\r\n                case 'intro':\r\n                case 'label':\r\n                case 'jump_label':\r\n                case 'choose_label':\r\n                case 'varSet':\r\n                case 'varUp':\r\n                case 'varDrop':\r\n                case 'jump_varReach':\r\n                case 'jump_varBelow':\r\n                    break;\r\n\r\n                // `cmdOrDlg` is name of character, `argOrDlg` is dialogue\r\n                default: {\r\n                    const vocal = extractVocal(argOrDlg);\r\n                    if (vocal)\r\n                        addToAssets('vocal', vocal);\r\n                }\r\n                    break;\r\n            }\r\n        }\r\n        else {\r\n            // `cmdOrDlg` is continued dialogue\r\n            const vocal = extractVocal(cmdOrDlg);\r\n            if (vocal)\r\n                addToAssets('vocal', vocal);\r\n        }\r\n    }\r\n\r\n    return { all: assetAll, map: assetMap, urgent: assetUrgent };\r\n}\r\n\r\n\r\n\r\nlet prefetcher = new PrefetchWrapperSW();\r\n\r\nif (window.isSecureContext) {\r\n    if (navigator.serviceWorker !== undefined) {\r\n        window.addEventListener('load', () => {\r\n            navigator.serviceWorker.register('webgal-sw.js')\r\n                .then((reg) => {\r\n                    // on a new service worker being installing\r\n                    reg.onupdatefound = () => {\r\n                        // hack: re-register every time\r\n                        // the service worker is for prefetching rather than offline storage\r\n                        window.addEventListener('beforeunload', () => { reg.unregister(); });\r\n\r\n                        reg.installing.onstatechange = (ev) => {\r\n                            if (ev.target.state === 'activated') {\r\n                                console.log('[service worker] claimed');\r\n                                initServiceWorkerPrefetchWrapper();\r\n                            }\r\n                        };\r\n                    };\r\n                })\r\n                .catch((err) => {\r\n                    // reject usually indicates a typo in the filename of service worker\r\n                    // redundant service worker is NOT rejected\r\n                    console.error('[service worker] registration failed: ' + err);\r\n                });\r\n        });\r\n    }\r\n    else {\r\n        // only private mode in Firefox falls in this category\r\n        console.log('ServiceWorker not supported.');\r\n        // no ServiceWorker, no CacheStorage\r\n        // could be threated as BrowserCache\r\n    }\r\n}\r\nelse {\r\n    console.warn('Context not secure. Requiring HTTPS to enable CacheStorage and ServiceWorker.');\r\n\r\n    window.addEventListener('load', () => {\r\n        // current implementation is somewhat compatible with browser cache\r\n        // initBrowserCachePrefetchWrapper();\r\n        initServiceWorkerPrefetchWrapper();\r\n        prefetcher.maxRequestBatch = 6;\r\n        prefetcher.minRequestInterval = 5000;\r\n    });\r\n}\r\n\r\n\r\n\r\nfunction initServiceWorkerPrefetchWrapper() {\r\n    prefetcher.suggestNextScene(startSceneUrl);\r\n    const contScene = getStatus('SceneName');\r\n    if (contScene && (contScene !== 'start.txt' || getStatus('SentenceID')))\r\n        prefetcher.suggestNextScene(`game/scene/${contScene}`, getStatus('SentenceID'));\r\n}\r\n\r\n\r\n\r\nexport { prefetcher, startSceneUrl, extractAssetUrl };\r\n","import React from 'react';\r\nimport ReactDOM from \"react-dom\";\r\nimport {\r\n    Saves, SaveBacklog, CurrentBacklog,\r\n    writeCookie,\r\n    SyncCurrentStatus, getScene, loadCookie, getRuntime, getStatus, GameInfo, loadSettings, getGameInfo\r\n} from \"../StoreControl/StoreControl\";\r\nimport {AllHiddenIgnore, isMobile, MobileChangeStyle, queryWidgetState} from \"../util/WG_util\";\r\nimport * as core from \"../WG_core\"\r\nimport {WG_ViewControl} from \"../ViewController/ViewControl\";\r\nimport { prefetcher } from '../util/PrefetchWrapper';\r\n\r\n\r\n\r\n// eslint-disable-next-line no-self-assign\r\n\r\nclass userInteract {\r\n// 保存当前游戏状态\r\n    static saveGame(index){\r\n        console.log(\"saving\")\r\n        let tempInfo = JSON.stringify(getStatus(\"all\"));\r\n        Saves[index] = JSON.parse(tempInfo);\r\n        let tempBacklog = JSON.stringify(getRuntime().CurrentBacklog);\r\n        console.log(tempBacklog)\r\n        SaveBacklog[index]= JSON.parse(tempBacklog);\r\n        Saves[index].saveTime = new Date().toLocaleDateString() +' '+ new Date().toLocaleTimeString('chinese',{hour12:false});\r\n        writeCookie();\r\n    }\r\n\r\n// 读取游戏存档\r\n    static LoadSavedGame(index) {\r\n        this.closeLoad();\r\n        WG_ViewControl.VC_closeChoose();\r\n        this.hideTitle('non-restart');\r\n        let save = Saves[index];\r\n        let url = 'game/scene/'\r\n        url = url + save['SceneName'];\r\n        getRuntime().currentScene ='';\r\n        let getScReq = null;\r\n        getScReq = new XMLHttpRequest();\r\n        if (getScReq != null) {\r\n            getScReq.open(\"get\",url , true);\r\n            getScReq.send();\r\n            getScReq.onreadystatechange = doResult; //设置回调函数\r\n        }\r\n        function doResult() {\r\n            if (getScReq.readyState === 4) { //4表示执行完成\r\n                if (getScReq.status === 200) { //200表示执行成功\r\n                    getRuntime().currentScene = getScReq.responseText;\r\n                    getRuntime().currentScene = getRuntime().currentScene.split('\\n');\r\n                    for (let i = 0;i<getRuntime().currentScene.length;i++){\r\n                        let tempSentence = getRuntime().currentScene[i].split(\";\")[0];\r\n                        let commandLength = tempSentence.split(\":\")[0].length;\r\n                        let command = getRuntime().currentScene[i].split(\":\")[0];\r\n                        let content = tempSentence.slice(commandLength+1);\r\n                        getRuntime().currentScene[i] = getRuntime().currentScene[i].split(\":\");\r\n                        getRuntime().currentScene[i][0] = command;\r\n                        getRuntime().currentScene[i][1] = content;\r\n                    }\r\n                    SyncCurrentStatus('SentenceID',save[\"SentenceID\"]);\r\n                    WG_ViewControl.VC_restoreStatus(save);\r\n                    console.log(SaveBacklog)\r\n                    getRuntime().CurrentBacklog = SaveBacklog[index];\r\n                    console.log(CurrentBacklog);\r\n                    SyncCurrentStatus('all',save);\r\n                    prefetcher.onSceneChange(url, getStatus('SentenceID'));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n//从回溯读取\r\n    static jumpFromBacklog(index) {\r\n        this.closeBacklog();\r\n        WG_ViewControl.VC_closeChoose();\r\n        let save = getRuntime().CurrentBacklog[index];\r\n        for (let i = getRuntime().CurrentBacklog.length - 1 ; i > index-1 ; i--){\r\n            getRuntime().CurrentBacklog.pop();\r\n        }\r\n        //get Scene:\r\n        let url = 'game/scene/'\r\n        url = url + save['SceneName'];\r\n        getRuntime().currentScene ='';\r\n        let getScReq = null;\r\n        getScReq = new XMLHttpRequest();\r\n        if (getScReq != null) {\r\n            getScReq.open(\"get\",url , true);\r\n            getScReq.send();\r\n            getScReq.onreadystatechange = doResult; //设置回调函数\r\n        }\r\n        function doResult() {\r\n            if (getScReq.readyState === 4) { //4表示执行完成\r\n                if (getScReq.status === 200) { //200表示执行成功\r\n                    getRuntime().currentScene = getScReq.responseText;\r\n                    getRuntime().currentScene = getRuntime().currentScene.split('\\n');\r\n                    for (let i = 0;i<getRuntime().currentScene.length;i++){\r\n                        let tempSentence = getRuntime().currentScene[i].split(\";\")[0];\r\n                        let commandLength = tempSentence.split(\":\")[0].length;\r\n                        let command = getRuntime().currentScene[i].split(\":\")[0];\r\n                        let content = tempSentence.slice(commandLength+1);\r\n                        getRuntime().currentScene[i] = getRuntime().currentScene[i].split(\":\");\r\n                        getRuntime().currentScene[i][0] = command;\r\n                        getRuntime().currentScene[i][1] = content;\r\n                    }\r\n                    SyncCurrentStatus('SentenceID',save[\"SentenceID\"]);\r\n                    console.log(\"restore command sent\")\r\n                    console.log(\"restoring:\"+save)\r\n                    WG_ViewControl.VC_restoreStatus(save);\r\n                    SyncCurrentStatus('all',save);\r\n                    getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(JSON.stringify(getStatus(\"all\")));\r\n                    prefetcher.onSceneChange(url, getStatus('SentenceID'));\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n//从头开始游戏\r\n    static hideTitle(ifRes) {\r\n        getRuntime().CurrentBacklog = [];\r\n        // CurrentBacklog = [];\r\n        document.getElementById('Title').style.display = 'none';\r\n        if(ifRes !== 'non-restart'){\r\n            //隐藏选项界面\r\n            document.getElementById(\"chooseBox\").style.display=\"none\";\r\n            getStatus(\"all\")[\"bgm\"] = '';\r\n            WG_ViewControl.loadBGM();\r\n            getStatus(\"all\")[\"fig_Name\"] = '';\r\n            getStatus(\"all\")[\"fig_left\"] = '';\r\n            getStatus(\"all\")[\"fig_right\"] = '';\r\n            WG_ViewControl.VC_resetStage();\r\n            getScene(\"game/scene/start.txt\");\r\n            getStatus(\"all\")[\"SceneName\"] = 'start.txt';\r\n        }\r\n        // WG_ViewControl.loadButton();\r\n    }\r\n\r\n// 分支选择（请求getScene）\r\n    static chooseScene(url){\r\n        // console.log(url);\r\n        getStatus(\"all\")[\"SceneName\"] = url;\r\n        let sUrl = \"game/scene/\"+url;\r\n        getScene(sUrl);\r\n        document.getElementById(\"chooseBox\").style.display=\"none\"\r\n    }\r\n\r\n//通过label跳分支\r\n    static chooseJumpFun(label){\r\n        let lab_name = label;\r\n        //find the line of the label:\r\n        let find = false;\r\n        let jmp_sentence = 0;\r\n        for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n            if(getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name){\r\n                find = true;\r\n                jmp_sentence = i;\r\n            }\r\n        }\r\n        if(find){\r\n            SyncCurrentStatus('SentenceID',jmp_sentence);\r\n            core.nextSentenceProcessor();\r\n            document.getElementById(\"chooseBox\").style.display=\"none\"\r\n        }else\r\n        {\r\n            core.increaseSentence();\r\n            core.nextSentenceProcessor();\r\n            document.getElementById(\"chooseBox\").style.display=\"none\"\r\n        }\r\n    }\r\n\r\n//点击背景\r\n    static clickOnBack(){\r\n        if(getRuntime().hideTextStatus){\r\n            document.getElementById('bottomBox').style.display = 'flex';\r\n            getRuntime().hideTextStatus = false;\r\n        }else {\r\n            core.nextSentenceProcessor();\r\n        }\r\n    }\r\n\r\n// 打开设置\r\n    static onSetting(){\r\n        loadCookie();\r\n        WG_ViewControl.VC_showSettings();\r\n        if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n            document.getElementById('previewDiv').style.fontSize = '150%';\r\n        }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n            document.getElementById('previewDiv').style.fontSize = '200%';\r\n        }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n            document.getElementById('previewDiv').style.fontSize = '250%';\r\n        }\r\n    }\r\n\r\n//打开读档菜单\r\n    static onLoadGame() {\r\n        loadCookie();\r\n        document.getElementById('Load').style.display = 'block';\r\n        WG_ViewControl.VC_showSave_Load('load');\r\n    }\r\n\r\n//打开存档菜单\r\n    static onSaveGame() {\r\n        loadCookie();\r\n        document.getElementById('Save').style.display = 'block';\r\n        WG_ViewControl.VC_showSave_Load('save');\r\n    }\r\n\r\n// 关闭设置\r\n    static closeSettings(){\r\n        document.getElementById(\"settings\").style.display = \"none\"\r\n        document.getElementById(\"bottomBox\").style.display = \"flex\"\r\n    }\r\n\r\n//自动播放\r\n    static autoNext(){\r\n        if(getRuntime().auto === 0){\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().textShowWaitTime = 35\r\n            getRuntime().fast = 0;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notFast\");\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 1;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0.195)';\r\n            document.getElementById('autoButton').style.boxShadow = '0 0 25px rgba(255,255,255,0.5)';\r\n            // if(document.getElementById('currentVocal')&&fast === 0){\r\n            //     let interval2 = setInterval(playNext,30)\r\n            //     function playNext(){\r\n            //         if(document.getElementById('currentVocal').ended){\r\n            //             nextSentenceProcessor();\r\n            //             clearInterval(interval2)\r\n            //         }\r\n            //     }\r\n            // }else\r\n            core.nextSentenceProcessor();\r\n        }\r\n        else if(getRuntime().auto === 1){\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notAuto\");\r\n        }\r\n    }\r\n\r\n// 快进\r\n    static fastNext(){\r\n        if(getRuntime().fast === 0){\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('autoButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('autoButton').style.boxShadow = 'none';\r\n            // console.log(\"notAuto\");\r\n            getRuntime().autoWaitTime = 500;\r\n            getRuntime().textShowWaitTime = 5;\r\n            getRuntime().fast = 1;\r\n            getRuntime().auto = 1;\r\n            // console.log(\"fast\");\r\n            document.getElementById('fastButton').style.backgroundColor = 'rgba(255,255,255,0.195)';\r\n            document.getElementById('fastButton').style.boxShadow = '0 0 25px rgba(255,255,255,0.5)';\r\n            core.nextSentenceProcessor();\r\n\r\n        }\r\n        else if(getRuntime().fast === 1){\r\n            getRuntime().autoWaitTime = getRuntime().setAutoWaitTime;\r\n            getRuntime().textShowWaitTime = 35\r\n            getRuntime().fast = 0;\r\n            getRuntime().auto = 0;\r\n            document.getElementById('fastButton').style.backgroundColor = 'rgba(255,255,255,0)';\r\n            document.getElementById('fastButton').style.boxShadow = 'none';\r\n            // console.log(\"notFast\");\r\n        }\r\n    }\r\n\r\n// 关闭存档界面\r\n    static closeLoad() {\r\n        document.getElementById('Load').style.display = 'none';\r\n    }\r\n\r\n// 退出（试验中）\r\n    static exit(){\r\n        WG_ViewControl.showMesModel('你确定要退出吗','退出','留在本页',function (){window.close()})\r\n    }\r\n\r\n// 回到标题界面\r\n    static Title() {\r\n        WG_ViewControl.showMesModel('要返回到标题界面吗','是','不要',function (){\r\n            document.getElementById('Title').style.display = 'block';\r\n            SyncCurrentStatus('bgm',getRuntime().GameInfo['Title_bgm']);\r\n            WG_ViewControl.loadBGM();\r\n        })\r\n    }\r\n\r\n// Title页继续游戏\r\n    static continueGame(){\r\n        if(getRuntime().currentScene === ''){\r\n            getScene(\"game/scene/start.txt\");\r\n            getStatus(\"all\")[\"SceneName\"] = 'start.txt';\r\n        }\r\n        document.getElementById('Title').style.display = 'none';\r\n        // WG_ViewControl.loadButton();\r\n    }\r\n\r\n// 关闭存档界面\r\n    static closeSave() {\r\n        document.getElementById('Save').style.display = 'none';\r\n    }\r\n\r\n// 关闭回溯界面\r\n    static closeBacklog(){\r\n        document.getElementById('backlog').style.display = 'none';\r\n        document.getElementById('bottomBox').style.display = 'flex';\r\n    }\r\n\r\n// 关闭intro界面\r\n    static clearIntro(){\r\n        document.getElementById(\"intro\").style.display = 'none';\r\n        core.increaseSentence();\r\n        core.nextSentenceProcessor();\r\n    }\r\n\r\n// 隐藏文本框\r\n    static hideTextBox(){\r\n        // let even = window.event || arguments.callee.caller.arguments[0];\r\n        // even.preventDefault();\r\n        // even.stopPropagation();//阻止事件冒泡\r\n        if(!getRuntime().hideTextStatus){\r\n            document.getElementById('bottomBox').style.display = 'none';\r\n            getRuntime().hideTextStatus = true;\r\n        }\r\n    }\r\n\r\n// 关闭柚子搜索\r\n    static hidePanic() {\r\n        document.querySelector('div#panic-overlay').style.display = 'none';\r\n    }\r\n\r\n\r\n\r\n    static showBacklog(){\r\n        // let even = window.event || arguments.callee.caller.arguments[0];\r\n        // even.preventDefault();\r\n        // even.stopPropagation();//阻止事件冒泡\r\n        WG_ViewControl.showBacklog();\r\n    }\r\n\r\n    static hideStartPage(){\r\n        document.getElementById(\"WG_startPage\").style.display = 'none';\r\n        WG_ViewControl.loadBGM();\r\n        if(isMobile()){\r\n            MobileChangeStyle();\r\n        }\r\n        //设置默认动画\r\n        WG_ViewControl.VC_setAnimationById('mainBackground','bg_softIn','2s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainerleft','centerIn','1s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainercenter','centerIn','1s');\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainerright','centerIn','1s');\r\n    }\r\n}\r\n\r\n\r\n\r\n// 禁止F12\r\n// document.onkeydown=function(e){\r\n//         if(e.keyCode === 123){\r\n//             e.returnValue=false\r\n//             return false\r\n//         }\r\n//     }\r\n// 禁止右键菜单以及选择文字\r\ndocument.addEventListener('contextmenu', function(e) {\r\n    e.preventDefault();\r\n});\r\ndocument.addEventListener('selectstart', function(e) {\r\n    e.preventDefault();\r\n});\r\n\r\n// -------- 右键 --------\r\n\r\ndocument.addEventListener('mouseup', function (ev) {\r\n    if (ev.button === 2) {\r\n        // 目前等功能同于 delete 键\r\n        const evt = new KeyboardEvent('keyup', { key: 'Delete', code: 'Delete' });\r\n        document.dispatchEvent(evt);\r\n        ev.preventDefault();\r\n    }\r\n});\r\n\r\n// -------- 滚轮 --------\r\n\r\ndocument.addEventListener('wheel', function (ev) {\r\n    const state = queryWidgetState();\r\n    if (!(AllHiddenIgnore(state, 'TextBox') && state.get('TextBox')))\r\n        return;\r\n    // 「正在游戏」状态\r\n    if (ev.deltaY > 0) {\r\n        core.nextSentenceProcessor();\r\n        ev.preventDefault();\r\n    }\r\n    else if (ev.deltaY < 0) {\r\n        WG_ViewControl.showBacklog();\r\n        ev.preventDefault();\r\n    }\r\n});\r\n\r\n// -------- 快捷键 --------\r\ndocument.addEventListener('keydown', function (ev) {\r\n    if (ev.isComposing || ev.defaultPrevented || ev.repeat)\r\n        return;\r\n\r\n    switch (ev.code) {\r\n        // begin ctrl skip\r\n        case 'ControlLeft':\r\n        case 'ControlRight':\r\n        {\r\n            const state = queryWidgetState();\r\n            // 「正在游戏」状态\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n});\r\ndocument.addEventListener('keyup', function (ev) {\r\n    if (ev.isComposing || ev.defaultPrevented)\r\n        return;\r\n\r\n    switch (ev.code) {\r\n        // end ctrl skip\r\n        case 'ControlLeft':\r\n        case 'ControlRight':\r\n        {\r\n            const state = queryWidgetState();\r\n            // 「正在游戏」状态\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // advance text / confirm\r\n        case 'Space':\r\n        case 'Enter':\r\n        case 'NumpadEnter':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                // 文本框显示\r\n                if (state.get('TextBox'))\r\n                    core.nextSentenceProcessor();\r\n                else {\r\n                    document.querySelector('div#bottomBox').style.display = 'flex';\r\n                    getRuntime().hideTextStatus = false;\r\n                }\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // auto mode\r\n        case 'KeyA':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.autoNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // skip mode\r\n        case 'KeyF':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                userInteract.fastNext();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // replay voice\r\n        case 'KeyV':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                WG_ViewControl.playVocal();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // save dialog\r\n        case 'KeyS':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'SaveScreen'])) {\r\n                if (state.get('SaveScreen'))\r\n                    userInteract.closeSave();\r\n                else\r\n                    userInteract.onSaveGame();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // load dialog\r\n        case 'KeyL':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'LoadScreen'])) {\r\n                if (state.get('LoadScreen'))\r\n                    userInteract.closeLoad();\r\n                else\r\n                    userInteract.onLoadGame();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // settings dialog\r\n        case 'KeyC':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'SettingScreen'])) {\r\n                if (state.get('SettingScreen'))\r\n                    userInteract.closeSettings();\r\n                else\r\n                    userInteract.onSetting();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // open backlog\r\n        case 'ArrowUp':\r\n        {\r\n            const state = queryWidgetState();\r\n            // 已经打开 backlog 后不再拦截上键\r\n            if (AllHiddenIgnore(state, 'TextBox')) {\r\n                WG_ViewControl.showBacklog();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // open title\r\n        case 'KeyT':\r\n        {\r\n            const state = queryWidgetState();\r\n            if (AllHiddenIgnore(state, ['TextBox', 'Title'])) {\r\n                if (state.get('Title'))\r\n                    userInteract.continueGame();\r\n                else\r\n                    userInteract.Title();\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // hide window\r\n        case 'Delete':\r\n        {\r\n            if (AllHiddenIgnore(queryWidgetState(['TitleScreen', 'PanicScreen']))) {\r\n                const state = queryWidgetState(['TextBox', 'SaveScreen', 'LoadScreen', 'SettingScreen', 'BacklogScreen']);\r\n                // 「正在游戏」状态\r\n                if (AllHiddenIgnore(state, 'TextBox')) {\r\n                    if (state.get('TextBox')) {\r\n                        document.querySelector('div#bottomBox').style.display = 'none';\r\n                        getRuntime().hideTextStatus = true;\r\n                    }\r\n                    else {\r\n                        document.querySelector('div#bottomBox').style.display = 'flex';\r\n                        getRuntime().hideTextStatus = false;\r\n                    }\r\n                }\r\n                // 有其他窗口\r\n                else {\r\n                    if (state.get('SaveScreen'))\r\n                        userInteract.closeSave();\r\n                    if (state.get('LoadScreen'))\r\n                        userInteract.closeLoad();\r\n                    if (state.get('SettingScreen'))\r\n                        userInteract.closeSettings();\r\n                    if (state.get('BacklogScreen'))\r\n                        userInteract.closeBacklog()\r\n                    // 紧急回避专用 ESC 键控制\r\n                }\r\n                ev.preventDefault();\r\n            }\r\n        }\r\n            break;\r\n\r\n        // panic button\r\n        case 'Escape':\r\n        {\r\n            if (queryWidgetState('PanicScreen'))\r\n                userInteract.hidePanic();\r\n            else\r\n                WG_ViewControl.showPanic('Yoozle');\r\n            ev.preventDefault();\r\n        }\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n});\r\n\r\nexport {userInteract};","// -------- 导入导出存档 --------\r\nimport React from \"react\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {\r\n    loadCookie,\r\n    Saves,\r\n    Settings,\r\n    writeCookie,\r\n    getRuntime,\r\n    GameInfo, SettingsMap\r\n} from \"../../Core/StoreControl/StoreControl\";\r\nimport {userInteract} from \"../../Core/InteractController/UserInteract\";\r\nimport {WG_ViewControl} from \"../../Core/ViewController/ViewControl\";\r\n\r\nfunction ren_miniPic(i){\r\n    let leftFigUrl = \"./game/figure/\"+Saves[i][\"fig_Name_left\"];\r\n    let FigUrl = \"./game/figure/\"+Saves[i][\"fig_Name\"];\r\n    let rightFigUrl = \"./game/figure/\"+Saves[i][\"fig_Name_right\"];\r\n    let renderList= [];\r\n    if(Saves[i][\"fig_Name_left\"]!=='none'&& Saves[i][\"fig_Name_left\"]!==''){\r\n        let tempIn= <span className={\"mini_fig mini_fig_left\"}>\r\n            <img src={leftFigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    if(Saves[i][\"fig_Name\"]!=='none'&& Saves[i][\"fig_Name\"]!==''){\r\n        let tempIn= <span className={\"mini_fig mini_fig_center\"}>\r\n            <img src={FigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    if(Saves[i][\"fig_Name_right\"]!=='none'&& Saves[i][\"fig_Name_right\"]!==''){\r\n        let tempIn= <span className={\"mini_fig mini_fig_right\"}>\r\n            <img src={rightFigUrl} alt={\"mini_fig\"} className={\"mini_fig_pic\"}/>\r\n        </span>\r\n        renderList.push(tempIn);\r\n    }\r\n    return <div id={\"ren_SE\" + i} className={\"miniPic\"}>\r\n        {renderList}\r\n    </div>;\r\n}\r\n\r\nclass SettingButtons_font extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {buttonState : ['','','']}\r\n    }\r\n\r\n    componentDidMount() {\r\n        let buttonStateNow = ['','',''];\r\n        let fontsize = Settings.font_size;\r\n        let index = Object.keys(SettingsMap.font_size).indexOf(fontsize);\r\n\r\n        buttonStateNow[index] = 'On';\r\n        this.setState(\r\n            {\r\n                buttonState:buttonStateNow\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    changeButtonState(i){\r\n        let key = Object.keys(SettingsMap.font_size)[i]\r\n        let value = SettingsMap.font_size[key]\r\n        let buttonStateNow = ['','',''];\r\n\r\n        document.getElementById('SceneText').style.fontSize = value;\r\n        document.getElementById('previewDiv').style.fontSize = value;\r\n        buttonStateNow[i] = 'On';\r\n\r\n        writeCookie();\r\n        this.setState(\r\n            {\r\n                buttonState:buttonStateNow\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n    render(){\r\n\r\n        return(\r\n            <div className=\"singleSettingItem\">\r\n                <span className=\"settingItemTitle\">字体大小</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[0]} onClick={()=>{this.changeButtonState(0)}}>小</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[1]} onClick={()=>{this.changeButtonState(1)}}>中</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[2]} onClick={()=>{this.changeButtonState(2)}}>大</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nclass SettingButtons_speed extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {buttonState : ['','','']}\r\n    }\r\n\r\n    componentDidMount() {\r\n        let buttonStateNow = ['','',''];\r\n        let playSpeed = Settings.play_speed;\r\n        let index = Object.keys(SettingsMap.play_speed).indexOf(playSpeed);\r\n\r\n        buttonStateNow[index] = 'On';\r\n        this.setState(\r\n            {\r\n                buttonState:buttonStateNow\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    changeButtonState(i){\r\n        let key = Object.keys(SettingsMap.play_speed)[i]\r\n        let value = SettingsMap.play_speed[key]\r\n        let buttonStateNow = ['','',''];\r\n\r\n        getRuntime().textShowWaitTime = value;\r\n        buttonStateNow[i] = 'On';\r\n        writeCookie();\r\n        this.setState(\r\n            {\r\n                buttonState:buttonStateNow\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n    render(){\r\n\r\n        return(\r\n            <div className=\"singleSettingItem\">\r\n                <span className=\"settingItemTitle\">播放速度</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[0]} onClick={()=>{this.changeButtonState(0)}}>慢</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[1]} onClick={()=>{this.changeButtonState(1)}}>中</span>\r\n                <span className={'settingItemButton'+this.state.buttonState[2]} onClick={()=>{this.changeButtonState(2)}}>快</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nclass LoadMainModel extends  React.Component{\r\n    Buttons = [];\r\n    SaveButtons = [];\r\n    LoadPageQty = 0;\r\n    setCurrentPage(page){\r\n        getRuntime().currentLoadPage = page;\r\n        this.setState({\r\n            currentPage:getRuntime().currentLoadPage\r\n        })\r\n        writeCookie();\r\n    }\r\n\r\n    loadButtons(){\r\n        this.Buttons = [];\r\n        for (let i = 0; i < this.LoadPageQty; i++) {\r\n            let temp =<span className=\"LoadIndexButton LS_indexButton\" onClick={()=>{this.setCurrentPage(i)}} key={i}>{i+1}</span>\r\n            if(i === getRuntime().currentLoadPage)\r\n                temp =<span className=\"LoadIndexButtonOn LS_indexButtonOn\" onClick={()=>{this.setCurrentPage(i)}} key={i}>{i+1}</span>\r\n            this.Buttons.push(temp);\r\n        }\r\n    }\r\n\r\n    loadSaveButtons(){\r\n        this.SaveButtons = [];\r\n        for (let i = getRuntime().currentLoadPage*6+1; i <= getRuntime().currentLoadPage*6+6; i++) {\r\n            if(Saves[i]){\r\n                let thisButtonName = Saves[i][\"showName\"];\r\n                let thisButtonText = Saves[i][\"showText\"];\r\n                let miniPic = ren_miniPic(i);\r\n                let backUrl = \"game/background/\"+Saves[i][\"bg_Name\"];\r\n                let temp = <div className=\"LoadSingleElement LS_singleElement\" key={i} onClick={()=>{userInteract.LoadSavedGame(i)}}>\r\n                    <div className={\"LS_Title\"}>\r\n                        <span className={\"LS_Title_index\"}>{i}</span>\r\n                        <span className={\"LS_Title_time\"}>{Saves[i].saveTime}</span>\r\n                    </div>\r\n                    <div className={\"LS_infoArea\"}>\r\n                        <div className={\"ren\"} key={i} style={{backgroundImage: `url(${backUrl})`}}>\r\n                            {miniPic}\r\n                        </div>\r\n                        <div className={\"LS_textArea\"}>\r\n                            <div className=\"LSE_top\">\r\n                                <span className={\"LSE_index\"}>{i}</span>\r\n                                <span className={\"LSE_name\"}>{thisButtonName}</span>\r\n                            </div>\r\n                            <div className=\"LSE_bottom\">\r\n                                {thisButtonText}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                this.SaveButtons.push(temp);\r\n            }else\r\n            {\r\n                let temp = <div className=\"LoadSingleElement LS_singleElement\" key={i}> </div>\r\n                this.SaveButtons.push(temp);\r\n                // console.log(i)\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.LoadPageQty = props.PageQty;\r\n        this.state = {\r\n            currentPage:getRuntime().currentLoadPage\r\n        }\r\n        this.loadButtons();\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    render(){\r\n        this.loadButtons();\r\n        this.loadSaveButtons();\r\n        return(\r\n            <div id=\"LoadMain\" className={\"LS_renderMain\"}>\r\n                <div id=\"LoadIndex\" className={\"LS_Index\"}>\r\n                    {this.Buttons}\r\n                </div>\r\n                <div id=\"LoadButtonList\" className={\"LS_ButtonList\"}>\r\n                    {this.SaveButtons}\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nclass SaveMainModel extends  React.Component{\r\n    Buttons = [];\r\n    SaveButtons = [];\r\n    LoadPageQty = 0;\r\n    ren_bg_list = [];\r\n    setCurrentPage(page){\r\n        getRuntime().currentSavePage = page;\r\n        this.setState({\r\n            currentPage:getRuntime().currentSavePage\r\n        })\r\n        writeCookie();\r\n    }\r\n\r\n    loadButtons(){\r\n        this.Buttons = [];\r\n        for (let i = 0; i < this.LoadPageQty; i++) {\r\n            let temp =<span className=\"SaveIndexButton LS_indexButton\" onClick={()=>{this.setCurrentPage(i)}} key={i}>{i+1}</span>\r\n            if(i === getRuntime().currentSavePage)\r\n                temp =<span className=\"SaveIndexButtonOn LS_indexButtonOn\" onClick={()=>{this.setCurrentPage(i)}} key={i}>{i+1}</span>\r\n            this.Buttons.push(temp);\r\n        }\r\n    }\r\n\r\n    loadSaveButtons(){\r\n        this.SaveButtons = [];\r\n        this.ren_bg_list = [];\r\n        for (let i = getRuntime().currentSavePage*6+1; i <= getRuntime().currentSavePage*6+6; i++) {\r\n            if(Saves[i]){\r\n                let thisButtonName = Saves[i][\"showName\"];\r\n                let thisButtonText = Saves[i][\"showText\"];\r\n                let miniPic = ren_miniPic(i);\r\n                let backUrl = \"game/background/\"+Saves[i][\"bg_Name\"];\r\n                let temp = <div className=\"SaveSingleElement LS_singleElement\" key={i} onClick={()=>{this.save_onSaved(i)}}>\r\n                    <div className={\"LS_Title\"}>\r\n                        <span className={\"LS_Title_index S_Title_index\"}>{i}</span>\r\n                        <span className={\"LS_Title_time S_Title_time\"}>{Saves[i].saveTime}</span>\r\n                    </div>\r\n                    <div className={\"LS_infoArea\"}>\r\n                        <div className={\"ren\"} key={i} style={{backgroundImage: `url(${backUrl})`}}>\r\n                            {miniPic}\r\n                        </div>\r\n                        <div className={\"LS_textArea\"}>\r\n                            <div className=\"LSE_top\">\r\n                                <span className={\"LSE_index\"}>{i}</span>\r\n                                <span className={\"LSE_name\"}>{thisButtonName}</span>\r\n                            </div>\r\n                            <div className=\"LSE_bottom\">\r\n                                {thisButtonText}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                this.SaveButtons.push(temp);\r\n            }else\r\n            {\r\n                let temp = <div className=\"SaveSingleElement LS_singleElement\" key={i} onClick={()=>{this.save_NonSaved(i)}}> </div>\r\n                this.SaveButtons.push(temp);\r\n                // console.log(i)\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    save_NonSaved(index){\r\n        userInteract.saveGame(index);\r\n        writeCookie();\r\n        this.setState({\r\n            currentPage:getRuntime().currentSavePage\r\n        });\r\n    }\r\n\r\n    save_onSaved(index){\r\n        WG_ViewControl.showMesModel('你要覆盖这个存档吗','覆盖','不',function () {\r\n            userInteract.saveGame(index);\r\n            writeCookie();\r\n            userInteract.closeSave();\r\n        })\r\n        this.setState({\r\n            currentPage:getRuntime().currentSavePage\r\n        });\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.LoadPageQty = props.PageQty;\r\n        this.state = {\r\n            currentPage:getRuntime().currentSavePage\r\n        }\r\n        this.loadButtons();\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n    }\r\n\r\n    render(){\r\n        this.loadButtons();\r\n        this.loadSaveButtons();\r\n        return(\r\n            <div id=\"SaveMain\" className={\"LS_renderMain\"}>\r\n                <div id=\"SaveIndex\" className={\"LS_Index\"}>\r\n                    {this.Buttons}\r\n                </div>\r\n                <div id=\"SaveButtonList\" className={\"LS_ButtonList\"}>\r\n                    {this.SaveButtons}\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nfunction ControlButton(props){\r\n    if(props.id){\r\n        return <div className={\"newButton\"} id={props.id} onClick={()=>{\r\n            props.fun();\r\n        }}>\r\n            <span className={\"nB_left\"} style={{borderBottom:`3px solid ${props.color}`}}>{props.simpleName}</span>\r\n            <span className={\"nB_right\"}>{props.name}</span>\r\n        </div>\r\n    }\r\n\r\n    return <div className={\"newButton\"} onClick={()=>{\r\n        props.fun();\r\n    }}>\r\n        <span className={\"nB_left\"} style={{borderBottom:`3px solid ${props.color}`}}>{props.simpleName}</span>\r\n        <span className={\"nB_right\"}>{props.name}</span>\r\n    </div>\r\n}\r\n\r\n// -------- 导入导出存档 --------\r\nclass ImporterExporter extends React.Component {\r\n    constructor() {\r\n        super();\r\n        this.dummyA = null;\r\n        this.dummyInput = null;\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        this.dummyA = document.querySelector('a#dummy-saves-exporter');\r\n        this.dummyInput = document.querySelector('input#dummy-saves-importer');\r\n    }\r\n\r\n\r\n    importSaves(ev) {\r\n        const file = ev.target.files[0];\r\n        const reader = new FileReader();\r\n        reader.onload = (evR) => {\r\n            const saves = evR.target.result;\r\n            localStorage.setItem(GameInfo['Game_key'], saves);\r\n            loadCookie();\r\n            window.location.reload();  // dirty: 强制刷新 UI\r\n        };\r\n        reader.readAsText(file, 'UTF-8');\r\n    }\r\n\r\n\r\n    exportSaves() {\r\n        const saves = localStorage.getItem(GameInfo['Game_key']);\r\n        if (saves === null) {\r\n            // no saves\r\n            return false;\r\n        }\r\n        const blob = new Blob([saves], { type: 'application/json' });\r\n        const blobUrl = URL.createObjectURL(blob);\r\n        URL.revokeObjectURL(this.dummyA.href);\r\n        this.dummyA.href = blobUrl;\r\n        this.dummyA.download = 'saves.json';\r\n        this.dummyA.click();\r\n        return true;\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"importer-exporter\">\r\n                <span className=\"label-saves-exporter\" onClick={() => { this.exportSaves(); }}>导出存档</span>\r\n                <a target=\"_blank\" id=\"dummy-saves-exporter\" style={{display: \"none\"}}/>\r\n                <span className=\"label-saves-importer\" onClick={() => { this.dummyInput.click(); }}>导入存档</span>\r\n                <input type=\"file\" id=\"dummy-saves-importer\" style={{display: \"none\"}} onChange={this.importSaves}/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n\r\n    checkSyntax(text) {\r\n        try {\r\n            const json = JSON.parse(text);\r\n        } catch (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\nexport {ren_miniPic,SettingButtons_font,SettingButtons_speed,LoadMainModel,SaveMainModel,ControlButton,ImporterExporter}","/**\r\n * 集中管理的音频播放控制器，可自由添加音轨，通过 key 来对指定音轨进行操作\r\n *\r\n */\r\nexport default (function () {\r\n    const createAudioContext = window.AudioContext || window[\"webkitAudioContext\"] || window[\"mozAudioContext\"] || window[\"msAudioContext\"];\r\n\r\n    /**\r\n     * @type {AudioContext | null}\r\n     */\r\n    let audioContext = null\r\n\r\n    /**\r\n     * 播放音频的一个源 （由AudioContext创建，可以创建多个用来做多轨播放）\r\n     * @type {{VOCAL: {}, MAIN_BGM: {}, SCENE_BGM: {}}}\r\n     */\r\n    let sources = {\r\n        MAIN_BGM: {\r\n            source: null,\r\n            loop: true,\r\n            status: 0,\r\n            arrayBuffer: null,\r\n            audioBuffer: null\r\n        },\r\n        SCENE_BGM: {\r\n            source: null,\r\n            loop: true,\r\n            status: 0,\r\n            arrayBuffer: null,\r\n            audioBuffer: null\r\n        },\r\n        VOCAL: {\r\n            source: null,\r\n            loop: false,\r\n            status: 0,\r\n            arrayBuffer: null,\r\n            audioBuffer: null\r\n        }\r\n    };\r\n    let sourcesMap = {\r\n        MAIN_BGM: \"MAIN_BGM\",\r\n        SCENE_BGM: \"SCENE_BGM\",\r\n        VOCAL: \"VOCAL\"\r\n    };\r\n\r\n    const STOP = -1;\r\n    const READY = 0;\r\n    const PLAYING = 1;\r\n\r\n    /**\r\n     *\r\n     * 判断指定 source 是否已经播放完毕\r\n     * @param targetSourceKey {String} 指定需要检查状态的音轨名\r\n     */\r\n    const isSourceEnded = (targetSourceKey) => {\r\n        if (!checkSourcesExist(targetSourceKey)) return null;\r\n\r\n        return sources[targetSourceKey].status === STOP\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param targetSourceKey {String} 指定需要检查是否存在的音轨名\r\n     */\r\n    const checkSourcesExist = (targetSourceKey) => {\r\n        let result = sources.hasOwnProperty(targetSourceKey);\r\n        if (!result) console.error(`[AudioContext] ${targetSourceKey} in sources is not exist.`);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 初始化 AudioContext （应该在用户第一次与网页交互[onclick,onkeydown...]以后进行）\r\n     */\r\n    const initAudioContext = () => {\r\n        if (audioContext != null) return\r\n\r\n        audioContext = new createAudioContext();\r\n        for (let key in sources) {\r\n            let status = sources[key].status\r\n\r\n            if (status === READY) initSound(key)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 开始播放\r\n     * @param targetSourceKey {String}\r\n     */\r\n    const start = (targetSourceKey) => {\r\n        if (!checkSourcesExist(targetSourceKey)) return;\r\n\r\n        if (audioContext == null) {\r\n            console.error(\"[AudioContext] has not been initialized.\");\r\n            return;\r\n        }\r\n\r\n        sources[targetSourceKey].status = PLAYING;\r\n        sources[targetSourceKey].source = audioContext.createBufferSource();\r\n        let source = sources[targetSourceKey].source\r\n        source.buffer = sources[targetSourceKey].audioBuffer;\r\n        source.loop = sources[targetSourceKey].loop;\r\n        source.onended = () => sources[targetSourceKey].status = STOP\r\n        source.connect(audioContext.destination);\r\n        source.start(0);\r\n    }\r\n\r\n    /**\r\n     * 停止播放\r\n     * @param targetSourceKey {String}\r\n     */\r\n    const stop = (targetSourceKey) => {\r\n        if (!checkSourcesExist(targetSourceKey)) return;\r\n\r\n        sources[targetSourceKey].status = STOP;\r\n        let source = sources[targetSourceKey].source\r\n        if (source) {\r\n            source.stop(0);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 解码 ArrayBuffer 为 AudioBuffer 供后续 start() 方法使用\r\n     * @param targetSourceKey {String} 指定需要在那条音轨上播放\r\n     */\r\n    const initSound = (targetSourceKey) => {\r\n        if (!checkSourcesExist(targetSourceKey)) return;\r\n\r\n        if (audioContext == null) {\r\n            sources[targetSourceKey].status = READY\r\n            console.warn(`[AudioContext] has not been initialized, stored the ${targetSourceKey} task.`);\r\n            return\r\n        }\r\n\r\n        let arrayBuffer = sources[targetSourceKey].arrayBuffer\r\n        if (arrayBuffer == null) {\r\n            console.warn(`[AudioContext] ${targetSourceKey} arrayBuffer is null now.`)\r\n            return\r\n        }\r\n\r\n        audioContext.decodeAudioData(arrayBuffer, (buffer) => { //解码成功时的回调函数\r\n            sources[targetSourceKey].audioBuffer = buffer;\r\n            start(targetSourceKey);\r\n        }, e => console.error(\"[AudioContext] decoding file failed.\", e));\r\n    }\r\n\r\n    /**\r\n     * 加载指定 url 音频文件的 ArrayBuffer\r\n     * @param targetSourceKey {String} 指定需要在那条音轨上播放\r\n     * @param url {String} 所需加载的文件地址\r\n     * @param autoplay {Boolean?} 是否需要加载完成后自动播放\r\n     */\r\n    function loadAudioFile(targetSourceKey, url, autoplay) {\r\n        console.log(targetSourceKey, url)\r\n        if (!checkSourcesExist(targetSourceKey)) return;\r\n\r\n        stop(targetSourceKey);\r\n        if (url == null) return;\r\n\r\n        fetch(url)\r\n            .then(data => data.arrayBuffer())\r\n            .then(buffer => {\r\n                if (buffer.byteLength > 5000) {\r\n                    sources[targetSourceKey].arrayBuffer = buffer;\r\n                    if (autoplay) initSound(targetSourceKey);\r\n                }\r\n            }).catch(error => console.error(\"[AudioContext] loadAudioFile fetch failed.\", error));\r\n    }\r\n\r\n    document.addEventListener(\"click\", initAudioContext)\r\n    return {start, stop, loadAudioFile, initSound, isSourceEnded, ...sourcesMap}\r\n})()","import ReactDOM from \"react-dom\";\r\nimport {clearCookie, getRuntime, getStatus, SyncCurrentStatus} from \"../StoreControl/StoreControl\";\r\n\r\nimport {userInteract} from \"../InteractController/UserInteract\";\r\nimport {\r\n    ControlButton,\r\n    ImporterExporter,\r\n    LoadMainModel,\r\n    SaveMainModel,\r\n    SettingButtons_font,\r\n    SettingButtons_speed\r\n} from \"../../Components/UI/etc\";\r\nimport {nextSentenceProcessor} from \"../WG_core\";\r\nimport React from \"react\";\r\nimport {Return, VolumeNotice} from \"@icon-park/react\";\r\nimport '@icon-park/react/styles/index.css';\r\nimport AudioController from \"../util/AudioController.js\";\r\n\r\nclass WG_ViewControl {\r\n    static VC_changeBG(bg_name){\r\n        //把背景复制一份成为旧背景，方便做渐变动画\r\n        let BG = document.getElementById('mainBackground');\r\n        let oldBG = BG.cloneNode(true);\r\n        //如果有旧背景节点，删除之\r\n        if(document.getElementById('oldBG')){\r\n            document.getElementById('oldBG').parentNode.removeChild(\r\n                document.getElementById('oldBG')\r\n            )\r\n        }\r\n        oldBG.setAttribute('id','oldBG');\r\n        oldBG.style.webkitAnimation = 'hideBG 5s';\r\n        oldBG.style.animationFillMode = 'forwards';\r\n        console.log(oldBG);\r\n        BG.parentNode.appendChild(oldBG);\r\n        BG.style.backgroundImage = \"url('game/background/\" + bg_name + \"')\";\r\n        let newBG=BG.cloneNode(true);\r\n        let parentNodeBG = BG.parentNode;\r\n        parentNodeBG.removeChild(BG);\r\n        parentNodeBG.appendChild(newBG);\r\n    }\r\n\r\n    static VC_changeP(P_name,pos) {\r\n        if(pos ==='center'){\r\n            if (P_name === 'none'){\r\n                ReactDOM.render(<div/>,document.getElementById('figureImage'));\r\n                getRuntime().currentInfo[\"fig_Name\"] = 'none';\r\n            }else{\r\n                let pUrl = \"game/figure/\"+P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP,document.getElementById('figureImage'));\r\n                getRuntime().currentInfo[\"fig_Name\"] = P_name;\r\n            }\r\n        }else if(pos === 'left'){\r\n            if (P_name === 'none'){\r\n                ReactDOM.render(<div/>,document.getElementById('figureImage_left'));\r\n                getRuntime().currentInfo[\"fig_Name_left\"] = 'none';\r\n            }else{\r\n                let pUrl = \"game/figure/\"+P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP,document.getElementById('figureImage_left'));\r\n                getRuntime().currentInfo[\"fig_Name_left\"] = P_name;\r\n            }\r\n        }else if(pos === 'right'){\r\n            if (P_name === 'none'){\r\n                ReactDOM.render(<div/>,document.getElementById('figureImage_right'));\r\n                getRuntime().currentInfo[\"fig_Name_right\"] = 'none';\r\n            }else{\r\n                let pUrl = \"game/figure/\"+P_name;\r\n                let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n                // console.log('now changing person');\r\n                ReactDOM.render(changedP,document.getElementById('figureImage_right'));\r\n                getRuntime().currentInfo[\"fig_Name_right\"] = P_name;\r\n            }\r\n        }\r\n    }\r\n\r\n    static VC_choose(selection,mode){\r\n        if(mode === 'scene'){\r\n            document.getElementById('chooseBox').style.display = 'flex';\r\n            let elements = []\r\n            for (let i = 0; i < selection.length; i++) {\r\n                let temp = <div className='singleChoose' key={i} onClick={()=>{userInteract.chooseScene(selection[i][1]);}}>{selection[i][0]}</div>\r\n                elements.push(temp)\r\n            }\r\n            ReactDOM.render(<div>{elements}</div>,document.getElementById('chooseBox'))\r\n        }\r\n        if(mode === 'label'){\r\n            document.getElementById('chooseBox').style.display = 'flex';\r\n            let elements = []\r\n            for (let i = 0; i < selection.length; i++) {\r\n                let temp = <div className='singleChoose' key={i} onClick={()=>{userInteract.chooseJumpFun(selection[i][1]);}}>{selection[i][0]}</div>\r\n                elements.push(temp)\r\n            }\r\n            ReactDOM.render(<div>{elements}</div>,document.getElementById('chooseBox'))\r\n        }\r\n    }\r\n\r\n    static VC_closeChoose(){\r\n        document.getElementById('chooseBox').style.display = 'none';\r\n    }\r\n\r\n    static VC_textShow(name,text){\r\n        let changedName = <span>{name}</span>\r\n        let textArray = text.split(\"\");\r\n        ReactDOM.render(changedName, document.getElementById('pName'));\r\n        WG_ViewControl.showTextArray(textArray);\r\n    }\r\n\r\n    static VC_restoreStatus(savedStatus) {\r\n        console.log(\"restoring\")\r\n        console.log(savedStatus)\r\n        let command = savedStatus[\"command\"];\r\n        if(savedStatus[\"bg_Name\"]!=='')\r\n            document.getElementById('mainBackground').style.backgroundImage = \"url('game/background/\" + savedStatus[\"bg_Name\"] + \"')\";\r\n        if (savedStatus[\"fig_Name\"] === ''||savedStatus[\"fig_Name\"] === 'none'){\r\n            ReactDOM.render(<div/>,document.getElementById('figureImage'));\r\n        }else{\r\n            let pUrl = \"game/figure/\"+savedStatus[\"fig_Name\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP,document.getElementById('figureImage'));\r\n        }\r\n        if (savedStatus[\"fig_Name_left\"] === ''||savedStatus[\"fig_Name_left\"] === 'none'){\r\n            ReactDOM.render(<div/>,document.getElementById('figureImage_left'));\r\n        }else{\r\n            let pUrl = \"game/figure/\"+savedStatus[\"fig_Name_left\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP,document.getElementById('figureImage_left'));\r\n        }\r\n        if (savedStatus[\"fig_Name_right\"] === ''||savedStatus[\"fig_Name_right\"] === 'none'){\r\n            ReactDOM.render(<div/>,document.getElementById('figureImage_right'));\r\n        }else{\r\n            let pUrl = \"game/figure/\"+savedStatus[\"fig_Name_right\"];\r\n            let changedP = <img src={pUrl} alt='figure' className='p_center'/>\r\n            // console.log('now changing person');\r\n            ReactDOM.render(changedP,document.getElementById('figureImage_right'));\r\n        }\r\n        if(command === 'choose'||command === 'choose_label'){\r\n            let chooseItems =savedStatus[\"choose\"];\r\n            chooseItems = chooseItems.split(\"}\")[0];\r\n            chooseItems = chooseItems.split(\"{\")[1];\r\n            let selection = chooseItems.split(',')\r\n            for (let i = 0;i<selection.length;i++){\r\n                selection[i] = selection[i].split(\":\");\r\n            }\r\n            let choose_mode = '';\r\n            // eslint-disable-next-line default-case\r\n            switch (command){\r\n                case 'choose':\r\n                    choose_mode = 'scene';\r\n                    break;\r\n                case 'choose_label':\r\n                    choose_mode = 'label';\r\n                    break;\r\n            }\r\n            WG_ViewControl.VC_choose(selection,choose_mode);\r\n        }\r\n        let changedName = <span>{savedStatus[\"showName\"]}</span>\r\n        let textArray = savedStatus[\"showText\"].split(\"\");\r\n        ReactDOM.render(changedName, document.getElementById('pName'));\r\n        SyncCurrentStatus('vocal',savedStatus['vocal']);\r\n        if(getStatus('bgm') !== savedStatus['bgm']){\r\n            getRuntime().currentInfo['bgm'] = savedStatus['bgm'];\r\n            WG_ViewControl.loadBGM();\r\n        }\r\n        if(savedStatus['miniAvatar']!=='' || savedStatus['miniAvatar'] !== 'none'){\r\n            WG_ViewControl.VC_showMiniAvatar(savedStatus['miniAvatar']);\r\n        }\r\n        WG_ViewControl.playVocal();\r\n        WG_ViewControl.showTextArray(textArray);\r\n    }\r\n\r\n    static VC_showSettings(){\r\n        let settingInterface = <div>\r\n            <div className={\"settingsItemsList\"}>\r\n                {/* eslint-disable-next-line react/jsx-pascal-case */}\r\n                <SettingButtons_font/>\r\n                {/* eslint-disable-next-line react/jsx-pascal-case */}\r\n                <SettingButtons_speed/>\r\n                <div className={\"deleteCookie\"} onClick={()=>{WG_ViewControl.showMesModel('你确定要清除缓存吗','要','不要',clearCookie)}}>清除所有设置选项以及存档</div>\r\n                <ImporterExporter />\r\n                <div>本作品由 WebGAL 强力驱动，<a href={\"https://github.com/MakinoharaShoko/WebGAL\"}>了解 WebGAL</a>。</div>\r\n                <br/>\r\n                <div className='settingItemTitle'>效果预览</div>\r\n            </div>\r\n        </div>\r\n        document.getElementById(\"settings\").style.display = \"flex\";\r\n        document.getElementById(\"bottomBox\").style.display = \"none\";\r\n        ReactDOM.render(settingInterface,document.getElementById(\"settingItems\"));\r\n        ReactDOM.render(<div id=\"previewDiv\" />,document.getElementById('textPreview'));\r\n        WG_ViewControl.showTextPreview('现在预览的是文本框字体大小和播放速度的情况，您可以根据您的观感调整上面的选项。');\r\n    }\r\n\r\n    static VC_showSave_Load(mode){\r\n        if(mode === 'save'){\r\n            ReactDOM.render(<SaveMainModel PageQty={15}/>,document.getElementById('SaveItems'))\r\n        }else {\r\n            ReactDOM.render(<LoadMainModel PageQty={15}/>,document.getElementById('LoadItems'))\r\n        }\r\n    }\r\n\r\n    static VC_resetStage(){\r\n        // document.getElementById('mainBackground').style.backgroundImage = 'none';\r\n        ReactDOM.render(<div/>,document.getElementById('figureImage'));\r\n        ReactDOM.render(<div/>,document.getElementById('figureImage_left'));\r\n        ReactDOM.render(<div/>,document.getElementById('figureImage_right'));\r\n    }\r\n\r\n    static loadBGM() {\r\n        let bgmName = getRuntime().currentInfo[\"bgm\"];\r\n\r\n        let bgmPath = bgmName === '' || bgmName === 'none' ? null : `./game/bgm/${bgmName}`\r\n\r\n        AudioController.loadAudioFile(AudioController.MAIN_BGM, bgmPath, true);\r\n    }\r\n\r\n    static playVocal() {\r\n        let runtimeTemp = getStatus(\"all\")\r\n        let vocalName = runtimeTemp.vocal;\r\n        let vocalPath = vocalName === '' ? null : `./game/vocal/${vocalName}`\r\n\r\n        AudioController.loadAudioFile(AudioController.VOCAL, vocalPath, true);\r\n    }\r\n\r\n    static showIntro(text){\r\n        let i = 0;\r\n        let IntroView =\r\n            <div>\r\n                <div id={\"textShowArea\"} className={\"textShowArea_styl\"}>\r\n                </div>\r\n            </div>\r\n        ;\r\n        ReactDOM.render(IntroView,document.getElementById(\"intro\"));\r\n        ReactDOM.render(<div>{\" \"}</div>,document.getElementById(\"textShowArea\"));\r\n        document.getElementById(\"intro\").style.display = 'block';\r\n        let textArray = text.split(',');\r\n        let introInterval = setInterval(textShow,1500);\r\n        let introAll = [];\r\n        function textShow(){\r\n            let singleRow = <div className={\"introSingleRow\"} key={i}>{textArray[i]}</div>;\r\n            introAll.push(singleRow);\r\n            i = i+1;\r\n            ReactDOM.render(<div>{introAll}</div>,document.getElementById(\"textShowArea\"));\r\n            if(i>= textArray.length){\r\n                clearInterval(introInterval);\r\n                setTimeout(userInteract.clearIntro,3500);\r\n            }\r\n        }\r\n    }\r\n\r\n    static loadButton(){\r\n        let renNewButton =  <div className={\"toCenter\"}>\r\n            <ControlButton color = '#FEDFE1' fun={this.playVocal} name={\"重复\"} simpleName={\"V\"}/>\r\n            <ControlButton color = '#FB966E' fun={userInteract.autoNext} name={\"自动\"} simpleName={\"A\"} id={\"autoButton\"}/>\r\n            <ControlButton color = '#FBE251' fun={userInteract.fastNext} name={\"快进\"} simpleName={\"F\"}   id={\"fastButton\"}/>\r\n            <ControlButton color = '#A5DEE4' fun={userInteract.onSaveGame} name={\"存档\"} simpleName={\"S\"}/>\r\n            <ControlButton color = '#58B2DC' fun={userInteract.onLoadGame} name={\"读档\"} simpleName={\"L\"}/>\r\n            <ControlButton color = '#B28FCE' fun={userInteract.onSetting} name={\"设置\"} simpleName={\"C\"}/>\r\n            <ControlButton color = '#BDC0BA' fun={userInteract.Title} name={\"标题\"} simpleName={\"T\"}/>\r\n            {/*<ControlButton color = '#FEDFE1' fun={playVocal} name={\"重复\"} simpleName={\"V\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={autoNext} name={\"自动\"} simpleName={\"A\"} id={\"autoButton\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={fastNext} name={\"快进\"} simpleName={\"F\"}   id={\"fastButton\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onSaveGame} name={\"存档\"} simpleName={\"S\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onLoadGame} name={\"读档\"} simpleName={\"L\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={onSetting} name={\"设置\"} simpleName={\"C\"}/>*/}\r\n            {/*<ControlButton color = '#FEDFE1' fun={Title} name={\"标题\"} simpleName={\"T\"}/>*/}\r\n        </div>\r\n        ReactDOM.render(renNewButton,document.getElementById(\"controlBar\"));\r\n    }\r\n\r\n    static showBacklog(){\r\n        document.getElementById('backlog').style.display = 'block';\r\n        document.getElementById('bottomBox').style.display = 'none';\r\n        let showBacklogList = [];\r\n        for (let i = 0 ; i<getRuntime().CurrentBacklog.length ; i++){\r\n            let temp = <div className={'backlog_singleElement'} key={i}>\r\n                <div className={\"backlog_interact\"}>\r\n                    <div className={\"backlog_interact_button\"} onClick={()=> {\r\n                        let vocalName = getRuntime().CurrentBacklog[i].vocal;\r\n                        let vocalPath = vocalName === '' ? null : `./game/vocal/${vocalName}`\r\n\r\n                        AudioController.loadAudioFile(AudioController.VOCAL, vocalPath, true);\r\n                    }}>\r\n                        <VolumeNotice theme=\"outline\" size=\"24\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className={\"backlog_interact_button\"} onClick={()=>{\r\n                        userInteract.jumpFromBacklog(i);\r\n                    }}>\r\n                        <Return theme=\"outline\" size=\"24\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                </div>\r\n                <div className={\"backlog_name\"}>{getRuntime().CurrentBacklog[i].showName}</div>\r\n\r\n                <div className={\"backlog_content\"}>\r\n\r\n                    <div className={\"backlog_text\"}>{getRuntime().CurrentBacklog[i].showText}</div>\r\n                </div>\r\n                <div id={\"backlogVocal-\"+i}>\r\n\r\n                </div>\r\n            </div>\r\n            showBacklogList.push(temp)\r\n        }\r\n        ReactDOM.render(<div>{showBacklogList}</div>,document.getElementById('backlogContent'));\r\n    }\r\n\r\n// 渐显文字\r\n    static showTextArray(textArray){\r\n        getRuntime().showingText = false;\r\n        ReactDOM.render(<span> </span>, document.getElementById('SceneText'));\r\n        let elementArray = [];\r\n        let i = 0;\r\n        clearInterval(interval);\r\n        var interval = setInterval(showSingle,getRuntime().textShowWaitTime);\r\n        getRuntime().showingText = true;\r\n        function showSingle() {\r\n            if(!getRuntime().showingText){\r\n                let textFull = '';\r\n                for (let j = 0;j<textArray.length;j++){\r\n                    textFull = textFull+textArray[j];\r\n                }\r\n                ReactDOM.render(<div>{textFull}</div>, document.getElementById('SceneText'));\r\n                if(getRuntime().auto === 1){\r\n                    if(i < textArray.length + 1){\r\n                        i = textArray.length + 1;\r\n                    }else{\r\n                        i = i+1;\r\n                    }\r\n                }else{\r\n                    i = textArray.length + 1 +(getRuntime().autoWaitTime/35);\r\n                }\r\n\r\n            }else{\r\n                let tempElement = <span key={i} className='singleWord'>{textArray[i]}</span>\r\n                elementArray.push(tempElement);\r\n                ReactDOM.render(<div>{elementArray}</div>, document.getElementById('SceneText'));\r\n                i = i+1;\r\n            }\r\n            if(i > textArray.length && getRuntime().auto !== 1){\r\n                getRuntime().showingText = false;\r\n            }\r\n            if (i > textArray.length + (getRuntime().autoWaitTime / 35)) {\r\n                if (getRuntime().auto === 1) {\r\n                    // if(document.getElementById('currentVocal') && getRuntime().fast === 0){\r\n                    //     if(document.getElementById('currentVocal').ended)\r\n                    if (getRuntime().fast === 0) {\r\n                        if (AudioController.isSourceEnded(AudioController.VOCAL)) {\r\n                            clearInterval(interval);\r\n                            getRuntime().showingText = false;\r\n                            nextSentenceProcessor();\r\n                        }\r\n                    }else{\r\n                        clearInterval(interval);\r\n                        getRuntime().showingText = false;\r\n                        nextSentenceProcessor();\r\n                    }\r\n                }else{\r\n                    getRuntime().showingText = false;\r\n                    clearInterval(interval);\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    static showTextPreview(text){\r\n        getRuntime().onTextPreview = getRuntime().onTextPreview+1;\r\n        let textArray = text.split(\"\");\r\n        // if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '150%';\r\n        // }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '200%';\r\n        // }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n        //     document.getElementById('previewDiv').style.fontSize = '250%';\r\n        // }\r\n        ReactDOM.render(<span> </span>, document.getElementById('previewDiv'));\r\n        let elementArray = [];\r\n        let i = 0;\r\n        clearInterval(interval2);\r\n        var interval2 = setInterval(showSingle,getRuntime().textShowWaitTime);\r\n        function showSingle() {\r\n            if(getRuntime().onTextPreview>1){\r\n                getRuntime().onTextPreview = getRuntime().onTextPreview-1;\r\n                clearInterval(interval2);\r\n                return;\r\n            }\r\n            let tempElement = <span key={i} className='singleWord'>{textArray[i]}</span>\r\n            elementArray.push(tempElement);\r\n            ReactDOM.render(<div>{elementArray}</div>, document.getElementById('previewDiv'));\r\n            i = i+1;\r\n            if(i > textArray.length +(1000/35)){\r\n                clearInterval(interval2);\r\n                interval2 = setInterval(showSingle,getRuntime().textShowWaitTime);\r\n                i = 0;\r\n                elementArray = [];\r\n                // if(getRuntime().Settings[\"font_size\"] === 'small'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '150%';\r\n                // }else if(getRuntime().Settings[\"font_size\"] === 'medium'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '200%';\r\n                // }else if(getRuntime().Settings[\"font_size\"] === 'large'){\r\n                //     document.getElementById('previewDiv').style.fontSize = '250%';\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    static showMesModel(Title,Left,Right,func) {\r\n        document.getElementById('MesModel').style.display='block';\r\n        let element =\r\n            <div className={'MesMainWindow'}>\r\n                <div className={\"MesTitle\"}>{Title}</div>\r\n                <div className={'MesChooseContainer'}>\r\n                    <div className={'MesChoose'} onClick={()=>{func();document.getElementById('MesModel').style.display='none';}}>{Left}</div>\r\n                    <div className={'MesChoose'} onClick={()=>{document.getElementById('MesModel').style.display='none';}}>{Right}</div>\r\n                </div>\r\n            </div>\r\n        ReactDOM.render(element,document.getElementById('MesModel'))\r\n    }\r\n\r\n    static VC_showMiniAvatar(name){\r\n        if(name === '' || name === 'none'){\r\n            ReactDOM.render(<div/>,document.getElementById(\"miniAvatar\"))\r\n            return;\r\n        }\r\n        let url = \"game/figure/\"+name;\r\n        let pic = <img src={url} className={\"miniAvatar_pic\"} alt={\"miniAvatar\"}/>\r\n        ReactDOM.render(pic,document.getElementById(\"miniAvatar\"));\r\n    }\r\n\r\n    static VC_setAnimationByClass(name,animate,time){\r\n        console.log('setting animate by class on: '+name+'set to '+animate);\r\n        let aniString = '-webkit-animation: '+animate+' '+time;\r\n        let editList = document.getElementsByClassName(name);\r\n        for (let i = 0; i < editList.length; i++) {\r\n            editList[i].setAttribute('style',aniString)\r\n        }\r\n    }\r\n\r\n    static VC_setAnimationById(id,animate,time){\r\n        let aniString = animate+' '+time;\r\n        document.getElementById(id).style.webkitAnimation = aniString;\r\n    }\r\n\r\n// -------- 紧急回避 --------\r\n\r\n    static showPanic(showType) {\r\n        document.querySelector('div#panic-overlay').style.display = 'block';\r\n        if (showType === 'Yoozle') {\r\n            let ele =\r\n                <div className=\"yoozle-container\">\r\n                    <div className=\"yoozle-title\">\r\n                    <span>\r\n                        <span className=\"yoozle-gl-blue\">Y</span><span className=\"yoozle-gl-red\">o</span><span\r\n                        className=\"yoozle-gl-yellow\">o</span><span className=\"yoozle-gl-blue\">z</span><span\r\n                        className=\"yoozle-gl-green\">l</span><span className=\"yoozle-gl-red yoozle-e-rotate\">e</span>\r\n                    </span>\r\n                    </div>\r\n                    <div className=\"yoozle-search\">\r\n                        <input className=\"yoozle-search-bar\" type=\"text\" defaultValue=\"\" />\r\n                        <div className=\"yoozle-search-buttons\">\r\n                            <input className=\"yoozle-btn\" type=\"submit\" value=\"Yoozle Search\" />\r\n                            <input className=\"yoozle-btn\" type=\"submit\" value=\"I'm Feeling Lucky\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            ReactDOM.render(ele, document.querySelector('div#panic-overlay'));\r\n            document.querySelector('input.yoozle-search-bar').value = '';\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nexport {WG_ViewControl}\r\n","import {\r\n    getRuntime,\r\n    getScene,\r\n    getStatus,\r\n    SyncCurrentStatus\r\n} from \"./StoreControl/StoreControl\"\r\nimport {WG_ViewControl} from \"./ViewController/ViewControl\";\r\nimport {processSentence} from \"./util/WG_util\";\r\n\r\n// 读取下一条脚本\r\nfunction nextSentenceProcessor() {\r\n\r\n    if(getRuntime().showingText){\r\n        getRuntime().showingText = false;\r\n        return;\r\n    }//检测目前是否正在进行文字渐显，如果渐显，则终止渐显，直接读完文本\r\n    let saveBacklogNow = false;//该变量决定此条语句是否需要加入到backlog\r\n    if(getStatus('SentenceID') >= getRuntime().currentScene.length){\r\n        return;\r\n    }//如果超过场景文本行数，停止处理语句。\r\n    let thisSentence = getRuntime().currentScene[getStatus('SentenceID')];//此条语句的内容\r\n    let command = thisSentence[0];//此条语句的控制文本（也可能是省略人物对话的语句）\r\n    let S_content = thisSentence[1];\r\n    console.log(\"------now running NSP------\"+thisSentence);\r\n    if (command === 'changeBG') {\r\n        WG_ViewControl.VC_changeBG(S_content);//界面控制：换背景\r\n        SyncCurrentStatus(\"bg_Name\",S_content);//同步当前状态\r\n        autoPlay('on');//在非next语句下调用autoplay\r\n    }//改背景\r\n    else if(command === 'changeP'){\r\n        WG_ViewControl.VC_changeP(S_content,'center');\r\n        SyncCurrentStatus('fig_Name',S_content);\r\n        autoPlay('on');\r\n    }//改立绘\r\n    else if(command === 'changeP_left'){\r\n        WG_ViewControl.VC_changeP(S_content,'left');\r\n        SyncCurrentStatus('fig_Name_left',S_content);\r\n        autoPlay('on');\r\n    }\r\n    else if(command === 'changeP_right'){\r\n        WG_ViewControl.VC_changeP(S_content,'right');\r\n        SyncCurrentStatus('fig_Name_right',S_content);\r\n        autoPlay('on');\r\n    }\r\n    else if(command === 'changeP_next'){\r\n        WG_ViewControl.VC_changeP(S_content,'center');\r\n        SyncCurrentStatus('fig_Name',S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'changeP_left_next'){\r\n        WG_ViewControl.VC_changeP(S_content,'left');\r\n        SyncCurrentStatus('fig_Name_left',S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'changeP_right_next'){\r\n        WG_ViewControl.VC_changeP(S_content,'right')\r\n        SyncCurrentStatus('fig_Name_right',S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'changeBG_next'){\r\n        WG_ViewControl.VC_changeBG(S_content);\r\n        increaseSentence();\r\n        SyncCurrentStatus(\"bg_Name\",S_content);\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'changeScene'){\r\n        let sUrl = \"game/scene/\"+thisSentence[1];\r\n        getScene(sUrl);\r\n        SyncCurrentStatus('SceneName',S_content);\r\n        return;\r\n    }\r\n    else if(command === 'choose'){\r\n        SyncCurrentStatus('command',command);\r\n        SyncCurrentStatus('choose',S_content);\r\n        let chooseItems =S_content;\r\n        chooseItems = chooseItems.split(\"}\")[0];\r\n        chooseItems = chooseItems.split(\"{\")[1];\r\n        let selection = chooseItems.split(',')\r\n        for (let i = 0;i<selection.length;i++){\r\n            selection[i] = selection[i].split(\":\");\r\n        }\r\n        WG_ViewControl.VC_choose(selection,'scene');\r\n        return;\r\n    }\r\n    else if(command === 'bgm'){\r\n        SyncCurrentStatus('bgm',S_content);\r\n        // getRuntime().currentInfo[\"bgm\"] =  S_content;\r\n        WG_ViewControl.loadBGM();\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'choose_label'){\r\n        SyncCurrentStatus('command',command);\r\n        SyncCurrentStatus('choose',S_content);\r\n        let chooseItems =S_content;\r\n        chooseItems = chooseItems.split(\"}\")[0];\r\n        chooseItems = chooseItems.split(\"{\")[1];\r\n        let selection = chooseItems.split(',')\r\n        for (let i = 0;i<selection.length;i++){\r\n            selection[i] = selection[i].split(\":\");\r\n        }\r\n        WG_ViewControl.VC_choose(selection,'label')\r\n        return;\r\n    }\r\n    else if(command === 'jump_label'){\r\n        let lab_name = thisSentence[1];\r\n        //find the line of the label:\r\n        let find = false;\r\n        let jmp_sentence = 0;\r\n        for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n            if(getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name){\r\n                find = true;\r\n                jmp_sentence = i;\r\n            }\r\n        }\r\n        if(find){\r\n            SyncCurrentStatus(\"SentenceID\",jmp_sentence);\r\n            nextSentenceProcessor();\r\n            return;\r\n        }else\r\n        {\r\n            increaseSentence();\r\n            nextSentenceProcessor();\r\n            return;\r\n        }\r\n    }\r\n    else if(command === 'label'){\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command === 'intro'){\r\n        let introText = thisSentence[1];\r\n        WG_ViewControl.showIntro(introText);\r\n        return;\r\n    }\r\n    else if(command === 'miniAvatar'){\r\n        WG_ViewControl.VC_showMiniAvatar(S_content);\r\n        SyncCurrentStatus('miniAvatar',S_content);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else if(command.substr(0,3) === \"var\" || command.substr(0,8) === \"jump_var\"){\r\n        varProcess(command,S_content);\r\n        return;\r\n    }else if(command === 'showVar'){\r\n        console.log(\"showing var\");\r\n        SyncCurrentStatus('command', command);\r\n        SyncCurrentStatus('showName',command);\r\n        SyncCurrentStatus('showText',JSON.stringify(getRuntime().currentInfo.GameVar));\r\n        WG_ViewControl.VC_textShow(getStatus('showName'),getStatus('showText'));\r\n        saveBacklogNow = true;\r\n    }else if(command.substr(0,2) === 'if'){\r\n        ifJump(command,S_content);\r\n        return;\r\n    }else if(command === 'setVar'){\r\n        setVar(S_content)\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }else if(command === 'setFigAni'){\r\n        let pos = S_content.split(',')[0];\r\n        let aniName = S_content.split(',')[1];\r\n        let aniTime = S_content.split(',')[2];\r\n        WG_ViewControl.VC_setAnimationByClass('figureContainer'+pos,aniName,aniTime);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }else if(command === 'setBgAni'){\r\n        let aniName = S_content.split(',')[0];\r\n        let aniTime = S_content.split(',')[1];\r\n        WG_ViewControl.VC_setAnimationById('mainBackground',aniName,aniTime);\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n        return;\r\n    }\r\n    else {\r\n        SyncCurrentStatus('command',processSentence(getStatus(\"SentenceID\"))['name']);\r\n        SyncCurrentStatus('showName',processSentence(getStatus(\"SentenceID\"))['name']);\r\n        SyncCurrentStatus('showText',processSentence(getStatus(\"SentenceID\"))['text']);\r\n        SyncCurrentStatus('vocal',processSentence(getStatus(\"SentenceID\"))['vocal']);\r\n        WG_ViewControl.VC_textShow(getStatus('showName'),getStatus('showText'));\r\n        if(getStatus(\"all\")[\"vocal\"]!== ''){\r\n            WG_ViewControl.playVocal();\r\n        }\r\n        saveBacklogNow = true;\r\n    }\r\n    increaseSentence();\r\n    if(saveBacklogNow){\r\n        if(getRuntime().CurrentBacklog.length<=500){\r\n            let temp = JSON.stringify(getStatus(\"all\"));\r\n            getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(temp);\r\n        }else{\r\n            getRuntime().CurrentBacklog.shift();\r\n            let temp = JSON.stringify(getStatus(\"all\"));\r\n            getRuntime().CurrentBacklog[getRuntime().CurrentBacklog.length] = JSON.parse(temp);\r\n        }\r\n    }\r\n\r\n    function autoPlay(active){\r\n        if(getRuntime().auto === 1 && active === 'on'){\r\n            setTimeout(jumpNext,getRuntime().autoWaitTime);\r\n            function jumpNext(){\r\n                if(getRuntime().auto === 1)\r\n                    nextSentenceProcessor();\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\n//sentenceID+1\r\nfunction increaseSentence(){\r\n    SyncCurrentStatus('SentenceID',getStatus('SentenceID')+1);\r\n}\r\n\r\nfunction varProcess(command,content){\r\n    if(command === 'varSet'){\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        console.log(content)\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            console.log(singleSet)\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = parseInt(singleSet[1]);\r\n        }\r\n    }else if(command === 'varUp'){\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = getRuntime().currentInfo.GameVar[singleSet[0]]+parseInt(singleSet[1]);\r\n        }\r\n    }else if(command === 'varDrop'){\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        for (let i = 0; i < content.length; i++) {\r\n            let singleSet = content[i];\r\n            singleSet = singleSet.split(':');\r\n            getRuntime().currentInfo.GameVar[singleSet[0]] = getRuntime().currentInfo.GameVar[singleSet[0]]-parseInt(singleSet[1]);\r\n        }\r\n    }else if(command === 'jump_varReach'){\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        let varArea = content[0];\r\n        varArea = varArea.split(':');\r\n        let JumpArea = content[1];\r\n        console.log(\"var data is\"+parseInt(varArea[1])+getRuntime().currentInfo.GameVar[varArea[0]])\r\n        if(getRuntime().currentInfo.GameVar[varArea[0]]>=parseInt(varArea[1])){\r\n            let lab_name = JumpArea;\r\n            //find the line of the label:\r\n            let find = false;\r\n            let jmp_sentence = 0;\r\n            for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n                if(getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name){\r\n                    find = true;\r\n                    jmp_sentence = i;\r\n                }\r\n            }\r\n            if(find){\r\n                SyncCurrentStatus(\"SentenceID\",jmp_sentence);\r\n                nextSentenceProcessor();\r\n                return;\r\n            }else\r\n            {\r\n                increaseSentence();\r\n                nextSentenceProcessor();\r\n                return;\r\n            }\r\n        }\r\n    }else if(command === 'jump_varBelow'){\r\n        content = content.split(';')[0];\r\n        console.log(content);\r\n        content = content.split(',');\r\n        let varArea = content[0];\r\n        varArea = varArea.split(':');\r\n        let JumpArea = content[1];\r\n        if(getRuntime().currentInfo.GameVar[varArea[0]]<parseInt(varArea[1])){\r\n            let lab_name = JumpArea;\r\n            //find the line of the label:\r\n            let find = false;\r\n            let jmp_sentence = 0;\r\n            for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n                if(getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name){\r\n                    find = true;\r\n                    jmp_sentence = i;\r\n                }\r\n            }\r\n            if(find){\r\n                SyncCurrentStatus(\"SentenceID\",jmp_sentence);\r\n                nextSentenceProcessor();\r\n                return;\r\n            }else\r\n            {\r\n                increaseSentence();\r\n                nextSentenceProcessor();\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    console.log(getRuntime().currentInfo.GameVar);\r\n    increaseSentence();\r\n    nextSentenceProcessor();\r\n}\r\n\r\nfunction ifJump(command,content){\r\n    let judgeBody=command.split(')')[0].split('(')[1];\r\n    console.log(\"judgeBody is: \");\r\n    console.log(judgeBody);\r\n    console.log(judgeBody.split('<=')[1]);\r\n    let jumpActivated = false;\r\n    if(judgeBody.split('<=')[1]){\r\n        console.log(\"case <=\")\r\n        if(getRuntime().currentInfo.GameVar[judgeBody.split('<=')[0]] <= parseInt(judgeBody.split('<=')[1])){\r\n            console.log(\"jump to\"+content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }else if(judgeBody.split('>=')[1]){\r\n        console.log(\"case >=\")\r\n        if(getRuntime().currentInfo.GameVar[judgeBody.split('>=')[0]] >= parseInt(judgeBody.split('>=')[1])){\r\n            console.log(\"jump to\"+content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }else if(judgeBody.split('<')[1]){\r\n        console.log(\"case <\")\r\n        if(getRuntime().currentInfo.GameVar[judgeBody.split('<')[0]] < parseInt(judgeBody.split('<')[1])){\r\n            console.log(\"jump to\"+content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }else if(judgeBody.split('>')[1]){\r\n        console.log(\"case >\")\r\n        if(getRuntime().currentInfo.GameVar[judgeBody.split('>')[0]] > parseInt(judgeBody.split('>')[1])){\r\n            console.log(\"jump to\"+content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }else if(judgeBody.split('=')[1]){\r\n        console.log(\"case = \")\r\n        if(getRuntime().currentInfo.GameVar[judgeBody.split('=')[0]] === parseInt(judgeBody.split('=')[1])){\r\n            console.log(\"jump to\"+content);\r\n            jumpSentence(content);\r\n            jumpActivated = true;\r\n        }\r\n    }\r\n    if(!jumpActivated){\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n    }\r\n}\r\nfunction jumpSentence(lab_name){\r\n    //find the line of the label:\r\n    let find = false;\r\n    let jmp_sentence = 0;\r\n    for (let i = 0; i < getRuntime().currentScene.length; i++) {\r\n        if(getRuntime().currentScene[i][0] === 'label' && getRuntime().currentScene[i][1] === lab_name){\r\n            find = true;\r\n            jmp_sentence = i;\r\n        }\r\n    }\r\n    if(find){\r\n        SyncCurrentStatus(\"SentenceID\",jmp_sentence);\r\n        nextSentenceProcessor();\r\n\r\n    }else\r\n    {\r\n        increaseSentence();\r\n        nextSentenceProcessor();\r\n\r\n    }\r\n}\r\n\r\nfunction setVar(content) {\r\n    let setList = content.split(',');\r\n    for (let i = 0; i < setList.length; i++) {\r\n        let setSent = setList[i];\r\n        setSent = setSent.split('=');\r\n        let setVarName = setSent[0];\r\n        let setVarValue = setSent[1];\r\n        if(setVarValue.split('+')[1]){\r\n            console.log(\"case +\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('+')[0]];\r\n            let valueRight = parseInt(setVarValue.split('+')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft+valueRight;\r\n        }\r\n        else if(setVarValue.split('-')[1]){\r\n            console.log(\"case -\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('-')[0]];\r\n            let valueRight = parseInt(setVarValue.split('-')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft-valueRight;\r\n        }\r\n        else if(setVarValue.split('*')[1]){\r\n            console.log(\"case *\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('*')[0]];\r\n            let valueRight = parseInt(setVarValue.split('*')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft*valueRight;\r\n        }\r\n        else if(setVarValue.split('/')[1]){\r\n            console.log(\"case /\")\r\n            let valueLeft = getRuntime().currentInfo.GameVar[setVarValue.split('/')[0]];\r\n            let valueRight = parseInt(setVarValue.split('/')[1]);\r\n            getRuntime().currentInfo.GameVar[setVarName] = valueLeft/valueRight;\r\n        }else {\r\n            console.log(\"case value\")\r\n            getRuntime().currentInfo.GameVar[setVarName] = parseInt(setVarValue);\r\n        }\r\n    }\r\n    console.log(getRuntime().currentInfo.GameVar);\r\n}\r\n\r\nexport {nextSentenceProcessor,increaseSentence}\r\n","//初始化常量表\r\n// eslint-disable-next-line no-lone-blocks\r\nimport {nextSentenceProcessor} from \"../WG_core\";\r\nimport {prefetcher} from '../util/PrefetchWrapper';\r\nimport {WG_ViewControl} from \"../ViewController/ViewControl\";\r\n\r\n{\r\n    var setAutoWaitTime = 1500;\r\n    var autoWaitTime = 1500;\r\n    var textShowWaitTime = 35;\r\n}\r\n\r\n//初始化游戏信息表\r\n// eslint-disable-next-line no-lone-blocks\r\n{\r\n    var GameInfo =\r\n        {\r\n            Game_name:'WebGAL Demo',\r\n            Game_key:'WG_default',\r\n            Title_img:'Title.png',\r\n            Title_bgm:'夏影.mp3'\r\n        }\r\n\r\n    var SettingsMap =\r\n        {\r\n            font_size: {\r\n                'small': '150%',\r\n                'medium': '200%',\r\n                'large': '250%',\r\n            },\r\n            play_speed:{\r\n                'low': 55,\r\n                'medium': 35,\r\n                'fast': 20\r\n            }\r\n        }\r\n}\r\n\r\n//初始化运行时变量表\r\n// eslint-disable-next-line no-lone-blocks\r\n{\r\n    var currentScene ='';\r\n    var auto = 0;\r\n    var fast = 0;\r\n    var onTextPreview = 0;\r\n    var showingText = false;\r\n    var hideTextStatus = false;\r\n}\r\n\r\n// 初始化状态表\r\nvar currentInfo ={\r\n    SceneName:'',//场景文件名\r\n    SentenceID:0,//语句ID\r\n    bg_Name:'',//背景文件名\r\n    fig_Name:'',//立绘_中 文件名\r\n    fig_Name_left:'',//立绘_左 文件名\r\n    fig_Name_right:'',//立绘_右 文件名\r\n    showText:'',//文字\r\n    showName:'',//人物名\r\n    command:'',//语句指令\r\n    choose:'',//选项列表\r\n    vocal:'',//语音 文件名\r\n    bgm:'',//背景音乐 文件名\r\n    miniAvatar:'',//小头像\r\n    saveTime:'',\r\n    GameVar:{\r\n    }\r\n}\r\n\r\n// 初始化存档系统\r\nvar Saves=[];\r\nvar SaveBacklog=[];\r\n\r\n// 初始化backlog存储表\r\nvar CurrentBacklog=[];\r\n\r\n//初始化存读档页面记录\r\nvar currentSavePage = 0;\r\nvar currentLoadPage = 0;\r\n\r\n// 初始化设置表\r\nvar Settings = {\r\n    font_size: 'medium',\r\n    play_speed:'medium'\r\n};\r\n\r\nvar runtime = {\r\n    setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n    GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings\r\n}\r\n\r\nfunction getRuntime(){\r\n    return runtime;\r\n}\r\n\r\nfunction loadCookie(){\r\n    if(localStorage.getItem(GameInfo['Game_key'])){\r\n        // let pre_process = document.cookie;\r\n        // let fst = pre_process.split(';')[0];\r\n        // let scd = document.cookie.slice(fst.length+1);\r\n        let data = JSON.parse(localStorage.getItem(GameInfo['Game_key']));\r\n        Saves = data.SavedGame;\r\n        SaveBacklog = data.SavedBacklog;\r\n        currentSavePage = data.SP;\r\n        currentLoadPage  = data.LP;\r\n        Settings = data.cSettings;\r\n    }\r\n}\r\n\r\nfunction writeCookie(){\r\n    // var expire = new Date((new Date()).getTime() + 20000 * 24 * 60 * 60000);//有效期20000天\r\n    // expire = \";expires=\" + expire.toGMTString();\r\n    let toCookie = {\r\n        SavedGame:Saves,\r\n        SavedBacklog:SaveBacklog,\r\n        SP:currentSavePage,\r\n        LP:currentLoadPage,\r\n        cSettings:Settings\r\n    }\r\n    // console.log(JSON.stringify(toCookie));\r\n    localStorage.setItem(GameInfo['Game_key'],JSON.stringify(toCookie));\r\n    // document.cookie = JSON.stringify(toCookie);\r\n}\r\n\r\nfunction clearCookie(){\r\n    let toCookie = {\r\n        SavedGame:[],\r\n        SavedBacklog:[],\r\n        SP:0,\r\n        LP:0,\r\n        cSettings:{\r\n            font_size: 'medium',\r\n            play_speed:'medium'\r\n        }\r\n    }\r\n    localStorage.setItem(GameInfo['Game_key'],JSON.stringify(toCookie));\r\n}\r\n\r\nfunction loadSettings(){\r\n    let fontSizeKey = Settings.font_size;\r\n    let fontSize = SettingsMap.font_size[fontSizeKey];\r\n\r\n    let playSpeedKey = Settings.play_speed;\r\n    let playSpeed = SettingsMap.play_speed[playSpeedKey];\r\n\r\n    document.getElementById('SceneText').style.fontSize = fontSize;\r\n    textShowWaitTime = playSpeed;\r\n}\r\n\r\nfunction SyncCurrentStatus(statusKey,newStatus) {\r\n    if(statusKey ==='all'){\r\n        for (let StatusProp in newStatus){\r\n            if(currentInfo.hasOwnProperty(StatusProp)){\r\n                currentInfo[StatusProp] = newStatus[StatusProp];\r\n            }\r\n        }\r\n    }\r\n    else\r\n        currentInfo[statusKey] = newStatus;\r\n}\r\n\r\nfunction getStatus(statusKey){\r\n    if(statusKey ==='all')\r\n        return currentInfo;\r\n    else\r\n        return currentInfo[statusKey];\r\n}\r\n\r\n// 获取场景脚本\r\nfunction getScene(url) {\r\n    currentScene ='';\r\n\r\n    let getScReq = null;\r\n    getScReq = new XMLHttpRequest();\r\n    console.log('now read scene')\r\n    if (getScReq != null) {\r\n        getScReq.open(\"get\",url , true);\r\n        getScReq.send();\r\n        getScReq.onreadystatechange = doResult; //设置回调函数\r\n    }\r\n    function doResult() {\r\n        if (getScReq.readyState === 4) { //4表示执行完成\r\n            if (getScReq.status === 200) { //200表示执行成功\r\n                currentScene = getScReq.responseText;\r\n                currentScene = currentScene.split('\\n');\r\n                for (let i = 0;i<currentScene.length;i++){\r\n                    let tempSentence = currentScene[i].split(\";\")[0];\r\n                    let commandLength = tempSentence.split(\":\")[0].length;\r\n                    let command = currentScene[i].split(\":\")[0];\r\n                    command = command.split(';')[0];\r\n                    let content = tempSentence.slice(commandLength+1);\r\n                    currentScene[i] = currentScene[i].split(\":\");\r\n                    currentScene[i][0] = command;\r\n                    currentScene[i][1] = content;\r\n                }\r\n                console.log('Read scene complete.');\r\n                console.log(currentScene);\r\n                getRuntime().currentScene = currentScene\r\n                SyncCurrentStatus('SentenceID',0);\r\n                nextSentenceProcessor();\r\n                prefetcher.onSceneChange(url);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction getGameInfo() {\r\n    let getInfoCon = new XMLHttpRequest();\r\n    getInfoCon.onreadystatechange = function (){\r\n        if(getInfoCon.status === 200){\r\n            let textList = getInfoCon.responseText;\r\n            textList = textList.split('\\n');\r\n            for (let i = 0; i < textList.length; i++) {\r\n                let tempStr = textList[i].split(\";\")[0];\r\n                let temp = tempStr.split(':');\r\n\r\n                if (temp[0] == null || temp[0] === '') continue;\r\n\r\n                if (GameInfo.hasOwnProperty(temp[0])) {\r\n                    GameInfo[temp[0]] = temp[1];\r\n                } else {\r\n                    console.warn('[GameInfo]', `\\'${temp[0]}\\' key in GameInfo is not exist.`);\r\n                }\r\n            }\r\n            document.getElementById('Title').style.backgroundImage = 'url(\"./game/background/'+GameInfo[\"Title_img\"]+'\")';\r\n            SyncCurrentStatus('bgm',GameInfo['Title_bgm']);\r\n            WG_ViewControl.loadBGM();\r\n            document.title = GameInfo['Game_name'];\r\n        }\r\n\r\n    }\r\n    getInfoCon.open('GET','game/config.txt');\r\n    getInfoCon.send();\r\n}\r\n\r\nexport {\r\n    setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n    GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,SettingsMap,\r\n    loadCookie,writeCookie,clearCookie,loadSettings,getStatus,getScene,getGameInfo,SyncCurrentStatus,getRuntime\r\n}","export default __webpack_public_path__ + \"static/media/closeBlack.48c8b5c9.svg\";","export default __webpack_public_path__ + \"static/media/closeWhite.a1886903.svg\";","export default __webpack_public_path__ + \"static/media/up.17da50db.svg\";","export default __webpack_public_path__ + \"static/media/cross.9d528190.svg\";","// import '../../assests/css/main.css';\r\n// import '../../assests/css/panic.css'\r\n// import '../../assests/css/window.css'\r\n// import '../../assests/css/Load_Save.css'\r\n// import '../../assests/css/settings.css'\r\n// import \"../../assests/css/UI_component.css\"\r\n// import '../../Core/StoreControl/StoreControl'\r\nimport {setAutoWaitTime,autoWaitTime,textShowWatiTime,\r\n    GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,\r\n    loadCookie,writeCookie,clearCookie,loadSettings,getStatus,getScene,getGameInfo}\r\n    from \"../../Core/StoreControl/StoreControl\";\r\nimport {userInteract} from \"../../Core/InteractController/UserInteract\";\r\nimport {nextSentenceProcessor,increaseSentence} from \"../../Core/WG_core\";\r\nimport {WG_ViewControl} from \"../../Core/ViewController/ViewControl\";\r\nimport closeB from \"../../assests/img/closeBlack.svg\"\r\nimport closeW from \"../../assests/img/closeWhite.svg\"\r\nimport up from \"../../assests/img/up.svg\";\r\nimport cross from \"../../assests/img/cross.svg\";\r\nimport '@icon-park/react/styles/index.css';\r\nimport {\r\n    DoubleRight,\r\n    FolderDownload,\r\n    FolderUpload,\r\n    Home,\r\n    PlayOne,\r\n    ReplayMusic,\r\n    Save,\r\n    SettingTwo\r\n} from \"@icon-park/react\";\r\nimport {isMobile} from \"../../Core/util/WG_util\";\r\n\r\n// window.onload = function () {\r\n//     loadCookie();\r\n//     loadSettings();\r\n//     getGameInfo();\r\n//     WG_ViewControl.loadBGM();\r\n//\r\n// }\r\n\r\nfunction Stage() {\r\n    return (\r\n        <div className=\"Stage\">\r\n            <div id={\"WG_startPage\"} onClick={()=>{userInteract.hideStartPage()}}>\r\n                {/*点击屏幕以继续*/}\r\n            </div>\r\n            <div id=\"intro\" className=\"intro_styl\"/>\r\n            <div id=\"MesModel\"/>\r\n            <div id=\"Title\">\r\n                <div id=\"TitleModel\">\r\n                    <div id=\"setButtonBottom\">\r\n                        <div className=\"TitleSingleButton\" id=\"leftTitleButton\" onClick={userInteract.hideTitle}>START</div>\r\n                        <div className=\"TitleSingleButton\" onClick={userInteract.continueGame}>CONTINUE</div>\r\n                        <div className=\"TitleSingleButton\" onClick={userInteract.onLoadGame}>LOAD</div>\r\n                        <div className=\"TitleSingleButton\" onClick={userInteract.onSetting}>CONFIG</div>\r\n                        <div className=\"TitleSingleButton\" onClick={userInteract.exit}>EXIT</div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n            <div id=\"BackgroundContainer\" onClick={userInteract.clickOnBack}>\r\n                <div id={'oldBG'}/>\r\n                <div id={'mainBackground'}/>\r\n            </div>\r\n            <div id=\"figureImage\" className={\"figureContainercenter\"} onClick={userInteract.clickOnBack}/>\r\n            <div id=\"figureImage_left\" className={\"figureContainerleft\"} onClick={userInteract.clickOnBack}/>\r\n            <div id=\"figureImage_right\" className={\"figureContainerright\"} onClick={userInteract.clickOnBack}/>\r\n            <div id=\"settings\">\r\n                <div id=\"settingsMainBox\">\r\n                    <div id=\"close\" onClick={userInteract.closeSettings}>\r\n                        <img src={closeB} className=\"closeSVG\" alt=\"close\"/>\r\n                    </div>\r\n                    <div id=\"settingsTitle\">\r\n                        设置\r\n                    </div>\r\n                    <div id=\"settingItems\"/>\r\n                    <div id=\"textPreview\"/>\r\n                </div>\r\n            </div>\r\n            <div id=\"backlog\">\r\n                <div id=\"closeBl\" onClick={userInteract.closeBacklog}>\r\n                    <img src={closeW} className=\"closeSVG\" alt=\"close\"/>\r\n                </div>\r\n                <div id=\"backlogContent\"/>\r\n            </div>\r\n            <div id=\"Load\" className=\"LS_Main\">\r\n                <div id=\"loadMainBox\" className=\"LS_mainBox\">\r\n                    <div id=\"closeLoad\" onClick={userInteract.closeLoad}>\r\n                        <img src={closeB} className=\"closeSVG\" id=\"LoadClose\" alt=\"close\"/>\r\n                    </div>\r\n                    <div id=\"LoadTitle\">\r\n                        读档\r\n                    </div>\r\n                    <div id=\"LoadItems\" className=\"LS_Items\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div id=\"Save\" className=\"LS_Main\">\r\n                <div id=\"saveMainBox\" className=\"LS_mainBox\">\r\n                    <div id=\"closeSave\" onClick={userInteract.closeSave}>\r\n                        <img src={closeB} className=\"closeSVG\" alt=\"close\"/>\r\n                    </div>\r\n                    <div id=\"SaveTitle\">\r\n                        存档\r\n                    </div>\r\n                    <div id=\"SaveItems\" className=\"LS_Items\">\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div id=\"chooseBox\"/>\r\n            <div id=\"bottomBox\">\r\n                <div id=\"top_control\">\r\n                    <span className=\"top_button\" onClick={userInteract.hideTextBox}>\r\n                        <img src={cross} style={{width: \"22px\",height: \"22px\"}}/>\r\n                    </span>\r\n                    <span className=\"top_button\" onClick={userInteract.showBacklog}>\r\n                        <img src={up} style={{width: \"25px\",height: \"25px\"}}/>\r\n                    </span>\r\n                </div>\r\n                <div id=\"mainTextWindow\" onClick={nextSentenceProcessor}>\r\n                    <div id=\"pName\"/>\r\n                    <div id=\"SceneText\"/>\r\n                </div>\r\n                <div id=\"controlBar\">\r\n                    <div className=\"controlButton\" onClick={WG_ViewControl.playVocal}>\r\n                        <ReplayMusic theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.autoNext} id=\"autoButton\">\r\n                        <PlayOne theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.fastNext} id=\"fastButton\">\r\n                        <DoubleRight theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.onSaveGame} id=\"saveButton\">\r\n                        <FolderDownload theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.onLoadGame} id=\"loadButton\">\r\n                        <FolderUpload theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.onSetting}>\r\n                        <SettingTwo theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                    <div className=\"controlButton\" onClick={userInteract.Title} id=\"titleButton\">\r\n                        <Home theme=\"outline\" size=\"28\" fill=\"#f5f5f7\"/>\r\n                    </div>\r\n                </div>\r\n                <div id={\"miniAvatar\"}/>\r\n            </div>\r\n            <div id=\"bgm\"/>\r\n            <div id=\"vocal\"/>\r\n            <div id=\"panic-overlay\"/>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Stage;","import './App.css';\r\nimport Stage from \"./Components/Stage/mainStage\";\r\nimport {\r\n    setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n    GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,\r\n    loadCookie,writeCookie,clearCookie,loadSettings,getStatus,getScene,getGameInfo,SyncCurrentStatus\r\n} from \"./Core/StoreControl/StoreControl\"\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n        <Stage/>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport {\r\n    setAutoWaitTime,autoWaitTime,textShowWaitTime,\r\n    GameInfo,currentScene,auto,fast,onTextPreview,showingText,hideTextStatus,\r\n    currentInfo,Saves,SaveBacklog,CurrentBacklog,currentSavePage,currentLoadPage,Settings,\r\n    loadCookie,writeCookie,clearCookie,loadSettings,getStatus,getScene,getGameInfo,SyncCurrentStatus\r\n} from \"./Core/StoreControl/StoreControl\"\r\nimport {WG_ViewControl} from \"./Core/ViewController/ViewControl\";\r\nimport {isMobile, MobileChangeStyle} from \"./Core/util/WG_util\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('ReactRoot')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n\r\nloadCookie();\r\nloadSettings();\r\ngetGameInfo();"],"sourceRoot":""}